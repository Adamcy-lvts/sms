function oi(r,e){return function(){return r.apply(e,arguments)}}const{toString:Ma}=Object.prototype,{getPrototypeOf:Nn}=Object,qt=(r=>e=>{const t=Ma.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),me=r=>(r=r.toLowerCase(),e=>qt(e)===r),Jt=r=>e=>typeof e===r,{isArray:$e}=Array,st=Jt("undefined");function La(r){return r!==null&&!st(r)&&r.constructor!==null&&!st(r.constructor)&&le(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const ai=me("ArrayBuffer");function Ba(r){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&ai(r.buffer),e}const Fa=Jt("string"),le=Jt("function"),ci=Jt("number"),Ht=r=>r!==null&&typeof r=="object",za=r=>r===!0||r===!1,Ct=r=>{if(qt(r)!=="object")return!1;const e=Nn(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},ja=me("Date"),Da=me("File"),Ua=me("Blob"),qa=me("FileList"),Ja=r=>Ht(r)&&le(r.pipe),Ha=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||le(r.append)&&((e=qt(r))==="formdata"||e==="object"&&le(r.toString)&&r.toString()==="[object FormData]"))},$a=me("URLSearchParams"),[Wa,Va,Xa,Ka]=["ReadableStream","Request","Response","Headers"].map(me),Ga=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ht(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r>"u")return;let n,i;if(typeof r!="object"&&(r=[r]),$e(r))for(n=0,i=r.length;n<i;n++)e.call(null,r[n],n,r);else{const s=t?Object.getOwnPropertyNames(r):Object.keys(r),o=s.length;let c;for(n=0;n<o;n++)c=s[n],e.call(null,r[c],c,r)}}function li(r,e){e=e.toLowerCase();const t=Object.keys(r);let n=t.length,i;for(;n-- >0;)if(i=t[n],e===i.toLowerCase())return i;return null}const ui=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,hi=r=>!st(r)&&r!==ui;function kn(){const{caseless:r}=hi(this)&&this||{},e={},t=(n,i)=>{const s=r&&li(e,i)||i;Ct(e[s])&&Ct(n)?e[s]=kn(e[s],n):Ct(n)?e[s]=kn({},n):$e(n)?e[s]=n.slice():e[s]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&ht(arguments[n],t);return e}const Qa=(r,e,t,{allOwnKeys:n}={})=>(ht(e,(i,s)=>{t&&le(i)?r[s]=oi(i,t):r[s]=i},{allOwnKeys:n}),r),Ya=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),Za=(r,e,t,n)=>{r.prototype=Object.create(e.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},ec=(r,e,t,n)=>{let i,s,o;const c={};if(e=e||{},r==null)return e;do{for(i=Object.getOwnPropertyNames(r),s=i.length;s-- >0;)o=i[s],(!n||n(o,r,e))&&!c[o]&&(e[o]=r[o],c[o]=!0);r=t!==!1&&Nn(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},tc=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;const n=r.indexOf(e,t);return n!==-1&&n===t},nc=r=>{if(!r)return null;if($e(r))return r;let e=r.length;if(!ci(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},rc=(r=>e=>r&&e instanceof r)(typeof Uint8Array<"u"&&Nn(Uint8Array)),ic=(r,e)=>{const n=(r&&r[Symbol.iterator]).call(r);let i;for(;(i=n.next())&&!i.done;){const s=i.value;e.call(r,s[0],s[1])}},sc=(r,e)=>{let t;const n=[];for(;(t=r.exec(e))!==null;)n.push(t);return n},oc=me("HTMLFormElement"),ac=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,i){return n.toUpperCase()+i}),Tr=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),cc=me("RegExp"),fi=(r,e)=>{const t=Object.getOwnPropertyDescriptors(r),n={};ht(t,(i,s)=>{let o;(o=e(i,s,r))!==!1&&(n[s]=o||i)}),Object.defineProperties(r,n)},lc=r=>{fi(r,(e,t)=>{if(le(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const n=r[t];if(le(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},uc=(r,e)=>{const t={},n=i=>{i.forEach(s=>{t[s]=!0})};return $e(r)?n(r):n(String(r).split(e)),t},hc=()=>{},fc=(r,e)=>r!=null&&Number.isFinite(r=+r)?r:e,ln="abcdefghijklmnopqrstuvwxyz",Er="0123456789",di={DIGIT:Er,ALPHA:ln,ALPHA_DIGIT:ln+ln.toUpperCase()+Er},dc=(r=16,e=di.ALPHA_DIGIT)=>{let t="";const{length:n}=e;for(;r--;)t+=e[Math.random()*n|0];return t};function pc(r){return!!(r&&le(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}const mc=r=>{const e=new Array(10),t=(n,i)=>{if(Ht(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[i]=n;const s=$e(n)?[]:{};return ht(n,(o,c)=>{const u=t(o,i+1);!st(u)&&(s[c]=u)}),e[i]=void 0,s}}return n};return t(r,0)},gc=me("AsyncFunction"),yc=r=>r&&(Ht(r)||le(r))&&le(r.then)&&le(r.catch),S={isArray:$e,isArrayBuffer:ai,isBuffer:La,isFormData:Ha,isArrayBufferView:Ba,isString:Fa,isNumber:ci,isBoolean:za,isObject:Ht,isPlainObject:Ct,isReadableStream:Wa,isRequest:Va,isResponse:Xa,isHeaders:Ka,isUndefined:st,isDate:ja,isFile:Da,isBlob:Ua,isRegExp:cc,isFunction:le,isStream:Ja,isURLSearchParams:$a,isTypedArray:rc,isFileList:qa,forEach:ht,merge:kn,extend:Qa,trim:Ga,stripBOM:Ya,inherits:Za,toFlatObject:ec,kindOf:qt,kindOfTest:me,endsWith:tc,toArray:nc,forEachEntry:ic,matchAll:sc,isHTMLForm:oc,hasOwnProperty:Tr,hasOwnProp:Tr,reduceDescriptors:fi,freezeMethods:lc,toObjectSet:uc,toCamelCase:ac,noop:hc,toFiniteNumber:fc,findKey:li,global:ui,isContextDefined:hi,ALPHABET:di,generateString:dc,isSpecCompliantForm:pc,toJSONObject:mc,isAsyncFn:gc,isThenable:yc};function N(r,e,t,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),i&&(this.response=i)}S.inherits(N,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:S.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const pi=N.prototype,mi={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{mi[r]={value:r}});Object.defineProperties(N,mi);Object.defineProperty(pi,"isAxiosError",{value:!0});N.from=(r,e,t,n,i,s)=>{const o=Object.create(pi);return S.toFlatObject(r,o,function(u){return u!==Error.prototype},c=>c!=="isAxiosError"),N.call(o,r.message,e,t,n,i),o.cause=r,o.name=r.name,s&&Object.assign(o,s),o};const bc=null;function Sn(r){return S.isPlainObject(r)||S.isArray(r)}function gi(r){return S.endsWith(r,"[]")?r.slice(0,-2):r}function Or(r,e,t){return r?r.concat(e).map(function(i,s){return i=gi(i),!t&&s?"["+i+"]":i}).join(t?".":""):e}function wc(r){return S.isArray(r)&&!r.some(Sn)}const vc=S.toFlatObject(S,{},null,function(e){return/^is[A-Z]/.test(e)});function $t(r,e,t){if(!S.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=S.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,k){return!S.isUndefined(k[y])});const n=t.metaTokens,i=t.visitor||d,s=t.dots,o=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&S.isSpecCompliantForm(e);if(!S.isFunction(i))throw new TypeError("visitor must be a function");function f(b){if(b===null)return"";if(S.isDate(b))return b.toISOString();if(!u&&S.isBlob(b))throw new N("Blob is not supported. Use a Buffer instead.");return S.isArrayBuffer(b)||S.isTypedArray(b)?u&&typeof Blob=="function"?new Blob([b]):Buffer.from(b):b}function d(b,y,k){let x=b;if(b&&!k&&typeof b=="object"){if(S.endsWith(y,"{}"))y=n?y:y.slice(0,-2),b=JSON.stringify(b);else if(S.isArray(b)&&wc(b)||(S.isFileList(b)||S.endsWith(y,"[]"))&&(x=S.toArray(b)))return y=gi(y),x.forEach(function(_,M){!(S.isUndefined(_)||_===null)&&e.append(o===!0?Or([y],M,s):o===null?y:y+"[]",f(_))}),!1}return Sn(b)?!0:(e.append(Or(k,y,s),f(b)),!1)}const g=[],v=Object.assign(vc,{defaultVisitor:d,convertValue:f,isVisitable:Sn});function w(b,y){if(!S.isUndefined(b)){if(g.indexOf(b)!==-1)throw Error("Circular reference detected in "+y.join("."));g.push(b),S.forEach(b,function(x,O){(!(S.isUndefined(x)||x===null)&&i.call(e,x,S.isString(O)?O.trim():O,y,v))===!0&&w(x,y?y.concat(O):[O])}),g.pop()}}if(!S.isObject(r))throw new TypeError("data must be an object");return w(r),e}function _r(r){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function Mn(r,e){this._pairs=[],r&&$t(r,this,e)}const yi=Mn.prototype;yi.append=function(e,t){this._pairs.push([e,t])};yi.toString=function(e){const t=e?function(n){return e.call(this,n,_r)}:_r;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function kc(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function bi(r,e,t){if(!e)return r;const n=t&&t.encode||kc,i=t&&t.serialize;let s;if(i?s=i(e,t):s=S.isURLSearchParams(e)?e.toString():new Mn(e,t).toString(n),s){const o=r.indexOf("#");o!==-1&&(r=r.slice(0,o)),r+=(r.indexOf("?")===-1?"?":"&")+s}return r}class Ar{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){S.forEach(this.handlers,function(n){n!==null&&e(n)})}}const wi={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Sc=typeof URLSearchParams<"u"?URLSearchParams:Mn,xc=typeof FormData<"u"?FormData:null,Cc=typeof Blob<"u"?Blob:null,Tc={isBrowser:!0,classes:{URLSearchParams:Sc,FormData:xc,Blob:Cc},protocols:["http","https","file","blob","url","data"]},Ln=typeof window<"u"&&typeof document<"u",Ec=(r=>Ln&&["ReactNative","NativeScript","NS"].indexOf(r)<0)(typeof navigator<"u"&&navigator.product),Oc=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",_c=Ln&&window.location.href||"http://localhost",Ac=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ln,hasStandardBrowserEnv:Ec,hasStandardBrowserWebWorkerEnv:Oc,origin:_c},Symbol.toStringTag,{value:"Module"})),fe={...Ac,...Tc};function Rc(r,e){return $t(r,new fe.classes.URLSearchParams,Object.assign({visitor:function(t,n,i,s){return fe.isNode&&S.isBuffer(t)?(this.append(n,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function Pc(r){return S.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Ic(r){const e={},t=Object.keys(r);let n;const i=t.length;let s;for(n=0;n<i;n++)s=t[n],e[s]=r[s];return e}function vi(r){function e(t,n,i,s){let o=t[s++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),u=s>=t.length;return o=!o&&S.isArray(i)?i.length:o,u?(S.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!c):((!i[o]||!S.isObject(i[o]))&&(i[o]=[]),e(t,n,i[o],s)&&S.isArray(i[o])&&(i[o]=Ic(i[o])),!c)}if(S.isFormData(r)&&S.isFunction(r.entries)){const t={};return S.forEachEntry(r,(n,i)=>{e(Pc(n),i,t,0)}),t}return null}function Nc(r,e,t){if(S.isString(r))try{return(e||JSON.parse)(r),S.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(r)}const ft={transitional:wi,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,s=S.isObject(e);if(s&&S.isHTMLForm(e)&&(e=new FormData(e)),S.isFormData(e))return i?JSON.stringify(vi(e)):e;if(S.isArrayBuffer(e)||S.isBuffer(e)||S.isStream(e)||S.isFile(e)||S.isBlob(e)||S.isReadableStream(e))return e;if(S.isArrayBufferView(e))return e.buffer;if(S.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let c;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Rc(e,this.formSerializer).toString();if((c=S.isFileList(e))||n.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return $t(c?{"files[]":e}:e,u&&new u,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),Nc(e)):e}],transformResponse:[function(e){const t=this.transitional||ft.transitional,n=t&&t.forcedJSONParsing,i=this.responseType==="json";if(S.isResponse(e)||S.isReadableStream(e))return e;if(e&&S.isString(e)&&(n&&!this.responseType||i)){const o=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(c){if(o)throw c.name==="SyntaxError"?N.from(c,N.ERR_BAD_RESPONSE,this,null,this.response):c}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:fe.classes.FormData,Blob:fe.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};S.forEach(["delete","get","head","post","put","patch"],r=>{ft.headers[r]={}});const Mc=S.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Lc=r=>{const e={};let t,n,i;return r&&r.split(`
`).forEach(function(o){i=o.indexOf(":"),t=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!t||e[t]&&Mc[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},Rr=Symbol("internals");function Ye(r){return r&&String(r).trim().toLowerCase()}function Tt(r){return r===!1||r==null?r:S.isArray(r)?r.map(Tt):String(r)}function Bc(r){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=t.exec(r);)e[n[1]]=n[2];return e}const Fc=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function un(r,e,t,n,i){if(S.isFunction(n))return n.call(this,e,t);if(i&&(e=t),!!S.isString(e)){if(S.isString(n))return e.indexOf(n)!==-1;if(S.isRegExp(n))return n.test(e)}}function zc(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function jc(r,e){const t=S.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+t,{value:function(i,s,o){return this[n].call(this,e,i,s,o)},configurable:!0})})}class re{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function s(c,u,f){const d=Ye(u);if(!d)throw new Error("header name must be a non-empty string");const g=S.findKey(i,d);(!g||i[g]===void 0||f===!0||f===void 0&&i[g]!==!1)&&(i[g||u]=Tt(c))}const o=(c,u)=>S.forEach(c,(f,d)=>s(f,d,u));if(S.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(S.isString(e)&&(e=e.trim())&&!Fc(e))o(Lc(e),t);else if(S.isHeaders(e))for(const[c,u]of e.entries())s(u,c,n);else e!=null&&s(t,e,n);return this}get(e,t){if(e=Ye(e),e){const n=S.findKey(this,e);if(n){const i=this[n];if(!t)return i;if(t===!0)return Bc(i);if(S.isFunction(t))return t.call(this,i,n);if(S.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ye(e),e){const n=S.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||un(this,this[n],n,t)))}return!1}delete(e,t){const n=this;let i=!1;function s(o){if(o=Ye(o),o){const c=S.findKey(n,o);c&&(!t||un(n,n[c],c,t))&&(delete n[c],i=!0)}}return S.isArray(e)?e.forEach(s):s(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const s=t[n];(!e||un(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const t=this,n={};return S.forEach(this,(i,s)=>{const o=S.findKey(n,s);if(o){t[o]=Tt(i),delete t[s];return}const c=e?zc(s):String(s).trim();c!==s&&delete t[s],t[c]=Tt(i),n[c]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return S.forEach(this,(n,i)=>{n!=null&&n!==!1&&(t[i]=e&&S.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(i=>n.set(i)),n}static accessor(e){const n=(this[Rr]=this[Rr]={accessors:{}}).accessors,i=this.prototype;function s(o){const c=Ye(o);n[c]||(jc(i,o),n[c]=!0)}return S.isArray(e)?e.forEach(s):s(e),this}}re.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);S.reduceDescriptors(re.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(n){this[t]=n}}});S.freezeMethods(re);function hn(r,e){const t=this||ft,n=e||t,i=re.from(n.headers);let s=n.data;return S.forEach(r,function(c){s=c.call(t,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function ki(r){return!!(r&&r.__CANCEL__)}function We(r,e,t){N.call(this,r??"canceled",N.ERR_CANCELED,e,t),this.name="CanceledError"}S.inherits(We,N,{__CANCEL__:!0});function Si(r,e,t){const n=t.config.validateStatus;!t.status||!n||n(t.status)?r(t):e(new N("Request failed with status code "+t.status,[N.ERR_BAD_REQUEST,N.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Dc(r){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function Uc(r,e){r=r||10;const t=new Array(r),n=new Array(r);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(u){const f=Date.now(),d=n[s];o||(o=f),t[i]=u,n[i]=f;let g=s,v=0;for(;g!==i;)v+=t[g++],g=g%r;if(i=(i+1)%r,i===s&&(s=(s+1)%r),f-o<e)return;const w=d&&f-d;return w?Math.round(v*1e3/w):void 0}}function qc(r,e){let t=0;const n=1e3/e;let i=null;return function(){const o=this===!0,c=Date.now();if(o||c-t>n)return i&&(clearTimeout(i),i=null),t=c,r.apply(null,arguments);i||(i=setTimeout(()=>(i=null,t=Date.now(),r.apply(null,arguments)),n-(c-t)))}}const _t=(r,e,t=3)=>{let n=0;const i=Uc(50,250);return qc(s=>{const o=s.loaded,c=s.lengthComputable?s.total:void 0,u=o-n,f=i(u),d=o<=c;n=o;const g={loaded:o,total:c,progress:c?o/c:void 0,bytes:u,rate:f||void 0,estimated:f&&c&&d?(c-o)/f:void 0,event:s,lengthComputable:c!=null};g[e?"download":"upload"]=!0,r(g)},t)},Jc=fe.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let n;function i(s){let o=s;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=i(window.location.href),function(o){const c=S.isString(o)?i(o):o;return c.protocol===n.protocol&&c.host===n.host}}():function(){return function(){return!0}}(),Hc=fe.hasStandardBrowserEnv?{write(r,e,t,n,i,s){const o=[r+"="+encodeURIComponent(e)];S.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),S.isString(n)&&o.push("path="+n),S.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(r){const e=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function $c(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function Wc(r,e){return e?r.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):r}function xi(r,e){return r&&!$c(e)?Wc(r,e):e}const Pr=r=>r instanceof re?{...r}:r;function Le(r,e){e=e||{};const t={};function n(f,d,g){return S.isPlainObject(f)&&S.isPlainObject(d)?S.merge.call({caseless:g},f,d):S.isPlainObject(d)?S.merge({},d):S.isArray(d)?d.slice():d}function i(f,d,g){if(S.isUndefined(d)){if(!S.isUndefined(f))return n(void 0,f,g)}else return n(f,d,g)}function s(f,d){if(!S.isUndefined(d))return n(void 0,d)}function o(f,d){if(S.isUndefined(d)){if(!S.isUndefined(f))return n(void 0,f)}else return n(void 0,d)}function c(f,d,g){if(g in e)return n(f,d);if(g in r)return n(void 0,f)}const u={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(f,d)=>i(Pr(f),Pr(d),!0)};return S.forEach(Object.keys(Object.assign({},r,e)),function(d){const g=u[d]||i,v=g(r[d],e[d],d);S.isUndefined(v)&&g!==c||(t[d]=v)}),t}const Ci=r=>{const e=Le({},r);let{data:t,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:c}=e;e.headers=o=re.from(o),e.url=bi(xi(e.baseURL,e.url),r.params,r.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let u;if(S.isFormData(t)){if(fe.hasStandardBrowserEnv||fe.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((u=o.getContentType())!==!1){const[f,...d]=u?u.split(";").map(g=>g.trim()).filter(Boolean):[];o.setContentType([f||"multipart/form-data",...d].join("; "))}}if(fe.hasStandardBrowserEnv&&(n&&S.isFunction(n)&&(n=n(e)),n||n!==!1&&Jc(e.url))){const f=i&&s&&Hc.read(s);f&&o.set(i,f)}return e},Vc=typeof XMLHttpRequest<"u",Xc=Vc&&function(r){return new Promise(function(t,n){const i=Ci(r);let s=i.data;const o=re.from(i.headers).normalize();let{responseType:c}=i,u;function f(){i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let d=new XMLHttpRequest;d.open(i.method.toUpperCase(),i.url,!0),d.timeout=i.timeout;function g(){if(!d)return;const w=re.from("getAllResponseHeaders"in d&&d.getAllResponseHeaders()),y={data:!c||c==="text"||c==="json"?d.responseText:d.response,status:d.status,statusText:d.statusText,headers:w,config:r,request:d};Si(function(x){t(x),f()},function(x){n(x),f()},y),d=null}"onloadend"in d?d.onloadend=g:d.onreadystatechange=function(){!d||d.readyState!==4||d.status===0&&!(d.responseURL&&d.responseURL.indexOf("file:")===0)||setTimeout(g)},d.onabort=function(){d&&(n(new N("Request aborted",N.ECONNABORTED,i,d)),d=null)},d.onerror=function(){n(new N("Network Error",N.ERR_NETWORK,i,d)),d=null},d.ontimeout=function(){let b=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const y=i.transitional||wi;i.timeoutErrorMessage&&(b=i.timeoutErrorMessage),n(new N(b,y.clarifyTimeoutError?N.ETIMEDOUT:N.ECONNABORTED,i,d)),d=null},s===void 0&&o.setContentType(null),"setRequestHeader"in d&&S.forEach(o.toJSON(),function(b,y){d.setRequestHeader(y,b)}),S.isUndefined(i.withCredentials)||(d.withCredentials=!!i.withCredentials),c&&c!=="json"&&(d.responseType=i.responseType),typeof i.onDownloadProgress=="function"&&d.addEventListener("progress",_t(i.onDownloadProgress,!0)),typeof i.onUploadProgress=="function"&&d.upload&&d.upload.addEventListener("progress",_t(i.onUploadProgress)),(i.cancelToken||i.signal)&&(u=w=>{d&&(n(!w||w.type?new We(null,r,d):w),d.abort(),d=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const v=Dc(i.url);if(v&&fe.protocols.indexOf(v)===-1){n(new N("Unsupported protocol "+v+":",N.ERR_BAD_REQUEST,r));return}d.send(s||null)})},Kc=(r,e)=>{let t=new AbortController,n;const i=function(u){if(!n){n=!0,o();const f=u instanceof Error?u:this.reason;t.abort(f instanceof N?f:new We(f instanceof Error?f.message:f))}};let s=e&&setTimeout(()=>{i(new N(`timeout ${e} of ms exceeded`,N.ETIMEDOUT))},e);const o=()=>{r&&(s&&clearTimeout(s),s=null,r.forEach(u=>{u&&(u.removeEventListener?u.removeEventListener("abort",i):u.unsubscribe(i))}),r=null)};r.forEach(u=>u&&u.addEventListener&&u.addEventListener("abort",i));const{signal:c}=t;return c.unsubscribe=o,[c,()=>{s&&clearTimeout(s),s=null}]},Gc=function*(r,e){let t=r.byteLength;if(!e||t<e){yield r;return}let n=0,i;for(;n<t;)i=n+e,yield r.slice(n,i),n=i},Qc=async function*(r,e,t){for await(const n of r)yield*Gc(ArrayBuffer.isView(n)?n:await t(String(n)),e)},Ir=(r,e,t,n,i)=>{const s=Qc(r,e,i);let o=0;return new ReadableStream({type:"bytes",async pull(c){const{done:u,value:f}=await s.next();if(u){c.close(),n();return}let d=f.byteLength;t&&t(o+=d),c.enqueue(new Uint8Array(f))},cancel(c){return n(c),s.return()}},{highWaterMark:2})},Nr=(r,e)=>{const t=r!=null;return n=>setTimeout(()=>e({lengthComputable:t,total:r,loaded:n}))},Wt=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ti=Wt&&typeof ReadableStream=="function",xn=Wt&&(typeof TextEncoder=="function"?(r=>e=>r.encode(e))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),Yc=Ti&&(()=>{let r=!1;const e=new Request(fe.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!e})(),Mr=64*1024,Cn=Ti&&!!(()=>{try{return S.isReadableStream(new Response("").body)}catch{}})(),At={stream:Cn&&(r=>r.body)};Wt&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!At[e]&&(At[e]=S.isFunction(r[e])?t=>t[e]():(t,n)=>{throw new N(`Response type '${e}' is not supported`,N.ERR_NOT_SUPPORT,n)})})})(new Response);const Zc=async r=>{if(r==null)return 0;if(S.isBlob(r))return r.size;if(S.isSpecCompliantForm(r))return(await new Request(r).arrayBuffer()).byteLength;if(S.isArrayBufferView(r))return r.byteLength;if(S.isURLSearchParams(r)&&(r=r+""),S.isString(r))return(await xn(r)).byteLength},el=async(r,e)=>{const t=S.toFiniteNumber(r.getContentLength());return t??Zc(e)},tl=Wt&&(async r=>{let{url:e,method:t,data:n,signal:i,cancelToken:s,timeout:o,onDownloadProgress:c,onUploadProgress:u,responseType:f,headers:d,withCredentials:g="same-origin",fetchOptions:v}=Ci(r);f=f?(f+"").toLowerCase():"text";let[w,b]=i||s||o?Kc([i,s],o):[],y,k;const x=()=>{!y&&setTimeout(()=>{w&&w.unsubscribe()}),y=!0};let O;try{if(u&&Yc&&t!=="get"&&t!=="head"&&(O=await el(d,n))!==0){let B=new Request(e,{method:"POST",body:n,duplex:"half"}),J;S.isFormData(n)&&(J=B.headers.get("content-type"))&&d.setContentType(J),B.body&&(n=Ir(B.body,Mr,Nr(O,_t(u)),null,xn))}S.isString(g)||(g=g?"cors":"omit"),k=new Request(e,{...v,signal:w,method:t.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",withCredentials:g});let _=await fetch(k);const M=Cn&&(f==="stream"||f==="response");if(Cn&&(c||M)){const B={};["status","statusText","headers"].forEach(q=>{B[q]=_[q]});const J=S.toFiniteNumber(_.headers.get("content-length"));_=new Response(Ir(_.body,Mr,c&&Nr(J,_t(c,!0)),M&&x,xn),B)}f=f||"text";let F=await At[S.findKey(At,f)||"text"](_,r);return!M&&x(),b&&b(),await new Promise((B,J)=>{Si(B,J,{data:F,headers:re.from(_.headers),status:_.status,statusText:_.statusText,config:r,request:k})})}catch(_){throw x(),_&&_.name==="TypeError"&&/fetch/i.test(_.message)?Object.assign(new N("Network Error",N.ERR_NETWORK,r,k),{cause:_.cause||_}):N.from(_,_&&_.code,r,k)}}),Tn={http:bc,xhr:Xc,fetch:tl};S.forEach(Tn,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch{}Object.defineProperty(r,"adapterName",{value:e})}});const Lr=r=>`- ${r}`,nl=r=>S.isFunction(r)||r===null||r===!1,Ei={getAdapter:r=>{r=S.isArray(r)?r:[r];const{length:e}=r;let t,n;const i={};for(let s=0;s<e;s++){t=r[s];let o;if(n=t,!nl(t)&&(n=Tn[(o=String(t)).toLowerCase()],n===void 0))throw new N(`Unknown adapter '${o}'`);if(n)break;i[o||"#"+s]=n}if(!n){const s=Object.entries(i).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(Lr).join(`
`):" "+Lr(s[0]):"as no adapter specified";throw new N("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Tn};function fn(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new We(null,r)}function Br(r){return fn(r),r.headers=re.from(r.headers),r.data=hn.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),Ei.getAdapter(r.adapter||ft.adapter)(r).then(function(n){return fn(r),n.data=hn.call(r,r.transformResponse,n),n.headers=re.from(n.headers),n},function(n){return ki(n)||(fn(r),n&&n.response&&(n.response.data=hn.call(r,r.transformResponse,n.response),n.response.headers=re.from(n.response.headers))),Promise.reject(n)})}const Oi="1.7.2",Bn={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{Bn[r]=function(n){return typeof n===r||"a"+(e<1?"n ":" ")+r}});const Fr={};Bn.transitional=function(e,t,n){function i(s,o){return"[Axios v"+Oi+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,c)=>{if(e===!1)throw new N(i(o," has been removed"+(t?" in "+t:"")),N.ERR_DEPRECATED);return t&&!Fr[o]&&(Fr[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,c):!0}};function rl(r,e,t){if(typeof r!="object")throw new N("options must be an object",N.ERR_BAD_OPTION_VALUE);const n=Object.keys(r);let i=n.length;for(;i-- >0;){const s=n[i],o=e[s];if(o){const c=r[s],u=c===void 0||o(c,s,r);if(u!==!0)throw new N("option "+s+" must be "+u,N.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new N("Unknown option "+s,N.ERR_BAD_OPTION)}}const En={assertOptions:rl,validators:Bn},ke=En.validators;class Pe{constructor(e){this.defaults=e,this.interceptors={request:new Ar,response:new Ar}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let i;Error.captureStackTrace?Error.captureStackTrace(i={}):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Le(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:s}=t;n!==void 0&&En.assertOptions(n,{silentJSONParsing:ke.transitional(ke.boolean),forcedJSONParsing:ke.transitional(ke.boolean),clarifyTimeoutError:ke.transitional(ke.boolean)},!1),i!=null&&(S.isFunction(i)?t.paramsSerializer={serialize:i}:En.assertOptions(i,{encode:ke.function,serialize:ke.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&S.merge(s.common,s[t.method]);s&&S.forEach(["delete","get","head","post","put","patch","common"],b=>{delete s[b]}),t.headers=re.concat(o,s);const c=[];let u=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(t)===!1||(u=u&&y.synchronous,c.unshift(y.fulfilled,y.rejected))});const f=[];this.interceptors.response.forEach(function(y){f.push(y.fulfilled,y.rejected)});let d,g=0,v;if(!u){const b=[Br.bind(this),void 0];for(b.unshift.apply(b,c),b.push.apply(b,f),v=b.length,d=Promise.resolve(t);g<v;)d=d.then(b[g++],b[g++]);return d}v=c.length;let w=t;for(g=0;g<v;){const b=c[g++],y=c[g++];try{w=b(w)}catch(k){y.call(this,k);break}}try{d=Br.call(this,w)}catch(b){return Promise.reject(b)}for(g=0,v=f.length;g<v;)d=d.then(f[g++],f[g++]);return d}getUri(e){e=Le(this.defaults,e);const t=xi(e.baseURL,e.url);return bi(t,e.params,e.paramsSerializer)}}S.forEach(["delete","get","head","options"],function(e){Pe.prototype[e]=function(t,n){return this.request(Le(n||{},{method:e,url:t,data:(n||{}).data}))}});S.forEach(["post","put","patch"],function(e){function t(n){return function(s,o,c){return this.request(Le(c||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Pe.prototype[e]=t(),Pe.prototype[e+"Form"]=t(!0)});class Fn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(c=>{n.subscribe(c),s=c}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},e(function(s,o,c){n.reason||(n.reason=new We(s,o,c),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new Fn(function(i){e=i}),cancel:e}}}function il(r){return function(t){return r.apply(null,t)}}function sl(r){return S.isObject(r)&&r.isAxiosError===!0}const On={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(On).forEach(([r,e])=>{On[e]=r});function _i(r){const e=new Pe(r),t=oi(Pe.prototype.request,e);return S.extend(t,Pe.prototype,e,{allOwnKeys:!0}),S.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return _i(Le(r,i))},t}const X=_i(ft);X.Axios=Pe;X.CanceledError=We;X.CancelToken=Fn;X.isCancel=ki;X.VERSION=Oi;X.toFormData=$t;X.AxiosError=N;X.Cancel=X.CanceledError;X.all=function(e){return Promise.all(e)};X.spread=il;X.isAxiosError=sl;X.mergeConfig=Le;X.AxiosHeaders=re;X.formToJSON=r=>vi(S.isHTMLForm(r)?new FormData(r):r);X.getAdapter=Ei.getAdapter;X.HttpStatusCode=On;X.default=X;function tt(r){"@babel/helpers - typeof";return tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(r)}function K(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function ol(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function G(r,e,t){return e&&ol(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),r}function ot(){return ot=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},ot.apply(this,arguments)}function se(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&_n(r,e)}function Rt(r){return Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Rt(r)}function _n(r,e){return _n=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},_n(r,e)}function al(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cl(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ll(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cl(r)}function oe(r){var e=al();return function(){var n=Rt(r),i;if(e){var s=Rt(this).constructor;i=Reflect.construct(n,arguments,s)}else i=n.apply(this,arguments);return ll(this,i)}}var zn=function(){function r(){K(this,r)}return G(r,[{key:"listenForWhisper",value:function(t,n){return this.listen(".client-"+t,n)}},{key:"notification",value:function(t){return this.listen(".Illuminate\\Notifications\\Events\\BroadcastNotificationCreated",t)}},{key:"stopListeningForWhisper",value:function(t,n){return this.stopListening(".client-"+t,n)}}]),r}(),Ai=function(){function r(e){K(this,r),this.namespace=e}return G(r,[{key:"format",value:function(t){return[".","\\"].includes(t.charAt(0))?t.substring(1):(this.namespace&&(t=this.namespace+"."+t),t.replace(/\./g,"\\"))}},{key:"setNamespace",value:function(t){this.namespace=t}}]),r}();function ul(r){try{new r}catch(e){if(e.message.includes("is not a constructor"))return!1}return!0}var jn=function(r){se(t,r);var e=oe(t);function t(n,i,s){var o;return K(this,t),o=e.call(this),o.name=i,o.pusher=n,o.options=s,o.eventFormatter=new Ai(o.options.namespace),o.subscribe(),o}return G(t,[{key:"subscribe",value:function(){this.subscription=this.pusher.subscribe(this.name)}},{key:"unsubscribe",value:function(){this.pusher.unsubscribe(this.name)}},{key:"listen",value:function(i,s){return this.on(this.eventFormatter.format(i),s),this}},{key:"listenToAll",value:function(i){var s=this;return this.subscription.bind_global(function(o,c){if(!o.startsWith("pusher:")){var u=s.options.namespace.replace(/\./g,"\\"),f=o.startsWith(u)?o.substring(u.length+1):"."+o;i(f,c)}}),this}},{key:"stopListening",value:function(i,s){return s?this.subscription.unbind(this.eventFormatter.format(i),s):this.subscription.unbind(this.eventFormatter.format(i)),this}},{key:"stopListeningToAll",value:function(i){return i?this.subscription.unbind_global(i):this.subscription.unbind_global(),this}},{key:"subscribed",value:function(i){return this.on("pusher:subscription_succeeded",function(){i()}),this}},{key:"error",value:function(i){return this.on("pusher:subscription_error",function(s){i(s)}),this}},{key:"on",value:function(i,s){return this.subscription.bind(i,s),this}}]),t}(zn),Ri=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"whisper",value:function(i,s){return this.pusher.channels.channels[this.name].trigger("client-".concat(i),s),this}}]),t}(jn),hl=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"whisper",value:function(i,s){return this.pusher.channels.channels[this.name].trigger("client-".concat(i),s),this}}]),t}(jn),fl=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"here",value:function(i){return this.on("pusher:subscription_succeeded",function(s){i(Object.keys(s.members).map(function(o){return s.members[o]}))}),this}},{key:"joining",value:function(i){return this.on("pusher:member_added",function(s){i(s.info)}),this}},{key:"whisper",value:function(i,s){return this.pusher.channels.channels[this.name].trigger("client-".concat(i),s),this}},{key:"leaving",value:function(i){return this.on("pusher:member_removed",function(s){i(s.info)}),this}}]),t}(Ri),Pi=function(r){se(t,r);var e=oe(t);function t(n,i,s){var o;return K(this,t),o=e.call(this),o.events={},o.listeners={},o.name=i,o.socket=n,o.options=s,o.eventFormatter=new Ai(o.options.namespace),o.subscribe(),o}return G(t,[{key:"subscribe",value:function(){this.socket.emit("subscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"unsubscribe",value:function(){this.unbind(),this.socket.emit("unsubscribe",{channel:this.name,auth:this.options.auth||{}})}},{key:"listen",value:function(i,s){return this.on(this.eventFormatter.format(i),s),this}},{key:"stopListening",value:function(i,s){return this.unbindEvent(this.eventFormatter.format(i),s),this}},{key:"subscribed",value:function(i){return this.on("connect",function(s){i(s)}),this}},{key:"error",value:function(i){return this}},{key:"on",value:function(i,s){var o=this;return this.listeners[i]=this.listeners[i]||[],this.events[i]||(this.events[i]=function(c,u){o.name===c&&o.listeners[i]&&o.listeners[i].forEach(function(f){return f(u)})},this.socket.on(i,this.events[i])),this.listeners[i].push(s),this}},{key:"unbind",value:function(){var i=this;Object.keys(this.events).forEach(function(s){i.unbindEvent(s)})}},{key:"unbindEvent",value:function(i,s){this.listeners[i]=this.listeners[i]||[],s&&(this.listeners[i]=this.listeners[i].filter(function(o){return o!==s})),(!s||this.listeners[i].length===0)&&(this.events[i]&&(this.socket.removeListener(i,this.events[i]),delete this.events[i]),delete this.listeners[i])}}]),t}(zn),Ii=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"whisper",value:function(i,s){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(i),data:s}),this}}]),t}(Pi),dl=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"here",value:function(i){return this.on("presence:subscribed",function(s){i(s.map(function(o){return o.user_info}))}),this}},{key:"joining",value:function(i){return this.on("presence:joining",function(s){return i(s.user_info)}),this}},{key:"whisper",value:function(i,s){return this.socket.emit("client event",{channel:this.name,event:"client-".concat(i),data:s}),this}},{key:"leaving",value:function(i){return this.on("presence:leaving",function(s){return i(s.user_info)}),this}}]),t}(Ii),Pt=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"subscribe",value:function(){}},{key:"unsubscribe",value:function(){}},{key:"listen",value:function(i,s){return this}},{key:"listenToAll",value:function(i){return this}},{key:"stopListening",value:function(i,s){return this}},{key:"subscribed",value:function(i){return this}},{key:"error",value:function(i){return this}},{key:"on",value:function(i,s){return this}}]),t}(zn),Ni=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"whisper",value:function(i,s){return this}}]),t}(Pt),pl=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"whisper",value:function(i,s){return this}}]),t}(Pt),ml=function(r){se(t,r);var e=oe(t);function t(){return K(this,t),e.apply(this,arguments)}return G(t,[{key:"here",value:function(i){return this}},{key:"joining",value:function(i){return this}},{key:"whisper",value:function(i,s){return this}},{key:"leaving",value:function(i){return this}}]),t}(Ni),Dn=function(){function r(e){K(this,r),this._defaultOptions={auth:{headers:{}},authEndpoint:"/broadcasting/auth",userAuthentication:{endpoint:"/broadcasting/user-auth",headers:{}},broadcaster:"pusher",csrfToken:null,bearerToken:null,host:null,key:null,namespace:"App.Events"},this.setOptions(e),this.connect()}return G(r,[{key:"setOptions",value:function(t){this.options=ot(this._defaultOptions,t);var n=this.csrfToken();return n&&(this.options.auth.headers["X-CSRF-TOKEN"]=n,this.options.userAuthentication.headers["X-CSRF-TOKEN"]=n),n=this.options.bearerToken,n&&(this.options.auth.headers.Authorization="Bearer "+n,this.options.userAuthentication.headers.Authorization="Bearer "+n),t}},{key:"csrfToken",value:function(){var t;return typeof window<"u"&&window.Laravel&&window.Laravel.csrfToken?window.Laravel.csrfToken:this.options.csrfToken?this.options.csrfToken:typeof document<"u"&&typeof document.querySelector=="function"&&(t=document.querySelector('meta[name="csrf-token"]'))?t.getAttribute("content"):null}}]),r}(),zr=function(r){se(t,r);var e=oe(t);function t(){var n;return K(this,t),n=e.apply(this,arguments),n.channels={},n}return G(t,[{key:"connect",value:function(){typeof this.options.client<"u"?this.pusher=this.options.client:this.options.Pusher?this.pusher=new this.options.Pusher(this.options.key,this.options):this.pusher=new Pusher(this.options.key,this.options)}},{key:"signin",value:function(){this.pusher.signin()}},{key:"listen",value:function(i,s,o){return this.channel(i).listen(s,o)}},{key:"channel",value:function(i){return this.channels[i]||(this.channels[i]=new jn(this.pusher,i,this.options)),this.channels[i]}},{key:"privateChannel",value:function(i){return this.channels["private-"+i]||(this.channels["private-"+i]=new Ri(this.pusher,"private-"+i,this.options)),this.channels["private-"+i]}},{key:"encryptedPrivateChannel",value:function(i){return this.channels["private-encrypted-"+i]||(this.channels["private-encrypted-"+i]=new hl(this.pusher,"private-encrypted-"+i,this.options)),this.channels["private-encrypted-"+i]}},{key:"presenceChannel",value:function(i){return this.channels["presence-"+i]||(this.channels["presence-"+i]=new fl(this.pusher,"presence-"+i,this.options)),this.channels["presence-"+i]}},{key:"leave",value:function(i){var s=this,o=[i,"private-"+i,"private-encrypted-"+i,"presence-"+i];o.forEach(function(c,u){s.leaveChannel(c)})}},{key:"leaveChannel",value:function(i){this.channels[i]&&(this.channels[i].unsubscribe(),delete this.channels[i])}},{key:"socketId",value:function(){return this.pusher.connection.socket_id}},{key:"disconnect",value:function(){this.pusher.disconnect()}}]),t}(Dn),jr=function(r){se(t,r);var e=oe(t);function t(){var n;return K(this,t),n=e.apply(this,arguments),n.channels={},n}return G(t,[{key:"connect",value:function(){var i=this,s=this.getSocketIO();return this.socket=s(this.options.host,this.options),this.socket.on("reconnect",function(){Object.values(i.channels).forEach(function(o){o.subscribe()})}),this.socket}},{key:"getSocketIO",value:function(){if(typeof this.options.client<"u")return this.options.client;if(typeof io<"u")return io;throw new Error("Socket.io client not found. Should be globally available or passed via options.client")}},{key:"listen",value:function(i,s,o){return this.channel(i).listen(s,o)}},{key:"channel",value:function(i){return this.channels[i]||(this.channels[i]=new Pi(this.socket,i,this.options)),this.channels[i]}},{key:"privateChannel",value:function(i){return this.channels["private-"+i]||(this.channels["private-"+i]=new Ii(this.socket,"private-"+i,this.options)),this.channels["private-"+i]}},{key:"presenceChannel",value:function(i){return this.channels["presence-"+i]||(this.channels["presence-"+i]=new dl(this.socket,"presence-"+i,this.options)),this.channels["presence-"+i]}},{key:"leave",value:function(i){var s=this,o=[i,"private-"+i,"presence-"+i];o.forEach(function(c){s.leaveChannel(c)})}},{key:"leaveChannel",value:function(i){this.channels[i]&&(this.channels[i].unsubscribe(),delete this.channels[i])}},{key:"socketId",value:function(){return this.socket.id}},{key:"disconnect",value:function(){this.socket.disconnect()}}]),t}(Dn),gl=function(r){se(t,r);var e=oe(t);function t(){var n;return K(this,t),n=e.apply(this,arguments),n.channels={},n}return G(t,[{key:"connect",value:function(){}},{key:"listen",value:function(i,s,o){return new Pt}},{key:"channel",value:function(i){return new Pt}},{key:"privateChannel",value:function(i){return new Ni}},{key:"encryptedPrivateChannel",value:function(i){return new pl}},{key:"presenceChannel",value:function(i){return new ml}},{key:"leave",value:function(i){}},{key:"leaveChannel",value:function(i){}},{key:"socketId",value:function(){return"fake-socket-id"}},{key:"disconnect",value:function(){}}]),t}(Dn),yl=function(){function r(e){K(this,r),this.options=e,this.connect(),this.options.withoutInterceptors||this.registerInterceptors()}return G(r,[{key:"channel",value:function(t){return this.connector.channel(t)}},{key:"connect",value:function(){if(this.options.broadcaster=="reverb")this.connector=new zr(ot(ot({},this.options),{cluster:""}));else if(this.options.broadcaster=="pusher")this.connector=new zr(this.options);else if(this.options.broadcaster=="socket.io")this.connector=new jr(this.options);else if(this.options.broadcaster=="null")this.connector=new gl(this.options);else if(typeof this.options.broadcaster=="function"&&ul(this.options.broadcaster))this.connector=new this.options.broadcaster(this.options);else throw new Error("Broadcaster ".concat(tt(this.options.broadcaster)," ").concat(this.options.broadcaster," is not supported."))}},{key:"disconnect",value:function(){this.connector.disconnect()}},{key:"join",value:function(t){return this.connector.presenceChannel(t)}},{key:"leave",value:function(t){this.connector.leave(t)}},{key:"leaveChannel",value:function(t){this.connector.leaveChannel(t)}},{key:"leaveAllChannels",value:function(){for(var t in this.connector.channels)this.leaveChannel(t)}},{key:"listen",value:function(t,n,i){return this.connector.listen(t,n,i)}},{key:"private",value:function(t){return this.connector.privateChannel(t)}},{key:"encryptedPrivate",value:function(t){if(this.connector instanceof jr)throw new Error("Broadcaster ".concat(tt(this.options.broadcaster)," ").concat(this.options.broadcaster," does not support encrypted private channels."));return this.connector.encryptedPrivateChannel(t)}},{key:"socketId",value:function(){return this.connector.socketId()}},{key:"registerInterceptors",value:function(){typeof Vue=="function"&&Vue.http&&this.registerVueRequestInterceptor(),typeof axios=="function"&&this.registerAxiosRequestInterceptor(),typeof jQuery=="function"&&this.registerjQueryAjaxSetup(),(typeof Turbo>"u"?"undefined":tt(Turbo))==="object"&&this.registerTurboRequestInterceptor()}},{key:"registerVueRequestInterceptor",value:function(){var t=this;Vue.http.interceptors.push(function(n,i){t.socketId()&&n.headers.set("X-Socket-ID",t.socketId()),i()})}},{key:"registerAxiosRequestInterceptor",value:function(){var t=this;axios.interceptors.request.use(function(n){return t.socketId()&&(n.headers["X-Socket-Id"]=t.socketId()),n})}},{key:"registerjQueryAjaxSetup",value:function(){var t=this;typeof jQuery.ajax<"u"&&jQuery.ajaxPrefilter(function(n,i,s){t.socketId()&&s.setRequestHeader("X-Socket-Id",t.socketId())})}},{key:"registerTurboRequestInterceptor",value:function(){var t=this;document.addEventListener("turbo:before-fetch-request",function(n){n.detail.fetchOptions.headers["X-Socket-Id"]=t.socketId()})}}]),r}();function bl(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Mi={exports:{}};/*!
 * Pusher JavaScript Library v8.4.0-rc2
 * https://pusher.com/
 *
 * Copyright 2020, Pusher
 * Released under the MIT licence.
 */(function(r,e){(function(n,i){r.exports=i()})(window,function(){return function(t){var n={};function i(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=n,i.d=function(s,o,c){i.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:c})},i.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},i.t=function(s,o){if(o&1&&(s=i(s)),o&8||o&4&&typeof s=="object"&&s&&s.__esModule)return s;var c=Object.create(null);if(i.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:s}),o&2&&typeof s!="string")for(var u in s)i.d(c,u,(function(f){return s[f]}).bind(null,u));return c},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=2)}([function(t,n,i){var s=this&&this.__extends||function(){var y=function(k,x){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,_){O.__proto__=_}||function(O,_){for(var M in _)_.hasOwnProperty(M)&&(O[M]=_[M])},y(k,x)};return function(k,x){y(k,x);function O(){this.constructor=k}k.prototype=x===null?Object.create(x):(O.prototype=x.prototype,new O)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=256,c=function(){function y(k){k===void 0&&(k="="),this._paddingCharacter=k}return y.prototype.encodedLength=function(k){return this._paddingCharacter?(k+2)/3*4|0:(k*8+5)/6|0},y.prototype.encode=function(k){for(var x="",O=0;O<k.length-2;O+=3){var _=k[O]<<16|k[O+1]<<8|k[O+2];x+=this._encodeByte(_>>>3*6&63),x+=this._encodeByte(_>>>2*6&63),x+=this._encodeByte(_>>>1*6&63),x+=this._encodeByte(_>>>0*6&63)}var M=k.length-O;if(M>0){var _=k[O]<<16|(M===2?k[O+1]<<8:0);x+=this._encodeByte(_>>>3*6&63),x+=this._encodeByte(_>>>2*6&63),M===2?x+=this._encodeByte(_>>>1*6&63):x+=this._paddingCharacter||"",x+=this._paddingCharacter||""}return x},y.prototype.maxDecodedLength=function(k){return this._paddingCharacter?k/4*3|0:(k*6+7)/8|0},y.prototype.decodedLength=function(k){return this.maxDecodedLength(k.length-this._getPaddingLength(k))},y.prototype.decode=function(k){if(k.length===0)return new Uint8Array(0);for(var x=this._getPaddingLength(k),O=k.length-x,_=new Uint8Array(this.maxDecodedLength(O)),M=0,F=0,B=0,J=0,q=0,ue=0,ve=0;F<O-4;F+=4)J=this._decodeChar(k.charCodeAt(F+0)),q=this._decodeChar(k.charCodeAt(F+1)),ue=this._decodeChar(k.charCodeAt(F+2)),ve=this._decodeChar(k.charCodeAt(F+3)),_[M++]=J<<2|q>>>4,_[M++]=q<<4|ue>>>2,_[M++]=ue<<6|ve,B|=J&o,B|=q&o,B|=ue&o,B|=ve&o;if(F<O-1&&(J=this._decodeChar(k.charCodeAt(F)),q=this._decodeChar(k.charCodeAt(F+1)),_[M++]=J<<2|q>>>4,B|=J&o,B|=q&o),F<O-2&&(ue=this._decodeChar(k.charCodeAt(F+2)),_[M++]=q<<4|ue>>>2,B|=ue&o),F<O-3&&(ve=this._decodeChar(k.charCodeAt(F+3)),_[M++]=ue<<6|ve,B|=ve&o),B!==0)throw new Error("Base64Coder: incorrect characters for decoding");return _},y.prototype._encodeByte=function(k){var x=k;return x+=65,x+=25-k>>>8&6,x+=51-k>>>8&-75,x+=61-k>>>8&-15,x+=62-k>>>8&3,String.fromCharCode(x)},y.prototype._decodeChar=function(k){var x=o;return x+=(42-k&k-44)>>>8&-o+k-43+62,x+=(46-k&k-48)>>>8&-o+k-47+63,x+=(47-k&k-58)>>>8&-o+k-48+52,x+=(64-k&k-91)>>>8&-o+k-65+0,x+=(96-k&k-123)>>>8&-o+k-97+26,x},y.prototype._getPaddingLength=function(k){var x=0;if(this._paddingCharacter){for(var O=k.length-1;O>=0&&k[O]===this._paddingCharacter;O--)x++;if(k.length<4||x>2)throw new Error("Base64Coder: incorrect padding")}return x},y}();n.Coder=c;var u=new c;function f(y){return u.encode(y)}n.encode=f;function d(y){return u.decode(y)}n.decode=d;var g=function(y){s(k,y);function k(){return y!==null&&y.apply(this,arguments)||this}return k.prototype._encodeByte=function(x){var O=x;return O+=65,O+=25-x>>>8&6,O+=51-x>>>8&-75,O+=61-x>>>8&-13,O+=62-x>>>8&49,String.fromCharCode(O)},k.prototype._decodeChar=function(x){var O=o;return O+=(44-x&x-46)>>>8&-o+x-45+62,O+=(94-x&x-96)>>>8&-o+x-95+63,O+=(47-x&x-58)>>>8&-o+x-48+52,O+=(64-x&x-91)>>>8&-o+x-65+0,O+=(96-x&x-123)>>>8&-o+x-97+26,O},k}(c);n.URLSafeCoder=g;var v=new g;function w(y){return v.encode(y)}n.encodeURLSafe=w;function b(y){return v.decode(y)}n.decodeURLSafe=b,n.encodedLength=function(y){return u.encodedLength(y)},n.maxDecodedLength=function(y){return u.maxDecodedLength(y)},n.decodedLength=function(y){return u.decodedLength(y)}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s="utf8: invalid string",o="utf8: invalid source encoding";function c(d){for(var g=new Uint8Array(u(d)),v=0,w=0;w<d.length;w++){var b=d.charCodeAt(w);b<128?g[v++]=b:b<2048?(g[v++]=192|b>>6,g[v++]=128|b&63):b<55296?(g[v++]=224|b>>12,g[v++]=128|b>>6&63,g[v++]=128|b&63):(w++,b=(b&1023)<<10,b|=d.charCodeAt(w)&1023,b+=65536,g[v++]=240|b>>18,g[v++]=128|b>>12&63,g[v++]=128|b>>6&63,g[v++]=128|b&63)}return g}n.encode=c;function u(d){for(var g=0,v=0;v<d.length;v++){var w=d.charCodeAt(v);if(w<128)g+=1;else if(w<2048)g+=2;else if(w<55296)g+=3;else if(w<=57343){if(v>=d.length-1)throw new Error(s);v++,g+=4}else throw new Error(s)}return g}n.encodedLength=u;function f(d){for(var g=[],v=0;v<d.length;v++){var w=d[v];if(w&128){var b=void 0;if(w<224){if(v>=d.length)throw new Error(o);var y=d[++v];if((y&192)!==128)throw new Error(o);w=(w&31)<<6|y&63,b=128}else if(w<240){if(v>=d.length-1)throw new Error(o);var y=d[++v],k=d[++v];if((y&192)!==128||(k&192)!==128)throw new Error(o);w=(w&15)<<12|(y&63)<<6|k&63,b=2048}else if(w<248){if(v>=d.length-2)throw new Error(o);var y=d[++v],k=d[++v],x=d[++v];if((y&192)!==128||(k&192)!==128||(x&192)!==128)throw new Error(o);w=(w&15)<<18|(y&63)<<12|(k&63)<<6|x&63,b=65536}else throw new Error(o);if(w<b||w>=55296&&w<=57343)throw new Error(o);if(w>=65536){if(w>1114111)throw new Error(o);w-=65536,g.push(String.fromCharCode(55296|w>>10)),w=56320|w&1023}}g.push(String.fromCharCode(w))}return g.join("")}n.decode=f},function(t,n,i){t.exports=i(3).default},function(t,n,i){i.r(n);class s{constructor(a,l){this.lastId=0,this.prefix=a,this.name=l}create(a){this.lastId++;var l=this.lastId,p=this.prefix+l,m=this.name+"["+l+"]",C=!1,T=function(){C||(a.apply(null,arguments),C=!0)};return this[l]=T,{number:l,id:p,name:m,callback:T}}remove(a){delete this[a.number]}}var o=new s("_pusher_script_","Pusher.ScriptReceivers"),c={VERSION:"8.4.0-rc2",PROTOCOL:7,wsPort:80,wssPort:443,wsPath:"",httpHost:"sockjs.pusher.com",httpPort:80,httpsPort:443,httpPath:"/pusher",stats_host:"stats.pusher.com",authEndpoint:"/pusher/auth",authTransport:"ajax",activityTimeout:12e4,pongTimeout:3e4,unavailableTimeout:1e4,userAuthentication:{endpoint:"/pusher/user-auth",transport:"ajax"},channelAuthorization:{endpoint:"/pusher/auth",transport:"ajax"},cdn_http:"http://js.pusher.com",cdn_https:"https://js.pusher.com",dependency_suffix:""},u=c;class f{constructor(a){this.options=a,this.receivers=a.receivers||o,this.loading={}}load(a,l,p){var m=this;if(m.loading[a]&&m.loading[a].length>0)m.loading[a].push(p);else{m.loading[a]=[p];var C=I.createScriptRequest(m.getPath(a,l)),T=m.receivers.create(function(A){if(m.receivers.remove(T),m.loading[a]){var P=m.loading[a];delete m.loading[a];for(var L=function(W){W||C.cleanup()},z=0;z<P.length;z++)P[z](A,L)}});C.send(T)}}getRoot(a){var l,p=I.getDocument().location.protocol;return a&&a.useTLS||p==="https:"?l=this.options.cdn_https:l=this.options.cdn_http,l.replace(/\/*$/,"")+"/"+this.options.version}getPath(a,l){return this.getRoot(l)+"/"+a+this.options.suffix+".js"}}var d=new s("_pusher_dependencies","Pusher.DependenciesReceivers"),g=new f({cdn_http:u.cdn_http,cdn_https:u.cdn_https,version:u.VERSION,suffix:u.dependency_suffix,receivers:d});const v={baseUrl:"https://pusher.com",urls:{authenticationEndpoint:{path:"/docs/channels/server_api/authenticating_users"},authorizationEndpoint:{path:"/docs/channels/server_api/authorizing-users/"},javascriptQuickStart:{path:"/docs/javascript_quick_start"},triggeringClientEvents:{path:"/docs/client_api_guide/client_events#trigger-events"},encryptedChannelSupport:{fullUrl:"https://github.com/pusher/pusher-js/tree/cc491015371a4bde5743d1c87a0fbac0feb53195#encrypted-channel-support"}}};var b={buildLogSuffix:function(h){const a="See:",l=v.urls[h];if(!l)return"";let p;return l.fullUrl?p=l.fullUrl:l.path&&(p=v.baseUrl+l.path),p?`${a} ${p}`:""}},y;(function(h){h.UserAuthentication="user-authentication",h.ChannelAuthorization="channel-authorization"})(y||(y={}));class k extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}class x extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}class O extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}class _ extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}class M extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}class F extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}class B extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}class J extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}class q extends Error{constructor(a,l){super(l),this.status=a,Object.setPrototypeOf(this,new.target.prototype)}}var ve=function(h,a,l,p,m){const C=I.createXHR();C.open("POST",l.endpoint,!0),C.setRequestHeader("Content-Type","application/x-www-form-urlencoded");for(var T in l.headers)C.setRequestHeader(T,l.headers[T]);if(l.headersProvider!=null){let A=l.headersProvider();for(var T in A)C.setRequestHeader(T,A[T])}return C.onreadystatechange=function(){if(C.readyState===4)if(C.status===200){let A,P=!1;try{A=JSON.parse(C.responseText),P=!0}catch{m(new q(200,`JSON returned from ${p.toString()} endpoint was invalid, yet status code was 200. Data was: ${C.responseText}`),null)}P&&m(null,A)}else{let A="";switch(p){case y.UserAuthentication:A=b.buildLogSuffix("authenticationEndpoint");break;case y.ChannelAuthorization:A=`Clients must be authorized to join private or presence channels. ${b.buildLogSuffix("authorizationEndpoint")}`;break}m(new q(C.status,`Unable to retrieve auth string from ${p.toString()} endpoint - received status: ${C.status} from ${l.endpoint}. ${A}`),null)}},C.send(a),C};function xs(h){return Os(Ts(h))}var Xe=String.fromCharCode,dt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Cs=function(h){var a=h.charCodeAt(0);return a<128?h:a<2048?Xe(192|a>>>6)+Xe(128|a&63):Xe(224|a>>>12&15)+Xe(128|a>>>6&63)+Xe(128|a&63)},Ts=function(h){return h.replace(/[^\x00-\x7F]/g,Cs)},Es=function(h){var a=[0,2,1][h.length%3],l=h.charCodeAt(0)<<16|(h.length>1?h.charCodeAt(1):0)<<8|(h.length>2?h.charCodeAt(2):0),p=[dt.charAt(l>>>18),dt.charAt(l>>>12&63),a>=2?"=":dt.charAt(l>>>6&63),a>=1?"=":dt.charAt(l&63)];return p.join("")},Os=window.btoa||function(h){return h.replace(/[\s\S]{1,3}/g,Es)};class _s{constructor(a,l,p,m){this.clear=l,this.timer=a(()=>{this.timer&&(this.timer=m(this.timer))},p)}isRunning(){return this.timer!==null}ensureAborted(){this.timer&&(this.clear(this.timer),this.timer=null)}}var Gn=_s;function As(h){window.clearTimeout(h)}function Rs(h){window.clearInterval(h)}class xe extends Gn{constructor(a,l){super(setTimeout,As,a,function(p){return l(),null})}}class Ps extends Gn{constructor(a,l){super(setInterval,Rs,a,function(p){return l(),p})}}var Is={now(){return Date.now?Date.now():new Date().valueOf()},defer(h){return new xe(0,h)},method(h,...a){var l=Array.prototype.slice.call(arguments,1);return function(p){return p[h].apply(p,l.concat(arguments))}}},Z=Is;function ne(h,...a){for(var l=0;l<a.length;l++){var p=a[l];for(var m in p)p[m]&&p[m].constructor&&p[m].constructor===Object?h[m]=ne(h[m]||{},p[m]):h[m]=p[m]}return h}function Ns(){for(var h=["Pusher"],a=0;a<arguments.length;a++)typeof arguments[a]=="string"?h.push(arguments[a]):h.push(pt(arguments[a]));return h.join(" : ")}function Qn(h,a){var l=Array.prototype.indexOf;if(h===null)return-1;if(l&&h.indexOf===l)return h.indexOf(a);for(var p=0,m=h.length;p<m;p++)if(h[p]===a)return p;return-1}function ye(h,a){for(var l in h)Object.prototype.hasOwnProperty.call(h,l)&&a(h[l],l,h)}function Yn(h){var a=[];return ye(h,function(l,p){a.push(p)}),a}function Ms(h){var a=[];return ye(h,function(l){a.push(l)}),a}function Ke(h,a,l){for(var p=0;p<h.length;p++)a.call(l||window,h[p],p,h)}function Zn(h,a){for(var l=[],p=0;p<h.length;p++)l.push(a(h[p],p,h,l));return l}function Ls(h,a){var l={};return ye(h,function(p,m){l[m]=a(p)}),l}function er(h,a){a=a||function(m){return!!m};for(var l=[],p=0;p<h.length;p++)a(h[p],p,h,l)&&l.push(h[p]);return l}function tr(h,a){var l={};return ye(h,function(p,m){(a&&a(p,m,h,l)||p)&&(l[m]=p)}),l}function Bs(h){var a=[];return ye(h,function(l,p){a.push([p,l])}),a}function nr(h,a){for(var l=0;l<h.length;l++)if(a(h[l],l,h))return!0;return!1}function Fs(h,a){for(var l=0;l<h.length;l++)if(!a(h[l],l,h))return!1;return!0}function zs(h){return Ls(h,function(a){return typeof a=="object"&&(a=pt(a)),encodeURIComponent(xs(a.toString()))})}function js(h){var a=tr(h,function(p){return p!==void 0}),l=Zn(Bs(zs(a)),Z.method("join","=")).join("&");return l}function Ds(h){var a=[],l=[];return function p(m,C){var T,A,P;switch(typeof m){case"object":if(!m)return null;for(T=0;T<a.length;T+=1)if(a[T]===m)return{$ref:l[T]};if(a.push(m),l.push(C),Object.prototype.toString.apply(m)==="[object Array]")for(P=[],T=0;T<m.length;T+=1)P[T]=p(m[T],C+"["+T+"]");else{P={};for(A in m)Object.prototype.hasOwnProperty.call(m,A)&&(P[A]=p(m[A],C+"["+JSON.stringify(A)+"]"))}return P;case"number":case"string":case"boolean":return m}}(h,"$")}function pt(h){try{return JSON.stringify(h)}catch{return JSON.stringify(Ds(h))}}class Us{constructor(){this.globalLog=a=>{window.console&&window.console.log&&window.console.log(a)}}debug(...a){this.log(this.globalLog,a)}warn(...a){this.log(this.globalLogWarn,a)}error(...a){this.log(this.globalLogError,a)}globalLogWarn(a){window.console&&window.console.warn?window.console.warn(a):this.globalLog(a)}globalLogError(a){window.console&&window.console.error?window.console.error(a):this.globalLogWarn(a)}log(a,...l){var p=Ns.apply(this,arguments);on.log?on.log(p):on.logToConsole&&a.bind(this)(p)}}var H=new Us,qs=function(h,a,l,p,m){(l.headers!==void 0||l.headersProvider!=null)&&H.warn(`To send headers with the ${p.toString()} request, you must use AJAX, rather than JSONP.`);var C=h.nextAuthCallbackID.toString();h.nextAuthCallbackID++;var T=h.getDocument(),A=T.createElement("script");h.auth_callbacks[C]=function(z){m(null,z)};var P="Pusher.auth_callbacks['"+C+"']";A.src=l.endpoint+"?callback="+encodeURIComponent(P)+"&"+a;var L=T.getElementsByTagName("head")[0]||T.documentElement;L.insertBefore(A,L.firstChild)},Js=qs;class Hs{constructor(a){this.src=a}send(a){var l=this,p="Error loading "+l.src;l.script=document.createElement("script"),l.script.id=a.id,l.script.src=l.src,l.script.type="text/javascript",l.script.charset="UTF-8",l.script.addEventListener?(l.script.onerror=function(){a.callback(p)},l.script.onload=function(){a.callback(null)}):l.script.onreadystatechange=function(){(l.script.readyState==="loaded"||l.script.readyState==="complete")&&a.callback(null)},l.script.async===void 0&&document.attachEvent&&/opera/i.test(navigator.userAgent)?(l.errorScript=document.createElement("script"),l.errorScript.id=a.id+"_error",l.errorScript.text=a.name+"('"+p+"');",l.script.async=l.errorScript.async=!1):l.script.async=!0;var m=document.getElementsByTagName("head")[0];m.insertBefore(l.script,m.firstChild),l.errorScript&&m.insertBefore(l.errorScript,l.script.nextSibling)}cleanup(){this.script&&(this.script.onload=this.script.onerror=null,this.script.onreadystatechange=null),this.script&&this.script.parentNode&&this.script.parentNode.removeChild(this.script),this.errorScript&&this.errorScript.parentNode&&this.errorScript.parentNode.removeChild(this.errorScript),this.script=null,this.errorScript=null}}class $s{constructor(a,l){this.url=a,this.data=l}send(a){if(!this.request){var l=js(this.data),p=this.url+"/"+a.number+"?"+l;this.request=I.createScriptRequest(p),this.request.send(a)}}cleanup(){this.request&&this.request.cleanup()}}var Ws=function(h,a){return function(l,p){var m="http"+(a?"s":"")+"://",C=m+(h.host||h.options.host)+h.options.path,T=I.createJSONPRequest(C,l),A=I.ScriptReceivers.create(function(P,L){o.remove(A),T.cleanup(),L&&L.host&&(h.host=L.host),p&&p(P,L)});T.send(A)}},Vs={name:"jsonp",getAgent:Ws},Xs=Vs;function Kt(h,a,l){var p=h+(a.useTLS?"s":""),m=a.useTLS?a.hostTLS:a.hostNonTLS;return p+"://"+m+l}function Gt(h,a){var l="/app/"+h,p="?protocol="+u.PROTOCOL+"&client=js&version="+u.VERSION+(a?"&"+a:"");return l+p}var Ks={getInitial:function(h,a){var l=(a.httpPath||"")+Gt(h,"flash=false");return Kt("ws",a,l)}},Gs={getInitial:function(h,a){var l=(a.httpPath||"/pusher")+Gt(h);return Kt("http",a,l)}},Qs={getInitial:function(h,a){return Kt("http",a,a.httpPath||"/pusher")},getPath:function(h,a){return Gt(h)}};class Ys{constructor(){this._callbacks={}}get(a){return this._callbacks[Qt(a)]}add(a,l,p){var m=Qt(a);this._callbacks[m]=this._callbacks[m]||[],this._callbacks[m].push({fn:l,context:p})}remove(a,l,p){if(!a&&!l&&!p){this._callbacks={};return}var m=a?[Qt(a)]:Yn(this._callbacks);l||p?this.removeCallback(m,l,p):this.removeAllCallbacks(m)}removeCallback(a,l,p){Ke(a,function(m){this._callbacks[m]=er(this._callbacks[m]||[],function(C){return l&&l!==C.fn||p&&p!==C.context}),this._callbacks[m].length===0&&delete this._callbacks[m]},this)}removeAllCallbacks(a){Ke(a,function(l){delete this._callbacks[l]},this)}}function Qt(h){return"_"+h}class be{constructor(a){this.callbacks=new Ys,this.global_callbacks=[],this.failThrough=a}bind(a,l,p){return this.callbacks.add(a,l,p),this}bind_global(a){return this.global_callbacks.push(a),this}unbind(a,l,p){return this.callbacks.remove(a,l,p),this}unbind_global(a){return a?(this.global_callbacks=er(this.global_callbacks||[],l=>l!==a),this):(this.global_callbacks=[],this)}unbind_all(){return this.unbind(),this.unbind_global(),this}emit(a,l,p){for(var m=0;m<this.global_callbacks.length;m++)this.global_callbacks[m](a,l);var C=this.callbacks.get(a),T=[];if(p?T.push(l,p):l&&T.push(l),C&&C.length>0)for(var m=0;m<C.length;m++)C[m].fn.apply(C[m].context||window,T);else this.failThrough&&this.failThrough(a,l);return this}}class Zs extends be{constructor(a,l,p,m,C){super(),this.initialize=I.transportConnectionInitializer,this.hooks=a,this.name=l,this.priority=p,this.key=m,this.options=C,this.state="new",this.timeline=C.timeline,this.activityTimeout=C.activityTimeout,this.id=this.timeline.generateUniqueID()}handlesActivityChecks(){return!!this.hooks.handlesActivityChecks}supportsPing(){return!!this.hooks.supportsPing}connect(){if(this.socket||this.state!=="initialized")return!1;var a=this.hooks.urls.getInitial(this.key,this.options);try{this.socket=this.hooks.getSocket(a,this.options)}catch(l){return Z.defer(()=>{this.onError(l),this.changeState("closed")}),!1}return this.bindListeners(),H.debug("Connecting",{transport:this.name,url:a}),this.changeState("connecting"),!0}close(){return this.socket?(this.socket.close(),!0):!1}send(a){return this.state==="open"?(Z.defer(()=>{this.socket&&this.socket.send(a)}),!0):!1}ping(){this.state==="open"&&this.supportsPing()&&this.socket.ping()}onOpen(){this.hooks.beforeOpen&&this.hooks.beforeOpen(this.socket,this.hooks.urls.getPath(this.key,this.options)),this.changeState("open"),this.socket.onopen=void 0}onError(a){this.emit("error",{type:"WebSocketError",error:a}),this.timeline.error(this.buildTimelineMessage({error:a.toString()}))}onClose(a){a?this.changeState("closed",{code:a.code,reason:a.reason,wasClean:a.wasClean}):this.changeState("closed"),this.unbindListeners(),this.socket=void 0}onMessage(a){this.emit("message",a)}onActivity(){this.emit("activity")}bindListeners(){this.socket.onopen=()=>{this.onOpen()},this.socket.onerror=a=>{this.onError(a)},this.socket.onclose=a=>{this.onClose(a)},this.socket.onmessage=a=>{this.onMessage(a)},this.supportsPing()&&(this.socket.onactivity=()=>{this.onActivity()})}unbindListeners(){this.socket&&(this.socket.onopen=void 0,this.socket.onerror=void 0,this.socket.onclose=void 0,this.socket.onmessage=void 0,this.supportsPing()&&(this.socket.onactivity=void 0))}changeState(a,l){this.state=a,this.timeline.info(this.buildTimelineMessage({state:a,params:l})),this.emit(a,l)}buildTimelineMessage(a){return ne({cid:this.id},a)}}class De{constructor(a){this.hooks=a}isSupported(a){return this.hooks.isSupported(a)}createConnection(a,l,p,m){return new Zs(this.hooks,a,l,p,m)}}var eo=new De({urls:Ks,handlesActivityChecks:!1,supportsPing:!1,isInitialized:function(){return!!I.getWebSocketAPI()},isSupported:function(){return!!I.getWebSocketAPI()},getSocket:function(h){return I.createWebSocket(h)}}),rr={urls:Gs,handlesActivityChecks:!1,supportsPing:!0,isInitialized:function(){return!0}},ir=ne({getSocket:function(h){return I.HTTPFactory.createStreamingSocket(h)}},rr),sr=ne({getSocket:function(h){return I.HTTPFactory.createPollingSocket(h)}},rr),or={isSupported:function(){return I.isXHRSupported()}},to=new De(ne({},ir,or)),no=new De(ne({},sr,or)),ro={ws:eo,xhr_streaming:to,xhr_polling:no},mt=ro,so=new De({file:"sockjs",urls:Qs,handlesActivityChecks:!0,supportsPing:!1,isSupported:function(){return!0},isInitialized:function(){return window.SockJS!==void 0},getSocket:function(h,a){return new window.SockJS(h,null,{js_path:g.getPath("sockjs",{useTLS:a.useTLS}),ignore_null_origin:a.ignoreNullOrigin})},beforeOpen:function(h,a){h.send(JSON.stringify({path:a}))}}),ar={isSupported:function(h){var a=I.isXDRSupported(h.useTLS);return a}},oo=new De(ne({},ir,ar)),ao=new De(ne({},sr,ar));mt.xdr_streaming=oo,mt.xdr_polling=ao,mt.sockjs=so;var co=mt;class lo extends be{constructor(){super();var a=this;window.addEventListener!==void 0&&(window.addEventListener("online",function(){a.emit("online")},!1),window.addEventListener("offline",function(){a.emit("offline")},!1))}isOnline(){return window.navigator.onLine===void 0?!0:window.navigator.onLine}}var uo=new lo;class ho{constructor(a,l,p){this.manager=a,this.transport=l,this.minPingDelay=p.minPingDelay,this.maxPingDelay=p.maxPingDelay,this.pingDelay=void 0}createConnection(a,l,p,m){m=ne({},m,{activityTimeout:this.pingDelay});var C=this.transport.createConnection(a,l,p,m),T=null,A=function(){C.unbind("open",A),C.bind("closed",P),T=Z.now()},P=L=>{if(C.unbind("closed",P),L.code===1002||L.code===1003)this.manager.reportDeath();else if(!L.wasClean&&T){var z=Z.now()-T;z<2*this.maxPingDelay&&(this.manager.reportDeath(),this.pingDelay=Math.max(z/2,this.minPingDelay))}};return C.bind("open",A),C}isSupported(a){return this.manager.isAlive()&&this.transport.isSupported(a)}}const cr={decodeMessage:function(h){try{var a=JSON.parse(h.data),l=a.data;if(typeof l=="string")try{l=JSON.parse(a.data)}catch{}var p={event:a.event,channel:a.channel,data:l};return a.user_id&&(p.user_id=a.user_id),p}catch(m){throw{type:"MessageParseError",error:m,data:h.data}}},encodeMessage:function(h){return JSON.stringify(h)},processHandshake:function(h){var a=cr.decodeMessage(h);if(a.event==="pusher:connection_established"){if(!a.data.activity_timeout)throw"No activity timeout specified in handshake";return{action:"connected",id:a.data.socket_id,activityTimeout:a.data.activity_timeout*1e3}}else{if(a.event==="pusher:error")return{action:this.getCloseAction(a.data),error:this.getCloseError(a.data)};throw"Invalid handshake"}},getCloseAction:function(h){return h.code<4e3?h.code>=1002&&h.code<=1004?"backoff":null:h.code===4e3?"tls_only":h.code<4100?"refused":h.code<4200?"backoff":h.code<4300?"retry":"refused"},getCloseError:function(h){return h.code!==1e3&&h.code!==1001?{type:"PusherError",data:{code:h.code,message:h.reason||h.message}}:null}};var Ce=cr;class fo extends be{constructor(a,l){super(),this.id=a,this.transport=l,this.activityTimeout=l.activityTimeout,this.bindListeners()}handlesActivityChecks(){return this.transport.handlesActivityChecks()}send(a){return this.transport.send(a)}send_event(a,l,p){var m={event:a,data:l};return p&&(m.channel=p),H.debug("Event sent",m),this.send(Ce.encodeMessage(m))}ping(){this.transport.supportsPing()?this.transport.ping():this.send_event("pusher:ping",{})}close(){this.transport.close()}bindListeners(){var a={message:p=>{var m;try{m=Ce.decodeMessage(p)}catch(C){this.emit("error",{type:"MessageParseError",error:C,data:p.data})}if(m!==void 0){switch(H.debug("Event recd",m),m.event){case"pusher:error":this.emit("error",{type:"PusherError",data:m.data});break;case"pusher:ping":this.emit("ping");break;case"pusher:pong":this.emit("pong");break}this.emit("message",m)}},activity:()=>{this.emit("activity")},error:p=>{this.emit("error",p)},closed:p=>{l(),p&&p.code&&this.handleCloseEvent(p),this.transport=null,this.emit("closed")}},l=()=>{ye(a,(p,m)=>{this.transport.unbind(m,p)})};ye(a,(p,m)=>{this.transport.bind(m,p)})}handleCloseEvent(a){var l=Ce.getCloseAction(a),p=Ce.getCloseError(a);p&&this.emit("error",p),l&&this.emit(l,{action:l,error:p})}}class po{constructor(a,l){this.transport=a,this.callback=l,this.bindListeners()}close(){this.unbindListeners(),this.transport.close()}bindListeners(){this.onMessage=a=>{this.unbindListeners();var l;try{l=Ce.processHandshake(a)}catch(p){this.finish("error",{error:p}),this.transport.close();return}l.action==="connected"?this.finish("connected",{connection:new fo(l.id,this.transport),activityTimeout:l.activityTimeout}):(this.finish(l.action,{error:l.error}),this.transport.close())},this.onClosed=a=>{this.unbindListeners();var l=Ce.getCloseAction(a)||"backoff",p=Ce.getCloseError(a);this.finish(l,{error:p})},this.transport.bind("message",this.onMessage),this.transport.bind("closed",this.onClosed)}unbindListeners(){this.transport.unbind("message",this.onMessage),this.transport.unbind("closed",this.onClosed)}finish(a,l){this.callback(ne({transport:this.transport,action:a},l))}}class mo{constructor(a,l){this.timeline=a,this.options=l||{}}send(a,l){this.timeline.isEmpty()||this.timeline.send(I.TimelineTransport.getAgent(this,a),l)}}class Yt extends be{constructor(a,l){super(function(p,m){H.debug("No callbacks on "+a+" for "+p)}),this.name=a,this.pusher=l,this.subscribed=!1,this.subscriptionPending=!1,this.subscriptionCancelled=!1}authorize(a,l){return l(null,{auth:""})}trigger(a,l){if(a.indexOf("client-")!==0)throw new k("Event '"+a+"' does not start with 'client-'");if(!this.subscribed){var p=b.buildLogSuffix("triggeringClientEvents");H.warn(`Client event triggered before channel 'subscription_succeeded' event . ${p}`)}return this.pusher.send_event(a,l,this.name)}disconnect(){this.subscribed=!1,this.subscriptionPending=!1}handleEvent(a){var l=a.event,p=a.data;if(l==="pusher_internal:subscription_succeeded")this.handleSubscriptionSucceededEvent(a);else if(l==="pusher_internal:subscription_count")this.handleSubscriptionCountEvent(a);else if(l.indexOf("pusher_internal:")!==0){var m={};this.emit(l,p,m)}}handleSubscriptionSucceededEvent(a){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):this.emit("pusher:subscription_succeeded",a.data)}handleSubscriptionCountEvent(a){a.data.subscription_count&&(this.subscriptionCount=a.data.subscription_count),this.emit("pusher:subscription_count",a.data)}subscribe(){this.subscribed||(this.subscriptionPending=!0,this.subscriptionCancelled=!1,this.authorize(this.pusher.connection.socket_id,(a,l)=>{a?(this.subscriptionPending=!1,H.error(a.toString()),this.emit("pusher:subscription_error",Object.assign({},{type:"AuthError",error:a.message},a instanceof q?{status:a.status}:{}))):this.pusher.send_event("pusher:subscribe",{auth:l.auth,channel_data:l.channel_data,channel:this.name})}))}unsubscribe(){this.subscribed=!1,this.pusher.send_event("pusher:unsubscribe",{channel:this.name})}cancelSubscription(){this.subscriptionCancelled=!0}reinstateSubscription(){this.subscriptionCancelled=!1}}class Zt extends Yt{authorize(a,l){return this.pusher.config.channelAuthorizer({channelName:this.name,socketId:a},l)}}class go{constructor(){this.reset()}get(a){return Object.prototype.hasOwnProperty.call(this.members,a)?{id:a,info:this.members[a]}:null}each(a){ye(this.members,(l,p)=>{a(this.get(p))})}setMyID(a){this.myID=a}onSubscription(a){this.members=a.presence.hash,this.count=a.presence.count,this.me=this.get(this.myID)}addMember(a){return this.get(a.user_id)===null&&this.count++,this.members[a.user_id]=a.user_info,this.get(a.user_id)}removeMember(a){var l=this.get(a.user_id);return l&&(delete this.members[a.user_id],this.count--),l}reset(){this.members={},this.count=0,this.myID=null,this.me=null}}var yo=function(h,a,l,p){function m(C){return C instanceof l?C:new l(function(T){T(C)})}return new(l||(l=Promise))(function(C,T){function A(z){try{L(p.next(z))}catch(W){T(W)}}function P(z){try{L(p.throw(z))}catch(W){T(W)}}function L(z){z.done?C(z.value):m(z.value).then(A,P)}L((p=p.apply(h,a||[])).next())})};class bo extends Zt{constructor(a,l){super(a,l),this.members=new go}authorize(a,l){super.authorize(a,(p,m)=>yo(this,void 0,void 0,function*(){if(!p)if(m=m,m.channel_data!=null){var C=JSON.parse(m.channel_data);this.members.setMyID(C.user_id)}else if(yield this.pusher.user.signinDonePromise,this.pusher.user.user_data!=null)this.members.setMyID(this.pusher.user.user_data.id);else{let T=b.buildLogSuffix("authorizationEndpoint");H.error(`Invalid auth response for channel '${this.name}', expected 'channel_data' field. ${T}, or the user should be signed in.`),l("Invalid auth response");return}l(p,m)}))}handleEvent(a){var l=a.event;if(l.indexOf("pusher_internal:")===0)this.handleInternalEvent(a);else{var p=a.data,m={};a.user_id&&(m.user_id=a.user_id),this.emit(l,p,m)}}handleInternalEvent(a){var l=a.event,p=a.data;switch(l){case"pusher_internal:subscription_succeeded":this.handleSubscriptionSucceededEvent(a);break;case"pusher_internal:subscription_count":this.handleSubscriptionCountEvent(a);break;case"pusher_internal:member_added":var m=this.members.addMember(p);this.emit("pusher:member_added",m);break;case"pusher_internal:member_removed":var C=this.members.removeMember(p);C&&this.emit("pusher:member_removed",C);break}}handleSubscriptionSucceededEvent(a){this.subscriptionPending=!1,this.subscribed=!0,this.subscriptionCancelled?this.pusher.unsubscribe(this.name):(this.members.onSubscription(a.data),this.emit("pusher:subscription_succeeded",this.members))}disconnect(){this.members.reset(),super.disconnect()}}var wo=i(1),en=i(0);class vo extends Zt{constructor(a,l,p){super(a,l),this.key=null,this.nacl=p}authorize(a,l){super.authorize(a,(p,m)=>{if(p){l(p,m);return}let C=m.shared_secret;if(!C){l(new Error(`No shared_secret key in auth payload for encrypted channel: ${this.name}`),null);return}this.key=Object(en.decode)(C),delete m.shared_secret,l(null,m)})}trigger(a,l){throw new F("Client events are not currently supported for encrypted channels")}handleEvent(a){var l=a.event,p=a.data;if(l.indexOf("pusher_internal:")===0||l.indexOf("pusher:")===0){super.handleEvent(a);return}this.handleEncryptedEvent(l,p)}handleEncryptedEvent(a,l){if(!this.key){H.debug("Received encrypted event before key has been retrieved from the authEndpoint");return}if(!l.ciphertext||!l.nonce){H.error("Unexpected format for encrypted event, expected object with `ciphertext` and `nonce` fields, got: "+l);return}let p=Object(en.decode)(l.ciphertext);if(p.length<this.nacl.secretbox.overheadLength){H.error(`Expected encrypted event ciphertext length to be ${this.nacl.secretbox.overheadLength}, got: ${p.length}`);return}let m=Object(en.decode)(l.nonce);if(m.length<this.nacl.secretbox.nonceLength){H.error(`Expected encrypted event nonce length to be ${this.nacl.secretbox.nonceLength}, got: ${m.length}`);return}let C=this.nacl.secretbox.open(p,m,this.key);if(C===null){H.debug("Failed to decrypt an event, probably because it was encrypted with a different key. Fetching a new key from the authEndpoint..."),this.authorize(this.pusher.connection.socket_id,(T,A)=>{if(T){H.error(`Failed to make a request to the authEndpoint: ${A}. Unable to fetch new key, so dropping encrypted event`);return}if(C=this.nacl.secretbox.open(p,m,this.key),C===null){H.error("Failed to decrypt event with new key. Dropping encrypted event");return}this.emit(a,this.getDataToEmit(C))});return}this.emit(a,this.getDataToEmit(C))}getDataToEmit(a){let l=Object(wo.decode)(a);try{return JSON.parse(l)}catch{return l}}}class ko extends be{constructor(a,l){super(),this.state="initialized",this.connection=null,this.key=a,this.options=l,this.timeline=this.options.timeline,this.usingTLS=this.options.useTLS,this.errorCallbacks=this.buildErrorCallbacks(),this.connectionCallbacks=this.buildConnectionCallbacks(this.errorCallbacks),this.handshakeCallbacks=this.buildHandshakeCallbacks(this.errorCallbacks);var p=I.getNetwork();p.bind("online",()=>{this.timeline.info({netinfo:"online"}),(this.state==="connecting"||this.state==="unavailable")&&this.retryIn(0)}),p.bind("offline",()=>{this.timeline.info({netinfo:"offline"}),this.connection&&this.sendActivityCheck()}),this.updateStrategy()}switchCluster(a){this.key=a,this.updateStrategy(),this.retryIn(0)}connect(){if(!(this.connection||this.runner)){if(!this.strategy.isSupported()){this.updateState("failed");return}this.updateState("connecting"),this.startConnecting(),this.setUnavailableTimer()}}send(a){return this.connection?this.connection.send(a):!1}send_event(a,l,p){return this.connection?this.connection.send_event(a,l,p):!1}disconnect(){this.disconnectInternally(),this.updateState("disconnected")}isUsingTLS(){return this.usingTLS}startConnecting(){var a=(l,p)=>{l?this.runner=this.strategy.connect(0,a):p.action==="error"?(this.emit("error",{type:"HandshakeError",error:p.error}),this.timeline.error({handshakeError:p.error})):(this.abortConnecting(),this.handshakeCallbacks[p.action](p))};this.runner=this.strategy.connect(0,a)}abortConnecting(){this.runner&&(this.runner.abort(),this.runner=null)}disconnectInternally(){if(this.abortConnecting(),this.clearRetryTimer(),this.clearUnavailableTimer(),this.connection){var a=this.abandonConnection();a.close()}}updateStrategy(){this.strategy=this.options.getStrategy({key:this.key,timeline:this.timeline,useTLS:this.usingTLS})}retryIn(a){this.timeline.info({action:"retry",delay:a}),a>0&&this.emit("connecting_in",Math.round(a/1e3)),this.retryTimer=new xe(a||0,()=>{this.disconnectInternally(),this.connect()})}clearRetryTimer(){this.retryTimer&&(this.retryTimer.ensureAborted(),this.retryTimer=null)}setUnavailableTimer(){this.unavailableTimer=new xe(this.options.unavailableTimeout,()=>{this.updateState("unavailable")})}clearUnavailableTimer(){this.unavailableTimer&&this.unavailableTimer.ensureAborted()}sendActivityCheck(){this.stopActivityCheck(),this.connection.ping(),this.activityTimer=new xe(this.options.pongTimeout,()=>{this.timeline.error({pong_timed_out:this.options.pongTimeout}),this.retryIn(0)})}resetActivityCheck(){this.stopActivityCheck(),this.connection&&!this.connection.handlesActivityChecks()&&(this.activityTimer=new xe(this.activityTimeout,()=>{this.sendActivityCheck()}))}stopActivityCheck(){this.activityTimer&&this.activityTimer.ensureAborted()}buildConnectionCallbacks(a){return ne({},a,{message:l=>{this.resetActivityCheck(),this.emit("message",l)},ping:()=>{this.send_event("pusher:pong",{})},activity:()=>{this.resetActivityCheck()},error:l=>{this.emit("error",l)},closed:()=>{this.abandonConnection(),this.shouldRetry()&&this.retryIn(1e3)}})}buildHandshakeCallbacks(a){return ne({},a,{connected:l=>{this.activityTimeout=Math.min(this.options.activityTimeout,l.activityTimeout,l.connection.activityTimeout||1/0),this.clearUnavailableTimer(),this.setConnection(l.connection),this.socket_id=this.connection.id,this.updateState("connected",{socket_id:this.socket_id})}})}buildErrorCallbacks(){let a=l=>p=>{p.error&&this.emit("error",{type:"WebSocketError",error:p.error}),l(p)};return{tls_only:a(()=>{this.usingTLS=!0,this.updateStrategy(),this.retryIn(0)}),refused:a(()=>{this.disconnect()}),backoff:a(()=>{this.retryIn(1e3)}),retry:a(()=>{this.retryIn(0)})}}setConnection(a){this.connection=a;for(var l in this.connectionCallbacks)this.connection.bind(l,this.connectionCallbacks[l]);this.resetActivityCheck()}abandonConnection(){if(this.connection){this.stopActivityCheck();for(var a in this.connectionCallbacks)this.connection.unbind(a,this.connectionCallbacks[a]);var l=this.connection;return this.connection=null,l}}updateState(a,l){var p=this.state;if(this.state=a,p!==a){var m=a;m==="connected"&&(m+=" with new socket ID "+l.socket_id),H.debug("State changed",p+" -> "+m),this.timeline.info({state:a,params:l}),this.emit("state_change",{previous:p,current:a}),this.emit(a,l)}}shouldRetry(){return this.state==="connecting"||this.state==="connected"}}class So{constructor(){this.channels={}}add(a,l){return this.channels[a]||(this.channels[a]=xo(a,l)),this.channels[a]}all(){return Ms(this.channels)}find(a){return this.channels[a]}remove(a){var l=this.channels[a];return delete this.channels[a],l}disconnect(){ye(this.channels,function(a){a.disconnect()})}}function xo(h,a){if(h.indexOf("private-encrypted-")===0){if(a.config.nacl)return we.createEncryptedChannel(h,a,a.config.nacl);let l="Tried to subscribe to a private-encrypted- channel but no nacl implementation available",p=b.buildLogSuffix("encryptedChannelSupport");throw new F(`${l}. ${p}`)}else{if(h.indexOf("private-")===0)return we.createPrivateChannel(h,a);if(h.indexOf("presence-")===0)return we.createPresenceChannel(h,a);if(h.indexOf("#")===0)throw new x('Cannot create a channel with name "'+h+'".');return we.createChannel(h,a)}}var Co={createChannels(){return new So},createConnectionManager(h,a){return new ko(h,a)},createChannel(h,a){return new Yt(h,a)},createPrivateChannel(h,a){return new Zt(h,a)},createPresenceChannel(h,a){return new bo(h,a)},createEncryptedChannel(h,a,l){return new vo(h,a,l)},createTimelineSender(h,a){return new mo(h,a)},createHandshake(h,a){return new po(h,a)},createAssistantToTheTransportManager(h,a,l){return new ho(h,a,l)}},we=Co;class lr{constructor(a){this.options=a||{},this.livesLeft=this.options.lives||1/0}getAssistant(a){return we.createAssistantToTheTransportManager(this,a,{minPingDelay:this.options.minPingDelay,maxPingDelay:this.options.maxPingDelay})}isAlive(){return this.livesLeft>0}reportDeath(){this.livesLeft-=1}}class Te{constructor(a,l){this.strategies=a,this.loop=!!l.loop,this.failFast=!!l.failFast,this.timeout=l.timeout,this.timeoutLimit=l.timeoutLimit}isSupported(){return nr(this.strategies,Z.method("isSupported"))}connect(a,l){var p=this.strategies,m=0,C=this.timeout,T=null,A=(P,L)=>{L?l(null,L):(m=m+1,this.loop&&(m=m%p.length),m<p.length?(C&&(C=C*2,this.timeoutLimit&&(C=Math.min(C,this.timeoutLimit))),T=this.tryStrategy(p[m],a,{timeout:C,failFast:this.failFast},A)):l(!0))};return T=this.tryStrategy(p[m],a,{timeout:C,failFast:this.failFast},A),{abort:function(){T.abort()},forceMinPriority:function(P){a=P,T&&T.forceMinPriority(P)}}}tryStrategy(a,l,p,m){var C=null,T=null;return p.timeout>0&&(C=new xe(p.timeout,function(){T.abort(),m(!0)})),T=a.connect(l,function(A,P){A&&C&&C.isRunning()&&!p.failFast||(C&&C.ensureAborted(),m(A,P))}),{abort:function(){C&&C.ensureAborted(),T.abort()},forceMinPriority:function(A){T.forceMinPriority(A)}}}}class tn{constructor(a){this.strategies=a}isSupported(){return nr(this.strategies,Z.method("isSupported"))}connect(a,l){return To(this.strategies,a,function(p,m){return function(C,T){if(m[p].error=C,C){Eo(m)&&l(!0);return}Ke(m,function(A){A.forceMinPriority(T.transport.priority)}),l(null,T)}})}}function To(h,a,l){var p=Zn(h,function(m,C,T,A){return m.connect(a,l(C,A))});return{abort:function(){Ke(p,Oo)},forceMinPriority:function(m){Ke(p,function(C){C.forceMinPriority(m)})}}}function Eo(h){return Fs(h,function(a){return!!a.error})}function Oo(h){!h.error&&!h.aborted&&(h.abort(),h.aborted=!0)}class _o{constructor(a,l,p){this.strategy=a,this.transports=l,this.ttl=p.ttl||1800*1e3,this.usingTLS=p.useTLS,this.timeline=p.timeline}isSupported(){return this.strategy.isSupported()}connect(a,l){var p=this.usingTLS,m=Ao(p),C=m&&m.cacheSkipCount?m.cacheSkipCount:0,T=[this.strategy];if(m&&m.timestamp+this.ttl>=Z.now()){var A=this.transports[m.transport];A&&(["ws","wss"].includes(m.transport)||C>3?(this.timeline.info({cached:!0,transport:m.transport,latency:m.latency}),T.push(new Te([A],{timeout:m.latency*2+1e3,failFast:!0}))):C++)}var P=Z.now(),L=T.pop().connect(a,function z(W,bt){W?(ur(p),T.length>0?(P=Z.now(),L=T.pop().connect(a,z)):l(W)):(Ro(p,bt.transport.name,Z.now()-P,C),l(null,bt))});return{abort:function(){L.abort()},forceMinPriority:function(z){a=z,L&&L.forceMinPriority(z)}}}}function nn(h){return"pusherTransport"+(h?"TLS":"NonTLS")}function Ao(h){var a=I.getLocalStorage();if(a)try{var l=a[nn(h)];if(l)return JSON.parse(l)}catch{ur(h)}return null}function Ro(h,a,l,p){var m=I.getLocalStorage();if(m)try{m[nn(h)]=pt({timestamp:Z.now(),transport:a,latency:l,cacheSkipCount:p})}catch{}}function ur(h){var a=I.getLocalStorage();if(a)try{delete a[nn(h)]}catch{}}class gt{constructor(a,{delay:l}){this.strategy=a,this.options={delay:l}}isSupported(){return this.strategy.isSupported()}connect(a,l){var p=this.strategy,m,C=new xe(this.options.delay,function(){m=p.connect(a,l)});return{abort:function(){C.ensureAborted(),m&&m.abort()},forceMinPriority:function(T){a=T,m&&m.forceMinPriority(T)}}}}class Ge{constructor(a,l,p){this.test=a,this.trueBranch=l,this.falseBranch=p}isSupported(){var a=this.test()?this.trueBranch:this.falseBranch;return a.isSupported()}connect(a,l){var p=this.test()?this.trueBranch:this.falseBranch;return p.connect(a,l)}}class Po{constructor(a){this.strategy=a}isSupported(){return this.strategy.isSupported()}connect(a,l){var p=this.strategy.connect(a,function(m,C){C&&p.abort(),l(m,C)});return p}}function Qe(h){return function(){return h.isSupported()}}var Io=function(h,a,l){var p={};function m(xr,Ra,Pa,Ia,Na){var Cr=l(h,xr,Ra,Pa,Ia,Na);return p[xr]=Cr,Cr}var C=Object.assign({},a,{hostNonTLS:h.wsHost+":"+h.wsPort,hostTLS:h.wsHost+":"+h.wssPort,httpPath:h.wsPath}),T=Object.assign({},C,{useTLS:!0}),A=Object.assign({},a,{hostNonTLS:h.httpHost+":"+h.httpPort,hostTLS:h.httpHost+":"+h.httpsPort,httpPath:h.httpPath}),P={loop:!0,timeout:15e3,timeoutLimit:6e4},L=new lr({minPingDelay:1e4,maxPingDelay:h.activityTimeout}),z=new lr({lives:2,minPingDelay:1e4,maxPingDelay:h.activityTimeout}),W=m("ws","ws",3,C,L),bt=m("wss","ws",3,T,L),Ta=m("sockjs","sockjs",1,A),yr=m("xhr_streaming","xhr_streaming",1,A,z),Ea=m("xdr_streaming","xdr_streaming",1,A,z),br=m("xhr_polling","xhr_polling",1,A),Oa=m("xdr_polling","xdr_polling",1,A),wr=new Te([W],P),_a=new Te([bt],P),Aa=new Te([Ta],P),vr=new Te([new Ge(Qe(yr),yr,Ea)],P),kr=new Te([new Ge(Qe(br),br,Oa)],P),Sr=new Te([new Ge(Qe(vr),new tn([vr,new gt(kr,{delay:4e3})]),kr)],P),an=new Ge(Qe(Sr),Sr,Aa),cn;return a.useTLS?cn=new tn([wr,new gt(an,{delay:2e3})]):cn=new tn([wr,new gt(_a,{delay:2e3}),new gt(an,{delay:5e3})]),new _o(new Po(new Ge(Qe(W),cn,an)),p,{ttl:18e5,timeline:a.timeline,useTLS:a.useTLS})},No=Io,Mo=function(){var h=this;h.timeline.info(h.buildTimelineMessage({transport:h.name+(h.options.useTLS?"s":"")})),h.hooks.isInitialized()?h.changeState("initialized"):h.hooks.file?(h.changeState("initializing"),g.load(h.hooks.file,{useTLS:h.options.useTLS},function(a,l){h.hooks.isInitialized()?(h.changeState("initialized"),l(!0)):(a&&h.onError(a),h.onClose(),l(!1))})):h.onClose()},Lo={getRequest:function(h){var a=new window.XDomainRequest;return a.ontimeout=function(){h.emit("error",new O),h.close()},a.onerror=function(l){h.emit("error",l),h.close()},a.onprogress=function(){a.responseText&&a.responseText.length>0&&h.onChunk(200,a.responseText)},a.onload=function(){a.responseText&&a.responseText.length>0&&h.onChunk(200,a.responseText),h.emit("finished",200),h.close()},a},abortRequest:function(h){h.ontimeout=h.onerror=h.onprogress=h.onload=null,h.abort()}},Bo=Lo;const Fo=256*1024;class zo extends be{constructor(a,l,p){super(),this.hooks=a,this.method=l,this.url=p}start(a){this.position=0,this.xhr=this.hooks.getRequest(this),this.unloader=()=>{this.close()},I.addUnloadListener(this.unloader),this.xhr.open(this.method,this.url,!0),this.xhr.setRequestHeader&&this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.send(a)}close(){this.unloader&&(I.removeUnloadListener(this.unloader),this.unloader=null),this.xhr&&(this.hooks.abortRequest(this.xhr),this.xhr=null)}onChunk(a,l){for(;;){var p=this.advanceBuffer(l);if(p)this.emit("chunk",{status:a,data:p});else break}this.isBufferTooLong(l)&&this.emit("buffer_too_long")}advanceBuffer(a){var l=a.slice(this.position),p=l.indexOf(`
`);return p!==-1?(this.position+=p+1,l.slice(0,p)):null}isBufferTooLong(a){return this.position===a.length&&a.length>Fo}}var rn;(function(h){h[h.CONNECTING=0]="CONNECTING",h[h.OPEN=1]="OPEN",h[h.CLOSED=3]="CLOSED"})(rn||(rn={}));var Ee=rn,jo=1;class Do{constructor(a,l){this.hooks=a,this.session=fr(1e3)+"/"+Ho(8),this.location=Uo(l),this.readyState=Ee.CONNECTING,this.openStream()}send(a){return this.sendRaw(JSON.stringify([a]))}ping(){this.hooks.sendHeartbeat(this)}close(a,l){this.onClose(a,l,!0)}sendRaw(a){if(this.readyState===Ee.OPEN)try{return I.createSocketRequest("POST",hr(qo(this.location,this.session))).start(a),!0}catch{return!1}else return!1}reconnect(){this.closeStream(),this.openStream()}onClose(a,l,p){this.closeStream(),this.readyState=Ee.CLOSED,this.onclose&&this.onclose({code:a,reason:l,wasClean:p})}onChunk(a){if(a.status===200){this.readyState===Ee.OPEN&&this.onActivity();var l,p=a.data.slice(0,1);switch(p){case"o":l=JSON.parse(a.data.slice(1)||"{}"),this.onOpen(l);break;case"a":l=JSON.parse(a.data.slice(1)||"[]");for(var m=0;m<l.length;m++)this.onEvent(l[m]);break;case"m":l=JSON.parse(a.data.slice(1)||"null"),this.onEvent(l);break;case"h":this.hooks.onHeartbeat(this);break;case"c":l=JSON.parse(a.data.slice(1)||"[]"),this.onClose(l[0],l[1],!0);break}}}onOpen(a){this.readyState===Ee.CONNECTING?(a&&a.hostname&&(this.location.base=Jo(this.location.base,a.hostname)),this.readyState=Ee.OPEN,this.onopen&&this.onopen()):this.onClose(1006,"Server lost session",!0)}onEvent(a){this.readyState===Ee.OPEN&&this.onmessage&&this.onmessage({data:a})}onActivity(){this.onactivity&&this.onactivity()}onError(a){this.onerror&&this.onerror(a)}openStream(){this.stream=I.createSocketRequest("POST",hr(this.hooks.getReceiveURL(this.location,this.session))),this.stream.bind("chunk",a=>{this.onChunk(a)}),this.stream.bind("finished",a=>{this.hooks.onFinished(this,a)}),this.stream.bind("buffer_too_long",()=>{this.reconnect()});try{this.stream.start()}catch(a){Z.defer(()=>{this.onError(a),this.onClose(1006,"Could not start streaming",!1)})}}closeStream(){this.stream&&(this.stream.unbind_all(),this.stream.close(),this.stream=null)}}function Uo(h){var a=/([^\?]*)\/*(\??.*)/.exec(h);return{base:a[1],queryString:a[2]}}function qo(h,a){return h.base+"/"+a+"/xhr_send"}function hr(h){var a=h.indexOf("?")===-1?"?":"&";return h+a+"t="+ +new Date+"&n="+jo++}function Jo(h,a){var l=/(https?:\/\/)([^\/:]+)((\/|:)?.*)/.exec(h);return l[1]+a+l[3]}function fr(h){return I.randomInt(h)}function Ho(h){for(var a=[],l=0;l<h;l++)a.push(fr(32).toString(32));return a.join("")}var $o=Do,Wo={getReceiveURL:function(h,a){return h.base+"/"+a+"/xhr_streaming"+h.queryString},onHeartbeat:function(h){h.sendRaw("[]")},sendHeartbeat:function(h){h.sendRaw("[]")},onFinished:function(h,a){h.onClose(1006,"Connection interrupted ("+a+")",!1)}},Vo=Wo,Xo={getReceiveURL:function(h,a){return h.base+"/"+a+"/xhr"+h.queryString},onHeartbeat:function(){},sendHeartbeat:function(h){h.sendRaw("[]")},onFinished:function(h,a){a===200?h.reconnect():h.onClose(1006,"Connection interrupted ("+a+")",!1)}},Ko=Xo,Go={getRequest:function(h){var a=I.getXHRAPI(),l=new a;return l.onreadystatechange=l.onprogress=function(){switch(l.readyState){case 3:l.responseText&&l.responseText.length>0&&h.onChunk(l.status,l.responseText);break;case 4:l.responseText&&l.responseText.length>0&&h.onChunk(l.status,l.responseText),h.emit("finished",l.status),h.close();break}},l},abortRequest:function(h){h.onreadystatechange=null,h.abort()}},Qo=Go,Yo={createStreamingSocket(h){return this.createSocket(Vo,h)},createPollingSocket(h){return this.createSocket(Ko,h)},createSocket(h,a){return new $o(h,a)},createXHR(h,a){return this.createRequest(Qo,h,a)},createRequest(h,a,l){return new zo(h,a,l)}},dr=Yo;dr.createXDR=function(h,a){return this.createRequest(Bo,h,a)};var Zo=dr,ea={nextAuthCallbackID:1,auth_callbacks:{},ScriptReceivers:o,DependenciesReceivers:d,getDefaultStrategy:No,Transports:co,transportConnectionInitializer:Mo,HTTPFactory:Zo,TimelineTransport:Xs,getXHRAPI(){return window.XMLHttpRequest},getWebSocketAPI(){return window.WebSocket||window.MozWebSocket},setup(h){window.Pusher=h;var a=()=>{this.onDocumentBody(h.ready)};window.JSON?a():g.load("json2",{},a)},getDocument(){return document},getProtocol(){return this.getDocument().location.protocol},getAuthorizers(){return{ajax:ve,jsonp:Js}},onDocumentBody(h){document.body?h():setTimeout(()=>{this.onDocumentBody(h)},0)},createJSONPRequest(h,a){return new $s(h,a)},createScriptRequest(h){return new Hs(h)},getLocalStorage(){try{return window.localStorage}catch{return}},createXHR(){return this.getXHRAPI()?this.createXMLHttpRequest():this.createMicrosoftXHR()},createXMLHttpRequest(){var h=this.getXHRAPI();return new h},createMicrosoftXHR(){return new ActiveXObject("Microsoft.XMLHTTP")},getNetwork(){return uo},createWebSocket(h){var a=this.getWebSocketAPI();return new a(h)},createSocketRequest(h,a){if(this.isXHRSupported())return this.HTTPFactory.createXHR(h,a);if(this.isXDRSupported(a.indexOf("https:")===0))return this.HTTPFactory.createXDR(h,a);throw"Cross-origin HTTP requests are not supported"},isXHRSupported(){var h=this.getXHRAPI();return!!h&&new h().withCredentials!==void 0},isXDRSupported(h){var a=h?"https:":"http:",l=this.getProtocol();return!!window.XDomainRequest&&l===a},addUnloadListener(h){window.addEventListener!==void 0?window.addEventListener("unload",h,!1):window.attachEvent!==void 0&&window.attachEvent("onunload",h)},removeUnloadListener(h){window.addEventListener!==void 0?window.removeEventListener("unload",h,!1):window.detachEvent!==void 0&&window.detachEvent("onunload",h)},randomInt(h){return Math.floor(function(){return(window.crypto||window.msCrypto).getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32)}()*h)}},I=ea,sn;(function(h){h[h.ERROR=3]="ERROR",h[h.INFO=6]="INFO",h[h.DEBUG=7]="DEBUG"})(sn||(sn={}));var yt=sn;class ta{constructor(a,l,p){this.key=a,this.session=l,this.events=[],this.options=p||{},this.sent=0,this.uniqueID=0}log(a,l){a<=this.options.level&&(this.events.push(ne({},l,{timestamp:Z.now()})),this.options.limit&&this.events.length>this.options.limit&&this.events.shift())}error(a){this.log(yt.ERROR,a)}info(a){this.log(yt.INFO,a)}debug(a){this.log(yt.DEBUG,a)}isEmpty(){return this.events.length===0}send(a,l){var p=ne({session:this.session,bundle:this.sent+1,key:this.key,lib:"js",version:this.options.version,cluster:this.options.cluster,features:this.options.features,timeline:this.events},this.options.params);return this.events=[],a(p,(m,C)=>{m||this.sent++,l&&l(m,C)}),!0}generateUniqueID(){return this.uniqueID++,this.uniqueID}}class na{constructor(a,l,p,m){this.name=a,this.priority=l,this.transport=p,this.options=m||{}}isSupported(){return this.transport.isSupported({useTLS:this.options.useTLS})}connect(a,l){if(this.isSupported()){if(this.priority<a)return pr(new _,l)}else return pr(new J,l);var p=!1,m=this.transport.createConnection(this.name,this.priority,this.options.key,this.options),C=null,T=function(){m.unbind("initialized",T),m.connect()},A=function(){C=we.createHandshake(m,function(W){p=!0,z(),l(null,W)})},P=function(W){z(),l(W)},L=function(){z();var W;W=pt(m),l(new M(W))},z=function(){m.unbind("initialized",T),m.unbind("open",A),m.unbind("error",P),m.unbind("closed",L)};return m.bind("initialized",T),m.bind("open",A),m.bind("error",P),m.bind("closed",L),m.initialize(),{abort:()=>{p||(z(),C?C.close():m.close())},forceMinPriority:W=>{p||this.priority<W&&(C?C.close():m.close())}}}}function pr(h,a){return Z.defer(function(){a(h)}),{abort:function(){},forceMinPriority:function(){}}}const{Transports:ra}=I;var ia=function(h,a,l,p,m,C){var T=ra[l];if(!T)throw new B(l);var A=(!h.enabledTransports||Qn(h.enabledTransports,a)!==-1)&&(!h.disabledTransports||Qn(h.disabledTransports,a)===-1),P;return A?(m=Object.assign({ignoreNullOrigin:h.ignoreNullOrigin},m),P=new na(a,p,C?C.getAssistant(T):T,m)):P=sa,P},sa={isSupported:function(){return!1},connect:function(h,a){var l=Z.defer(function(){a(new J)});return{abort:function(){l.ensureAborted()},forceMinPriority:function(){}}}};function oa(h){if(h==null)throw"You must pass an options object";if(h.cluster==null)throw"Options object must provide a cluster";"disableStats"in h&&H.warn("The disableStats option is deprecated in favor of enableStats")}const aa=(h,a)=>{var l="socket_id="+encodeURIComponent(h.socketId);for(var p in a.params)l+="&"+encodeURIComponent(p)+"="+encodeURIComponent(a.params[p]);if(a.paramsProvider!=null){let m=a.paramsProvider();for(var p in m)l+="&"+encodeURIComponent(p)+"="+encodeURIComponent(m[p])}return l};var ca=h=>{if(typeof I.getAuthorizers()[h.transport]>"u")throw`'${h.transport}' is not a recognized auth transport`;return(a,l)=>{const p=aa(a,h);I.getAuthorizers()[h.transport](I,p,h,y.UserAuthentication,l)}};const la=(h,a)=>{var l="socket_id="+encodeURIComponent(h.socketId);l+="&channel_name="+encodeURIComponent(h.channelName);for(var p in a.params)l+="&"+encodeURIComponent(p)+"="+encodeURIComponent(a.params[p]);if(a.paramsProvider!=null){let m=a.paramsProvider();for(var p in m)l+="&"+encodeURIComponent(p)+"="+encodeURIComponent(m[p])}return l};var ua=h=>{if(typeof I.getAuthorizers()[h.transport]>"u")throw`'${h.transport}' is not a recognized auth transport`;return(a,l)=>{const p=la(a,h);I.getAuthorizers()[h.transport](I,p,h,y.ChannelAuthorization,l)}};const ha=(h,a,l)=>{const p={authTransport:a.transport,authEndpoint:a.endpoint,auth:{params:a.params,headers:a.headers}};return(m,C)=>{const T=h.channel(m.channelName);l(T,p).authorize(m.socketId,C)}};function mr(h,a){let l={activityTimeout:h.activityTimeout||u.activityTimeout,cluster:h.cluster,httpPath:h.httpPath||u.httpPath,httpPort:h.httpPort||u.httpPort,httpsPort:h.httpsPort||u.httpsPort,pongTimeout:h.pongTimeout||u.pongTimeout,statsHost:h.statsHost||u.stats_host,unavailableTimeout:h.unavailableTimeout||u.unavailableTimeout,wsPath:h.wsPath||u.wsPath,wsPort:h.wsPort||u.wsPort,wssPort:h.wssPort||u.wssPort,enableStats:ga(h),httpHost:fa(h),useTLS:ma(h),wsHost:da(h),userAuthenticator:ya(h),channelAuthorizer:wa(h,a)};return"disabledTransports"in h&&(l.disabledTransports=h.disabledTransports),"enabledTransports"in h&&(l.enabledTransports=h.enabledTransports),"ignoreNullOrigin"in h&&(l.ignoreNullOrigin=h.ignoreNullOrigin),"timelineParams"in h&&(l.timelineParams=h.timelineParams),"nacl"in h&&(l.nacl=h.nacl),l}function fa(h){return h.httpHost?h.httpHost:h.cluster?`sockjs-${h.cluster}.pusher.com`:u.httpHost}function da(h){return h.wsHost?h.wsHost:pa(h.cluster)}function pa(h){return`ws-${h}.pusher.com`}function ma(h){return I.getProtocol()==="https:"?!0:h.forceTLS!==!1}function ga(h){return"enableStats"in h?h.enableStats:"disableStats"in h?!h.disableStats:!1}const gr=h=>"customHandler"in h&&h.customHandler!=null;function ya(h){const a=Object.assign(Object.assign({},u.userAuthentication),h.userAuthentication);return gr(a)?a.customHandler:ca(a)}function ba(h,a){let l;if("channelAuthorization"in h)l=Object.assign(Object.assign({},u.channelAuthorization),h.channelAuthorization);else if(l={transport:h.authTransport||u.authTransport,endpoint:h.authEndpoint||u.authEndpoint},"auth"in h&&("params"in h.auth&&(l.params=h.auth.params),"headers"in h.auth&&(l.headers=h.auth.headers)),"authorizer"in h)return{customHandler:ha(a,l,h.authorizer)};return l}function wa(h,a){const l=ba(h,a);return gr(l)?l.customHandler:ua(l)}class va extends be{constructor(a){super(function(l,p){H.debug(`No callbacks on watchlist events for ${l}`)}),this.pusher=a,this.bindWatchlistInternalEvent()}handleEvent(a){a.data.events.forEach(l=>{this.emit(l.name,l)})}bindWatchlistInternalEvent(){this.pusher.connection.bind("message",a=>{var l=a.event;l==="pusher_internal:watchlist_events"&&this.handleEvent(a)})}}function ka(){let h,a;return{promise:new Promise((p,m)=>{h=p,a=m}),resolve:h,reject:a}}var Sa=ka;class xa extends be{constructor(a){super(function(l,p){H.debug("No callbacks on user for "+l)}),this.signin_requested=!1,this.user_data=null,this.serverToUserChannel=null,this.signinDonePromise=null,this._signinDoneResolve=null,this._onAuthorize=(l,p)=>{if(l){H.warn(`Error during signin: ${l}`),this._cleanup();return}this.pusher.send_event("pusher:signin",{auth:p.auth,user_data:p.user_data})},this.pusher=a,this.pusher.connection.bind("state_change",({previous:l,current:p})=>{l!=="connected"&&p==="connected"&&this._signin(),l==="connected"&&p!=="connected"&&(this._cleanup(),this._newSigninPromiseIfNeeded())}),this.watchlist=new va(a),this.pusher.connection.bind("message",l=>{var p=l.event;p==="pusher:signin_success"&&this._onSigninSuccess(l.data),this.serverToUserChannel&&this.serverToUserChannel.name===l.channel&&this.serverToUserChannel.handleEvent(l)})}signin(){this.signin_requested||(this.signin_requested=!0,this._signin())}_signin(){this.signin_requested&&(this._newSigninPromiseIfNeeded(),this.pusher.connection.state==="connected"&&this.pusher.config.userAuthenticator({socketId:this.pusher.connection.socket_id},this._onAuthorize))}_onSigninSuccess(a){try{this.user_data=JSON.parse(a.user_data)}catch{H.error(`Failed parsing user data after signin: ${a.user_data}`),this._cleanup();return}if(typeof this.user_data.id!="string"||this.user_data.id===""){H.error(`user_data doesn't contain an id. user_data: ${this.user_data}`),this._cleanup();return}this._signinDoneResolve(),this._subscribeChannels()}_subscribeChannels(){const a=l=>{l.subscriptionPending&&l.subscriptionCancelled?l.reinstateSubscription():!l.subscriptionPending&&this.pusher.connection.state==="connected"&&l.subscribe()};this.serverToUserChannel=new Yt(`#server-to-user-${this.user_data.id}`,this.pusher),this.serverToUserChannel.bind_global((l,p)=>{l.indexOf("pusher_internal:")===0||l.indexOf("pusher:")===0||this.emit(l,p)}),a(this.serverToUserChannel)}_cleanup(){this.user_data=null,this.serverToUserChannel&&(this.serverToUserChannel.unbind_all(),this.serverToUserChannel.disconnect(),this.serverToUserChannel=null),this.signin_requested&&this._signinDoneResolve()}_newSigninPromiseIfNeeded(){if(!this.signin_requested||this.signinDonePromise&&!this.signinDonePromise.done)return;const{promise:a,resolve:l,reject:p}=Sa();a.done=!1;const m=()=>{a.done=!0};a.then(m).catch(m),this.signinDonePromise=a,this._signinDoneResolve=l}}class Q{static ready(){Q.isReady=!0;for(var a=0,l=Q.instances.length;a<l;a++)Q.instances[a].connect()}static getClientFeatures(){return Yn(tr({ws:I.Transports.ws},function(a){return a.isSupported({})}))}constructor(a,l){Ca(a),oa(l),this.key=a,this.options=l,this.config=mr(this.options,this),this.channels=we.createChannels(),this.global_emitter=new be,this.sessionID=I.randomInt(1e9),this.timeline=new ta(this.key,this.sessionID,{cluster:this.config.cluster,features:Q.getClientFeatures(),params:this.config.timelineParams||{},limit:50,level:yt.INFO,version:u.VERSION}),this.config.enableStats&&(this.timelineSender=we.createTimelineSender(this.timeline,{host:this.config.statsHost,path:"/timeline/v2/"+I.TimelineTransport.name}));var p=m=>I.getDefaultStrategy(this.config,m,ia);this.connection=we.createConnectionManager(this.key,{getStrategy:p,timeline:this.timeline,activityTimeout:this.config.activityTimeout,pongTimeout:this.config.pongTimeout,unavailableTimeout:this.config.unavailableTimeout,useTLS:!!this.config.useTLS}),this.connection.bind("connected",()=>{this.subscribeAll(),this.timelineSender&&this.timelineSender.send(this.connection.isUsingTLS())}),this.connection.bind("message",m=>{var C=m.event,T=C.indexOf("pusher_internal:")===0;if(m.channel){var A=this.channel(m.channel);A&&A.handleEvent(m)}T||this.global_emitter.emit(m.event,m.data)}),this.connection.bind("connecting",()=>{this.channels.disconnect()}),this.connection.bind("disconnected",()=>{this.channels.disconnect()}),this.connection.bind("error",m=>{H.warn(m)}),Q.instances.push(this),this.timeline.info({instances:Q.instances.length}),this.user=new xa(this),Q.isReady&&this.connect()}switchCluster(a){const{appKey:l,cluster:p}=a;this.key=l,this.options=Object.assign(Object.assign({},this.options),{cluster:p}),this.config=mr(this.options,this),this.connection.switchCluster(this.key)}channel(a){return this.channels.find(a)}allChannels(){return this.channels.all()}connect(){if(this.connection.connect(),this.timelineSender&&!this.timelineSenderTimer){var a=this.connection.isUsingTLS(),l=this.timelineSender;this.timelineSenderTimer=new Ps(6e4,function(){l.send(a)})}}disconnect(){this.connection.disconnect(),this.timelineSenderTimer&&(this.timelineSenderTimer.ensureAborted(),this.timelineSenderTimer=null)}bind(a,l,p){return this.global_emitter.bind(a,l,p),this}unbind(a,l,p){return this.global_emitter.unbind(a,l,p),this}bind_global(a){return this.global_emitter.bind_global(a),this}unbind_global(a){return this.global_emitter.unbind_global(a),this}unbind_all(a){return this.global_emitter.unbind_all(),this}subscribeAll(){var a;for(a in this.channels.channels)this.channels.channels.hasOwnProperty(a)&&this.subscribe(a)}subscribe(a){var l=this.channels.add(a,this);return l.subscriptionPending&&l.subscriptionCancelled?l.reinstateSubscription():!l.subscriptionPending&&this.connection.state==="connected"&&l.subscribe(),l}unsubscribe(a){var l=this.channels.find(a);l&&l.subscriptionPending?l.cancelSubscription():(l=this.channels.remove(a),l&&l.subscribed&&l.unsubscribe())}send_event(a,l,p){return this.connection.send_event(a,l,p)}shouldUseTLS(){return this.config.useTLS}signin(){this.user.signin()}}Q.instances=[],Q.isReady=!1,Q.logToConsole=!1,Q.Runtime=I,Q.ScriptReceivers=I.ScriptReceivers,Q.DependenciesReceivers=I.DependenciesReceivers,Q.auth_callbacks=I.auth_callbacks;var on=n.default=Q;function Ca(h){if(h==null)throw"You must pass your app key when you instantiate Pusher."}I.setup(Q)}])})})(Mi);var wl=Mi.exports;const vl=bl(wl);window.Pusher=vl;typeof window.Echo>"u"&&(window.Echo=new yl({broadcaster:"reverb",key:"r3detgsjsjq0bb2sqy2a",wsHost:window.location.hostname,wsPort:8080,forceTLS:!1,enabledTransports:["ws","wss"],enableLogging:!0,wsPath:"/reverb"}),window.Echo.connector.socket.on("connecting",()=>{console.log("Attempting to connect to Reverb...")}),window.Echo.connector.socket.on("connected",()=>{console.log("Successfully connected to Reverb")}),window.Echo.connector.socket.on("error",r=>{console.error("Reverb connection error:",r)}));window.Echo.channel("test-channel").listen(".test-event",r=>{console.log("Received message:",r)});window.axios=X;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";function Y(r){this.content=r}Y.prototype={constructor:Y,find:function(r){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===r)return e;return-1},get:function(r){var e=this.find(r);return e==-1?void 0:this.content[e+1]},update:function(r,e,t){var n=t&&t!=r?this.remove(t):this,i=n.find(r),s=n.content.slice();return i==-1?s.push(t||r,e):(s[i+1]=e,t&&(s[i]=t)),new Y(s)},remove:function(r){var e=this.find(r);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new Y(t)},addToStart:function(r,e){return new Y([r,e].concat(this.remove(r).content))},addToEnd:function(r,e){var t=this.remove(r).content.slice();return t.push(r,e),new Y(t)},addBefore:function(r,e,t){var n=this.remove(e),i=n.content.slice(),s=n.find(r);return i.splice(s==-1?i.length:s,0,e,t),new Y(i)},forEach:function(r){for(var e=0;e<this.content.length;e+=2)r(this.content[e],this.content[e+1])},prepend:function(r){return r=Y.from(r),r.size?new Y(r.content.concat(this.subtract(r).content)):this},append:function(r){return r=Y.from(r),r.size?new Y(this.subtract(r).content.concat(r.content)):this},subtract:function(r){var e=this;r=Y.from(r);for(var t=0;t<r.content.length;t+=2)e=e.remove(r.content[t]);return e},toObject:function(){var r={};return this.forEach(function(e,t){r[e]=t}),r},get size(){return this.content.length>>1}};Y.from=function(r){if(r instanceof Y)return r;var e=[];if(r)for(var t in r)e.push(t,r[t]);return new Y(e)};function Li(r,e,t){for(let n=0;;n++){if(n==r.childCount||n==e.childCount)return r.childCount==e.childCount?null:t;let i=r.child(n),s=e.child(n);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=Li(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function Bi(r,e,t,n){for(let i=r.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:n};let o=r.child(--i),c=e.child(--s),u=o.nodeSize;if(o==c){t-=u,n-=u;continue}if(!o.sameMarkup(c))return{a:t,b:n};if(o.isText&&o.text!=c.text){let f=0,d=Math.min(o.text.length,c.text.length);for(;f<d&&o.text[o.text.length-f-1]==c.text[c.text.length-f-1];)f++,t--,n--;return{a:t,b:n}}if(o.content.size||c.content.size){let f=Bi(o.content,c.content,t-1,n-1);if(f)return f}t-=u,n-=u}}class E{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n,i=0,s){for(let o=0,c=0;c<t;o++){let u=this.content[o],f=c+u.nodeSize;if(f>e&&n(u,i+c,s||null,o)!==!1&&u.content.size){let d=c+1;u.nodesBetween(Math.max(0,e-d),Math.min(u.content.size,t-d),n,i+d)}c=f}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,i){let s="",o=!0;return this.nodesBetween(e,t,(c,u)=>{let f=c.isText?c.text.slice(Math.max(e,u)-u,t-u):c.isLeaf?i?typeof i=="function"?i(c):i:c.type.spec.leafText?c.type.spec.leafText(c):"":"";c.isBlock&&(c.isLeaf&&f||c.isTextblock)&&n&&(o?o=!1:s+=n),s+=f},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(n)&&(i[i.length-1]=t.withText(t.text+n.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new E(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let n=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let c=this.content[s],u=o+c.nodeSize;u>e&&((o<e||u>t)&&(c.isText?c=c.cut(Math.max(0,e-o),Math.min(c.text.length,t-o)):c=c.cut(Math.max(0,e-o-1),Math.min(c.content.size,t-o-1))),n.push(c),i+=c.nodeSize),o=u}return new E(n,i)}cutByIndex(e,t){return e==t?E.empty:e==0&&t==this.content.length?this:new E(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-n.nodeSize;return i[e]=t,new E(i,s)}addToStart(e){return new E([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new E(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let i=this.content[t];e(i,n,t),n+=i.nodeSize}}findDiffStart(e,t=0){return Li(this,e,t)}findDiffEnd(e,t=this.size,n=e.size){return Bi(this,e,t,n)}findIndex(e,t=-1){if(e==0)return wt(0,e);if(e==this.size)return wt(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,i=0;;n++){let s=this.child(n),o=i+s.nodeSize;if(o>=e)return o==e||t>0?wt(n+1,o):wt(n,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return E.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new E(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return E.empty;let t,n=0;for(let i=0;i<e.length;i++){let s=e[i];n+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new E(t||e,n)}static from(e){if(!e)return E.empty;if(e instanceof E)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new E([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}E.empty=new E([],0);const dn={index:0,offset:0};function wt(r,e){return dn.index=r,dn.offset=e,dn}function It(r,e){if(r===e)return!0;if(!(r&&typeof r=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(r);if(Array.isArray(e)!=t)return!1;if(t){if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(!It(r[n],e[n]))return!1}else{for(let n in r)if(!(n in e)||!It(r[n],e[n]))return!1;for(let n in e)if(!(n in r))return!1}return!0}class D{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!n&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),n=!0),t&&t.push(s)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&It(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=n.create(t.attrs);return n.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return D.none;if(e instanceof D)return[e];let t=e.slice();return t.sort((n,i)=>n.type.rank-i.type.rank),t}}D.none=[];class Nt extends Error{}class R{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=zi(this.content,e+this.openStart,t);return n&&new R(n,this.openStart,this.openEnd)}removeBetween(e,t){return new R(Fi(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return R.empty;let n=t.openStart||0,i=t.openEnd||0;if(typeof n!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new R(E.fromJSON(e,t.content),n,i)}static maxOpen(e,t=!0){let n=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)n++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new R(e,n,i)}}R.empty=new R(E.empty,0,0);function Fi(r,e,t){let{index:n,offset:i}=r.findIndex(e),s=r.maybeChild(n),{index:o,offset:c}=r.findIndex(t);if(i==e||s.isText){if(c!=t&&!r.child(o).isText)throw new RangeError("Removing non-flat range");return r.cut(0,e).append(r.cut(t))}if(n!=o)throw new RangeError("Removing non-flat range");return r.replaceChild(n,s.copy(Fi(s.content,e-i-1,t-i-1)))}function zi(r,e,t,n){let{index:i,offset:s}=r.findIndex(e),o=r.maybeChild(i);if(s==e||o.isText)return r.cut(0,e).append(t).append(r.cut(e));let c=zi(o.content,e-s-1,t);return c&&r.replaceChild(i,o.copy(c))}function kl(r,e,t){if(t.openStart>r.depth)throw new Nt("Inserted content deeper than insertion position");if(r.depth-t.openStart!=e.depth-t.openEnd)throw new Nt("Inconsistent open depths");return ji(r,e,t,0)}function ji(r,e,t,n){let i=r.index(n),s=r.node(n);if(i==e.index(n)&&n<r.depth-t.openStart){let o=ji(r,e,t,n+1);return s.copy(s.content.replaceChild(i,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&r.depth==n&&e.depth==n){let o=r.parent,c=o.content;return Ne(o,c.cut(0,r.parentOffset).append(t.content).append(c.cut(e.parentOffset)))}else{let{start:o,end:c}=Sl(t,r);return Ne(s,Ui(r,o,c,e,n))}else return Ne(s,Mt(r,e,n))}function Di(r,e){if(!e.type.compatibleContent(r.type))throw new Nt("Cannot join "+e.type.name+" onto "+r.type.name)}function An(r,e,t){let n=r.node(t);return Di(n,e.node(t)),n}function Ie(r,e){let t=e.length-1;t>=0&&r.isText&&r.sameMarkup(e[t])?e[t]=r.withText(e[t].text+r.text):e.push(r)}function nt(r,e,t,n){let i=(e||r).node(t),s=0,o=e?e.index(t):i.childCount;r&&(s=r.index(t),r.depth>t?s++:r.textOffset&&(Ie(r.nodeAfter,n),s++));for(let c=s;c<o;c++)Ie(i.child(c),n);e&&e.depth==t&&e.textOffset&&Ie(e.nodeBefore,n)}function Ne(r,e){return r.type.checkContent(e),r.copy(e)}function Ui(r,e,t,n,i){let s=r.depth>i&&An(r,e,i+1),o=n.depth>i&&An(t,n,i+1),c=[];return nt(null,r,i,c),s&&o&&e.index(i)==t.index(i)?(Di(s,o),Ie(Ne(s,Ui(r,e,t,n,i+1)),c)):(s&&Ie(Ne(s,Mt(r,e,i+1)),c),nt(e,t,i,c),o&&Ie(Ne(o,Mt(t,n,i+1)),c)),nt(n,null,i,c),new E(c)}function Mt(r,e,t){let n=[];if(nt(null,r,t,n),r.depth>t){let i=An(r,e,t+1);Ie(Ne(i,Mt(r,e,t+1)),n)}return nt(e,null,t,n),new E(n)}function Sl(r,e){let t=e.depth-r.openStart,i=e.node(t).copy(r.content);for(let s=t-1;s>=0;s--)i=e.node(s).copy(E.from(i));return{start:i.resolveNoCache(r.openStart+t),end:i.resolveNoCache(i.content.size-r.openEnd-t)}}class at{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],i=e.child(t);return n?e.child(t).cut(n):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let s=0;s<e;s++)i+=n.child(s).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return D.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),i=e.maybeChild(t);if(!n){let c=n;n=i,i=c}let s=n.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<n.length;s++)n[s].type.spec.inclusive===!1&&(!i||!n[s].isInSet(i.marks))&&(n=n[s--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new Lt(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],i=0,s=t;for(let o=e;;){let{index:c,offset:u}=o.content.findIndex(s),f=s-u;if(n.push(o,c,i+u),!f||(o=o.child(c),o.isText))break;s=f-1,i+=u+1}return new at(t,n,s)}static resolveCached(e,t){let n=Dr.get(e);if(n)for(let s=0;s<n.elts.length;s++){let o=n.elts[s];if(o.pos==t)return o}else Dr.set(e,n=new xl);let i=n.elts[n.i]=at.resolve(e,t);return n.i=(n.i+1)%Cl,i}}class xl{constructor(){this.elts=[],this.i=0}}const Cl=12,Dr=new WeakMap;class Lt{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Tl=Object.create(null);let Me=class Rn{constructor(e,t,n,i=D.none){this.type=e,this.attrs=t,this.marks=i,this.content=n||E.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n,i=0){this.content.nodesBetween(e,t,n,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,i){return this.content.textBetween(e,t,n,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&It(this.attrs,t||e.defaultAttrs||Tl)&&D.sameSet(this.marks,n||D.none)}copy(e=null){return e==this.content?this:new Rn(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Rn(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,n=!1){if(e==t)return R.empty;let i=this.resolve(e),s=this.resolve(t),o=n?0:i.sharedDepth(t),c=i.start(o),f=i.node(o).content.cut(i.pos-c,s.pos-c);return new R(f,i.depth-o,s.depth-o)}replace(e,t,n){return kl(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let i=this.content.child(t-1);return{node:i,index:t-1,offset:n-i.nodeSize}}resolve(e){return at.resolveCached(this,e)}resolveNoCache(e){return at.resolve(this,e)}rangeHasMark(e,t,n){let i=!1;return t>e&&this.nodesBetween(e,t,s=>(n.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),qi(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,n=E.empty,i=0,s=n.childCount){let o=this.contentMatchAt(e).matchFragment(n,i,s),c=o&&o.matchFragment(this.content,t);if(!c||!c.validEnd)return!1;for(let u=i;u<s;u++)if(!this.type.allowsMarks(n.child(u).marks))return!1;return!0}canReplaceWith(e,t,n,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(n),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=D.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!D.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let i=E.fromJSON(e,t.content),s=e.nodeType(t.type).create(t.attrs,i,n);return s.type.checkAttrs(s.attrs),s}};Me.prototype.text=void 0;class Bt extends Me{constructor(e,t,n,i){if(super(e,t,null,i),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):qi(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Bt(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Bt(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function qi(r,e){for(let t=r.length-1;t>=0;t--)e=r[t].type.name+"("+e+")";return e}class Be{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new El(e,t);if(n.next==null)return Be.empty;let i=Ji(n);n.next&&n.err("Unexpected trailing text");let s=Nl(Il(i));return Ml(s,n),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,n=e.childCount){let i=this;for(let s=t;i&&s<n;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e,t=!1,n=0){let i=[this];function s(o,c){let u=o.matchFragment(e,n);if(u&&(!t||u.validEnd))return E.from(c.map(f=>f.createAndFill()));for(let f=0;f<o.next.length;f++){let{type:d,next:g}=o.next[f];if(!(d.isText||d.hasRequiredAttrs())&&i.indexOf(g)==-1){i.push(g);let v=s(g,c.concat(d));if(v)return v}}return null}return s(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let i=n.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let c=i;c.type;c=c.via)o.push(c.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:c,next:u}=s.next[o];!c.isLeaf&&!c.hasRequiredAttrs()&&!(c.name in t)&&(!i.type||u.validEnd)&&(n.push({match:c.contentMatch,type:c,via:i}),t[c.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(n){e.push(n);for(let i=0;i<n.next.length;i++)e.indexOf(n.next[i].next)==-1&&t(n.next[i].next)}return t(this),e.map((n,i)=>{let s=i+(n.validEnd?"*":" ")+" ";for(let o=0;o<n.next.length;o++)s+=(o?", ":"")+n.next[o].type.name+"->"+e.indexOf(n.next[o].next);return s}).join(`
`)}}Be.empty=new Be(!0);class El{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Ji(r){let e=[];do e.push(Ol(r));while(r.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function Ol(r){let e=[];do e.push(_l(r));while(r.next&&r.next!=")"&&r.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function _l(r){let e=Pl(r);for(;;)if(r.eat("+"))e={type:"plus",expr:e};else if(r.eat("*"))e={type:"star",expr:e};else if(r.eat("?"))e={type:"opt",expr:e};else if(r.eat("{"))e=Al(r,e);else break;return e}function Ur(r){/\D/.test(r.next)&&r.err("Expected number, got '"+r.next+"'");let e=Number(r.next);return r.pos++,e}function Al(r,e){let t=Ur(r),n=t;return r.eat(",")&&(r.next!="}"?n=Ur(r):n=-1),r.eat("}")||r.err("Unclosed braced range"),{type:"range",min:t,max:n,expr:e}}function Rl(r,e){let t=r.nodeTypes,n=t[e];if(n)return[n];let i=[];for(let s in t){let o=t[s];o.isInGroup(e)&&i.push(o)}return i.length==0&&r.err("No node type or group '"+e+"' found"),i}function Pl(r){if(r.eat("(")){let e=Ji(r);return r.eat(")")||r.err("Missing closing paren"),e}else if(/\W/.test(r.next))r.err("Unexpected token '"+r.next+"'");else{let e=Rl(r,r.next).map(t=>(r.inline==null?r.inline=t.isInline:r.inline!=t.isInline&&r.err("Mixing inline and block content"),{type:"name",value:t}));return r.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Il(r){let e=[[]];return i(s(r,0),t()),e;function t(){return e.push([])-1}function n(o,c,u){let f={term:u,to:c};return e[o].push(f),f}function i(o,c){o.forEach(u=>u.to=c)}function s(o,c){if(o.type=="choice")return o.exprs.reduce((u,f)=>u.concat(s(f,c)),[]);if(o.type=="seq")for(let u=0;;u++){let f=s(o.exprs[u],c);if(u==o.exprs.length-1)return f;i(f,c=t())}else if(o.type=="star"){let u=t();return n(c,u),i(s(o.expr,u),u),[n(u)]}else if(o.type=="plus"){let u=t();return i(s(o.expr,c),u),i(s(o.expr,u),u),[n(u)]}else{if(o.type=="opt")return[n(c)].concat(s(o.expr,c));if(o.type=="range"){let u=c;for(let f=0;f<o.min;f++){let d=t();i(s(o.expr,u),d),u=d}if(o.max==-1)i(s(o.expr,u),u);else for(let f=o.min;f<o.max;f++){let d=t();n(u,d),i(s(o.expr,u),d),u=d}return[n(u)]}else{if(o.type=="name")return[n(c,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Hi(r,e){return e-r}function qr(r,e){let t=[];return n(e),t.sort(Hi);function n(i){let s=r[i];if(s.length==1&&!s[0].term)return n(s[0].to);t.push(i);for(let o=0;o<s.length;o++){let{term:c,to:u}=s[o];!c&&t.indexOf(u)==-1&&n(u)}}}function Nl(r){let e=Object.create(null);return t(qr(r,0));function t(n){let i=[];n.forEach(o=>{r[o].forEach(({term:c,to:u})=>{if(!c)return;let f;for(let d=0;d<i.length;d++)i[d][0]==c&&(f=i[d][1]);qr(r,u).forEach(d=>{f||i.push([c,f=[]]),f.indexOf(d)==-1&&f.push(d)})})});let s=e[n.join(",")]=new Be(n.indexOf(r.length-1)>-1);for(let o=0;o<i.length;o++){let c=i[o][1].sort(Hi);s.next.push({type:i[o][0],next:e[c.join(",")]||t(c)})}return s}}function Ml(r,e){for(let t=0,n=[r];t<n.length;t++){let i=n[t],s=!i.validEnd,o=[];for(let c=0;c<i.next.length;c++){let{type:u,next:f}=i.next[c];o.push(u.name),s&&!(u.isText||u.hasRequiredAttrs())&&(s=!1),n.indexOf(f)==-1&&n.push(f)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function $i(r){let e=Object.create(null);for(let t in r){let n=r[t];if(!n.hasDefault)return null;e[t]=n.default}return e}function Wi(r,e){let t=Object.create(null);for(let n in r){let i=e&&e[n];if(i===void 0){let s=r[n];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+n)}t[n]=i}return t}function Vi(r,e,t,n){for(let i in e)if(!(i in r))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in r){let s=r[i];s.validate&&s.validate(e[i])}}function Xi(r,e){let t=Object.create(null);if(e)for(let n in e)t[n]=new Bl(r,n,e[n]);return t}class Ft{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Xi(e,n.attrs),this.defaultAttrs=$i(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Be.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Wi(this.attrs,e)}create(e=null,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Me(this,this.computeAttrs(e),E.from(t),D.setFrom(n))}createChecked(e=null,t,n){return t=E.from(t),this.checkContent(t),new Me(this,this.computeAttrs(e),t,D.setFrom(n))}createAndFill(e=null,t,n){if(e=this.computeAttrs(e),t=E.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let i=this.contentMatch.matchFragment(t),s=i&&i.fillBefore(E.empty,!0);return s?new Me(this,e,t.append(s),D.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Vi(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:D.none:e}static compile(e,t){let n=Object.create(null);e.forEach((s,o)=>n[s]=new Ft(s,t,o));let i=t.spec.topNode||"doc";if(!n[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let s in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}}function Ll(r,e,t){let n=t.split("|");return i=>{let s=i===null?"null":typeof i;if(n.indexOf(s)<0)throw new RangeError(`Expected value of type ${n} for attribute ${e} on type ${r}, got ${s}`)}}class Bl{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate=typeof n.validate=="string"?Ll(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Un{constructor(e,t,n,i){this.name=e,this.rank=t,this.schema=n,this.spec=i,this.attrs=Xi(e,i.attrs),this.excluded=null;let s=$i(this.attrs);this.instance=s?new D(this,s):null}create(e=null){return!e&&this.instance?this.instance:new D(this,Wi(this.attrs,e))}static compile(e,t){let n=Object.create(null),i=0;return e.forEach((s,o)=>n[s]=new Un(s,i++,t,o)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Vi(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Fl{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=Y.from(e.nodes),t.marks=Y.from(e.marks||{}),this.nodes=Ft.compile(this.spec.nodes,this),this.marks=Un.compile(this.spec.marks,this);let n=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",c=s.spec.marks;if(s.contentMatch=n[o]||(n[o]=Be.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=c=="_"?null:c?Jr(this,c.split(" ")):c==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:Jr(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,n,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Ft){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,n,i)}text(e,t){let n=this.nodes.text;return new Bt(n,n.defaultAttrs,e,D.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Me.fromJSON(this,e)}markFromJSON(e){return D.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Jr(r,e){let t=[];for(let n=0;n<e.length;n++){let i=e[n],s=r.marks[i],o=s;if(s)t.push(s);else for(let c in r.marks){let u=r.marks[c];(i=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(i)>-1)&&t.push(o=u)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[n]+"'")}return t}function zl(r){return r.tag!=null}function jl(r){return r.style!=null}class qe{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(i=>{if(zl(i))this.tags.push(i);else if(jl(i)){let s=/[^=]*/.exec(i.style)[0];n.indexOf(s)<0&&n.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,t={}){let n=new $r(this,t,!1);return n.addAll(e,D.none,t.from,t.to),n.finish()}parseSlice(e,t={}){let n=new $r(this,t,!0);return n.addAll(e,D.none,t.from,t.to),R.maxOpen(n.finish())}matchTag(e,t,n){for(let i=n?this.tags.indexOf(n)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(ql(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,n,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],c=o.style;if(!(c.indexOf(e)!=0||o.context&&!n.matchesContext(o.context)||c.length>e.length&&(c.charCodeAt(e.length)!=61||c.slice(e.length+1)!=t))){if(o.getAttrs){let u=o.getAttrs(t);if(u===!1)continue;o.attrs=u||void 0}return o}}}static schemaRules(e){let t=[];function n(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let c=t[o];if((c.priority==null?50:c.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{n(o=Wr(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{n(o=Wr(o)),o.node||o.ignore||o.mark||(o.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new qe(e,qe.schemaRules(e)))}}const Ki={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Dl={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Gi={ol:!0,ul:!0},ct=1,Pn=2,rt=4;function Hr(r,e,t){return e!=null?(e?ct:0)|(e==="full"?Pn:0):r&&r.whitespace=="pre"?ct|Pn:t&~rt}class vt{constructor(e,t,n,i,s,o){this.type=e,this.attrs=t,this.marks=n,this.solid=i,this.options=o,this.content=[],this.activeMarks=D.none,this.match=s||(o&rt?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(E.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let n=this.type.contentMatch,i;return(i=n.findWrapping(e.type))?(this.match=n,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ct)){let n=this.content[this.content.length-1],i;if(n&&n.isText&&(i=/[ \t\r\n\u000c]+$/.exec(n.text))){let s=n;n.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=E.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(E.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Ki.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class $r{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let i=t.topNode,s,o=Hr(null,t.preserveWhitespace,0)|(n?rt:0);i?s=new vt(i.type,i.attrs,D.none,!0,t.topMatch||i.type.contentMatch,o):n?s=new vt(null,null,D.none,!0,null,o):s=new vt(e.schema.topNodeType,null,D.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,i=this.top,s=i.options&Pn?"full":this.localPreserveWS||(i.options&ct)>0;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(s)s!=="full"?n=n.replace(/\r?\n|\r/g," "):n=n.replace(/\r\n?/g,`
`);else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],c=e.previousSibling;(!o||c&&c.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let i=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),c;Gi.hasOwnProperty(o)&&this.parser.normalizeLists&&Ul(e);let u=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(c=this.parser.matchTag(e,this,n));e:if(u?u.ignore:Dl.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(e=u.skip);let f,d=this.needsBlock;if(Ki.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),f=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let g=u&&u.skip?t:this.readStyles(e,t);g&&this.addAll(e,g),f&&this.sync(s),this.needsBlock=d}else{let f=this.readStyles(e,t);f&&this.addElementByRule(e,u,f,u.consuming===!1?c:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=n.getPropertyValue(s);if(o)for(let c=void 0;;){let u=this.parser.matchStyle(s,o,this,c);if(!u)break;if(u.ignore)return null;if(u.clearMark?t=t.filter(f=>!u.clearMark(f)):t=t.concat(this.parser.schema.marks[u.mark].create(u.attrs)),u.consuming===!1)c=u;else break}}return t}addElementByRule(e,t,n,i){let s,o;if(t.node)if(o=this.parser.schema.nodes[t.node],o.isLeaf)this.insertNode(o.create(t.attrs),n)||this.leafFallback(e,n);else{let u=this.enter(o,t.attrs||null,n,t.preserveWhitespace);u&&(s=!0,n=u)}else{let u=this.parser.schema.marks[t.mark];n=n.concat(u.create(t.attrs))}let c=this.top;if(o&&o.isLeaf)this.findInside(e);else if(i)this.addElement(e,n,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(u=>this.insertNode(u,n));else{let u=e;typeof t.contentElement=="string"?u=e.querySelector(t.contentElement):typeof t.contentElement=="function"?u=t.contentElement(e):t.contentElement&&(u=t.contentElement),this.findAround(e,u,!0),this.addAll(u,n),this.findAround(e,u,!1)}s&&this.sync(c)&&this.open--}addAll(e,t,n,i){let s=n||0;for(let o=n?e.childNodes[n]:e.firstChild,c=i==null?null:e.childNodes[i];o!=c;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o,t);this.findAtPoint(e,s)}findPlace(e,t){let n,i;for(let s=this.open;s>=0;s--){let o=this.nodes[s],c=o.findWrapping(e);if(c&&(!n||n.length>c.length)&&(n=c,i=o,!c.length)||o.solid)break}if(!n)return null;this.sync(i);for(let s=0;s<n.length;s++)t=this.enterInner(n[s],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let n=this.findPlace(e,t);if(n){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let s=D.none;for(let o of n.concat(e.marks))(i.type?i.type.allowsMarkType(o.type):Vr(o.type,e.type))&&(s=o.addToSet(s));return i.content.push(e.mark(s)),!0}return!1}enter(e,t,n,i){let s=this.findPlace(e.create(t),n);return s&&(s=this.enterInner(e,t,n,!0,i)),s}enterInner(e,t,n,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let c=Hr(e,s,o.options);o.options&rt&&o.content.length==0&&(c|=rt);let u=D.none;return n=n.filter(f=>(o.type?o.type.allowsMarkType(f.type):Vr(f.type,e))?(u=f.addToSet(u),!1):!0),this.nodes.push(new vt(e,t,u,i,null,c)),this.open++,n}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=ct)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let i=n.length-1;i>=0;i--)e+=n[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(n?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,i=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),s=-(n?n.depth+1:0)+(i?0:1),o=(c,u)=>{for(;c>=0;c--){let f=t[c];if(f==""){if(c==t.length-1||c==0)continue;for(;u>=s;u--)if(o(c-1,u))return!0;return!1}else{let d=u>0||u==0&&i?this.nodes[u].type:n&&u>=s?n.node(u-s).type:null;if(!d||d.name!=f&&!d.isInGroup(f))return!1;u--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let n=this.parser.schema.nodes[t];if(n.isTextblock&&n.defaultAttrs)return n}}}function Ul(r){for(let e=r.firstChild,t=null;e;e=e.nextSibling){let n=e.nodeType==1?e.nodeName.toLowerCase():null;n&&Gi.hasOwnProperty(n)&&t?(t.appendChild(e),e=t):n=="li"?t=e:n&&(t=null)}}function ql(r,e){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,e)}function Wr(r){let e={};for(let t in r)e[t]=r[t];return e}function Vr(r,e){let t=e.schema.nodes;for(let n in t){let i=t[n];if(!i.allowsMarkType(r))continue;let s=[],o=c=>{s.push(c);for(let u=0;u<c.edgeCount;u++){let{type:f,next:d}=c.edge(u);if(f==e||s.indexOf(d)<0&&o(d))return!0}};if(o(i.contentMatch))return!0}}const Qi=65535,Yi=Math.pow(2,16);function Jl(r,e){return r+e*Yi}function Xr(r){return r&Qi}function Hl(r){return(r-(r&Qi))/Yi}const Zi=1,es=2,Et=4,ts=8;class Kr{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(this.delInfo&ts)>0}get deletedBefore(){return(this.delInfo&(Zi|Et))>0}get deletedAfter(){return(this.delInfo&(es|Et))>0}get deletedAcross(){return(this.delInfo&Et)>0}}class ce{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&ce.empty)return ce.empty}recover(e){let t=0,n=Xr(e);if(!this.inverted)for(let i=0;i<n;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[n*3]+t+Hl(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,n){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let u=this.ranges[c]-(this.inverted?i:0);if(u>e)break;let f=this.ranges[c+s],d=this.ranges[c+o],g=u+f;if(e<=g){let v=f?e==u?-1:e==g?1:t:t,w=u+i+(v<0?0:d);if(n)return w;let b=e==(t<0?u:g)?null:Jl(c/3,e-u),y=e==u?es:e==g?Zi:Et;return(t<0?e!=u:e!=g)&&(y|=ts),new Kr(w,y,b)}i+=d-f}return n?e+i:new Kr(e+i,0,null)}touches(e,t){let n=0,i=Xr(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let c=0;c<this.ranges.length;c+=3){let u=this.ranges[c]-(this.inverted?n:0);if(u>e)break;let f=this.ranges[c+s],d=u+f;if(e<=d&&c==i*3)return!0;n+=this.ranges[c+o]-f}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],c=o-(this.inverted?s:0),u=o+(this.inverted?0:s),f=this.ranges[i+t],d=this.ranges[i+n];e(c,c+f,u,u+d),s+=d-f}}invert(){return new ce(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?ce.empty:new ce(e<0?[0,-e,0]:[0,0,e])}}ce.empty=new ce([]);const pn=Object.create(null);class te{getMap(){return ce.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=pn[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in pn)throw new RangeError("Duplicate use of step JSON ID "+e);return pn[e]=t,t.prototype.jsonID=e,t}}class V{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new V(e,null)}static fail(e){return new V(null,e)}static fromReplace(e,t,n,i){try{return V.ok(e.replace(t,n,i))}catch(s){if(s instanceof Nt)return V.fail(s.message);throw s}}}function qn(r,e,t){let n=[];for(let i=0;i<r.childCount;i++){let s=r.child(i);s.content.size&&(s=s.copy(qn(s.content,e,s))),s.isInline&&(s=e(s,t,i)),n.push(s)}return E.fromArray(n)}class Oe extends te{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),i=n.node(n.sharedDepth(this.to)),s=new R(qn(t.content,(o,c)=>!o.isAtom||!c.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return V.fromReplace(e,this.from,this.to,s)}invert(){return new _e(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new Oe(t.pos,n.pos,this.mark)}merge(e){return e instanceof Oe&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Oe(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Oe(t.from,t.to,e.markFromJSON(t.mark))}}te.jsonID("addMark",Oe);class _e extends te{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new R(qn(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return V.fromReplace(e,this.from,this.to,n)}invert(){return new Oe(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new _e(t.pos,n.pos,this.mark)}merge(e){return e instanceof _e&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new _e(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new _e(t.from,t.to,e.markFromJSON(t.mark))}}te.jsonID("removeMark",_e);class Ae extends te{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return V.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return V.fromReplace(e,this.pos,this.pos+1,new R(E.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let n=this.mark.addToSet(t.marks);if(n.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(n))return new Ae(this.pos,t.marks[i]);return new Ae(this.pos,this.mark)}}return new lt(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ae(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ae(t.pos,e.markFromJSON(t.mark))}}te.jsonID("addNodeMark",Ae);class lt extends te{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return V.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return V.fromReplace(e,this.pos,this.pos+1,new R(E.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Ae(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new lt(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new lt(t.pos,e.markFromJSON(t.mark))}}te.jsonID("removeNodeMark",lt);class ae extends te{constructor(e,t,n,i=!1){super(),this.from=e,this.to=t,this.slice=n,this.structure=i}apply(e){return this.structure&&In(e,this.from,this.to)?V.fail("Structure replace would overwrite content"):V.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new ce([this.from,this.to-this.from,this.slice.size])}invert(e){return new ae(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new ae(t.pos,Math.max(t.pos,n.pos),this.slice)}merge(e){if(!(e instanceof ae)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?R.empty:new R(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ae(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?R.empty:new R(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ae(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ae(t.from,t.to,R.fromJSON(e,t.slice),!!t.structure)}}te.jsonID("replace",ae);class ie extends te{constructor(e,t,n,i,s,o,c=!1){super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=i,this.slice=s,this.insert=o,this.structure=c}apply(e){if(this.structure&&(In(e,this.from,this.gapFrom)||In(e,this.gapTo,this.to)))return V.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return V.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?V.fromReplace(e,this.from,this.to,n):V.fail("Content does not fit in gap")}getMap(){return new ce([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ie(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||i<t.pos||s>n.pos?null:new ie(t.pos,n.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ie(t.from,t.to,t.gapFrom,t.gapTo,R.fromJSON(e,t.slice),t.insert,!!t.structure)}}te.jsonID("replaceAround",ie);function In(r,e,t){let n=r.resolve(e),i=t-e,s=n.depth;for(;i>0&&s>0&&n.indexAfter(s)==n.node(s).childCount;)s--,i--;if(i>0){let o=n.node(s).maybeChild(n.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function $l(r,e,t){return(e==0||r.canReplace(e,r.childCount))&&(t==r.childCount||r.canReplace(0,t))}function Ve(r){let t=r.parent.content.cutByIndex(r.startIndex,r.endIndex);for(let n=r.depth;;--n){let i=r.$from.node(n),s=r.$from.index(n),o=r.$to.indexAfter(n);if(n<r.depth&&i.canReplace(s,o,t))return n;if(n==0||i.type.spec.isolating||!$l(i,s,o))break}return null}function ns(r,e,t=null,n=r){let i=Wl(r,e),s=i&&Vl(n,e);return s?i.map(Gr).concat({type:e,attrs:t}).concat(s.map(Gr)):null}function Gr(r){return{type:r,attrs:null}}function Wl(r,e){let{parent:t,startIndex:n,endIndex:i}=r,s=t.contentMatchAt(n).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(n,i,o)?s:null}function Vl(r,e){let{parent:t,startIndex:n,endIndex:i}=r,s=t.child(n),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let u=(o.length?o[o.length-1]:e).contentMatch;for(let f=n;u&&f<i;f++)u=u.matchType(t.child(f).type);return!u||!u.validEnd?null:o}function Je(r,e,t=1,n){let i=r.resolve(e),s=i.depth-t,o=n&&n[n.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let f=i.depth-1,d=t-2;f>s;f--,d--){let g=i.node(f),v=i.index(f);if(g.type.spec.isolating)return!1;let w=g.content.cutByIndex(v,g.childCount),b=n&&n[d+1];b&&(w=w.replaceChild(0,b.type.create(b.attrs)));let y=n&&n[d]||g;if(!g.canReplace(v+1,g.childCount)||!y.type.validContent(w))return!1}let c=i.indexAfter(s),u=n&&n[0];return i.node(s).canReplaceWith(c,c,u?u.type:i.node(s+1).type)}function Fe(r,e){let t=r.resolve(e),n=t.index();return rs(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(n,n+1)}function Xl(r,e){e.content.size||r.type.compatibleContent(e.type);let t=r.contentMatchAt(r.childCount),{linebreakReplacement:n}=r.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),o=s.type==n?r.type.schema.nodes.text:s.type;if(t=t.matchType(o),!t||!r.type.allowsMarks(s.marks))return!1}return t.validEnd}function rs(r,e){return!!(r&&e&&!r.isLeaf&&Xl(r,e))}function Vt(r,e,t=-1){let n=r.resolve(e);for(let i=n.depth;;i--){let s,o,c=n.index(i);if(i==n.depth?(s=n.nodeBefore,o=n.nodeAfter):t>0?(s=n.node(i+1),c++,o=n.node(i).maybeChild(c)):(s=n.node(i).maybeChild(c-1),o=n.node(i+1)),s&&!s.isTextblock&&rs(s,o)&&n.node(i).canReplace(c,c+1))return e;if(i==0)break;e=t<0?n.before(i):n.after(i)}}function Jn(r,e,t=e,n=R.empty){if(e==t&&!n.size)return null;let i=r.resolve(e),s=r.resolve(t);return Kl(i,s,n)?new ae(e,t,n):new Gl(i,s,n).fit()}function Kl(r,e,t){return!t.openStart&&!t.openEnd&&r.start()==e.start()&&r.parent.canReplace(r.index(),e.index(),t.content)}class Gl{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=E.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=E.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let f=this.findFittable();f?this.placeNodes(f):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,i=this.close(e<0?this.$to:n.doc.resolve(e));if(!i)return null;let s=this.placed,o=n.depth,c=i.depth;for(;o&&c&&s.childCount==1;)s=s.firstChild.content,o--,c--;let u=new R(s,o,c);return e>-1?new ie(n.pos,e,this.$to.pos,this.$to.end(),u,t):u.size||n.pos!=this.$to.pos?new ae(n.pos,i.pos,u):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,i=this.unplaced.openEnd;n<e;n++){let s=t.firstChild;if(t.childCount>1&&(i=0),s.type.spec.isolating&&i<=n){e=n;break}t=s.content}for(let t=1;t<=2;t++)for(let n=t==1?e:this.unplaced.openStart;n>=0;n--){let i,s=null;n?(s=mn(this.unplaced.content,n-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let c=this.depth;c>=0;c--){let{type:u,match:f}=this.frontier[c],d,g=null;if(t==1&&(o?f.matchType(o.type)||(g=f.fillBefore(E.from(o),!1)):s&&u.compatibleContent(s.type)))return{sliceDepth:n,frontierDepth:c,parent:s,inject:g};if(t==2&&o&&(d=f.findWrapping(o.type)))return{sliceDepth:n,frontierDepth:c,parent:s,wrap:d};if(s&&f.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=mn(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new R(e,t+1,Math.max(n,i.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,i=mn(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new R(Ze(e,t-1,1),t-1,s?t-1:n)}else this.unplaced=new R(Ze(e,t,1),t,n)}placeNodes({sliceDepth:e,frontierDepth:t,parent:n,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let y=0;y<s.length;y++)this.openFrontierNode(s[y]);let o=this.unplaced,c=n?n.content:o.content,u=o.openStart-e,f=0,d=[],{match:g,type:v}=this.frontier[t];if(i){for(let y=0;y<i.childCount;y++)d.push(i.child(y));g=g.matchFragment(i)}let w=c.size+e-(o.content.size-o.openEnd);for(;f<c.childCount;){let y=c.child(f),k=g.matchType(y.type);if(!k)break;f++,(f>1||u==0||y.content.size)&&(g=k,d.push(is(y.mark(v.allowedMarks(y.marks)),f==1?u:0,f==c.childCount?w:-1)))}let b=f==c.childCount;b||(w=-1),this.placed=et(this.placed,t,E.from(d)),this.frontier[t].match=g,b&&w<0&&n&&n.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let y=0,k=c;y<w;y++){let x=k.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),k=x.content}this.unplaced=b?e==0?R.empty:new R(Ze(o.content,e-1,1),e-1,w<0?o.openEnd:e-1):new R(Ze(o.content,e,f),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!gn(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:n}=this.$to,i=this.$to.after(n);for(;n>1&&i==this.$to.end(--n);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=gn(e,t,i,n,s);if(o){for(let c=t-1;c>=0;c--){let{match:u,type:f}=this.frontier[c],d=gn(e,c,f,u,!0);if(!d||d.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=et(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let i=e.node(n),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(n));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,n){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=et(this.placed,this.depth,E.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(E.empty,!0);t.childCount&&(this.placed=et(this.placed,this.frontier.length,t))}}function Ze(r,e,t){return e==0?r.cutByIndex(t,r.childCount):r.replaceChild(0,r.firstChild.copy(Ze(r.firstChild.content,e-1,t)))}function et(r,e,t){return e==0?r.append(t):r.replaceChild(r.childCount-1,r.lastChild.copy(et(r.lastChild.content,e-1,t)))}function mn(r,e){for(let t=0;t<e;t++)r=r.firstChild.content;return r}function is(r,e,t){if(e<=0)return r;let n=r.content;return e>1&&(n=n.replaceChild(0,is(n.firstChild,e-1,n.childCount==1?t-1:0))),e>0&&(n=r.type.contentMatch.fillBefore(n).append(n),t<=0&&(n=n.append(r.type.contentMatch.matchFragment(n).fillBefore(E.empty,!0)))),r.copy(n)}function gn(r,e,t,n,i){let s=r.node(e),o=i?r.indexAfter(e):r.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let c=n.fillBefore(s.content,!0,o);return c&&!Ql(t,s.content,o)?c:null}function Ql(r,e,t){for(let n=t;n<e.childCount;n++)if(!r.allowsMarks(e.child(n).marks))return!0;return!1}class it extends te{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return V.fail("No node at attribute step's position");let n=Object.create(null);for(let s in t.attrs)n[s]=t.attrs[s];n[this.attr]=this.value;let i=t.type.create(n,null,t.marks);return V.fromReplace(e,this.pos,this.pos+1,new R(E.from(i),0,t.isLeaf?0:1))}getMap(){return ce.empty}invert(e){return new it(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new it(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new it(t.pos,t.attr,t.value)}}te.jsonID("attr",it);class zt extends te{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return V.ok(n)}getMap(){return ce.empty}invert(e){return new zt(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new zt(t.attr,t.value)}}te.jsonID("docAttr",zt);let ut=class extends Error{};ut=function r(e){let t=Error.call(this,e);return t.__proto__=r.prototype,t};ut.prototype=Object.create(Error.prototype);ut.prototype.constructor=ut;ut.prototype.name="TransformError";const yn=Object.create(null);class j{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new Yl(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=R.empty){let n=t.content.lastChild,i=null;for(let c=0;c<t.openEnd;c++)i=n,n=n.lastChild;let s=e.steps.length,o=this.ranges;for(let c=0;c<o.length;c++){let{$from:u,$to:f}=o[c],d=e.mapping.slice(s);e.replaceRange(d.map(u.pos),d.map(f.pos),c?R.empty:t),c==0&&Zr(e,s,(n?n.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:c}=i[s],u=e.mapping.slice(n),f=u.map(o.pos),d=u.map(c.pos);s?e.deleteRange(f,d):(e.replaceRangeWith(f,d,t),Zr(e,n,t.isInline?-1:1))}}static findFrom(e,t,n=!1){let i=e.parent.inlineContent?new $(e):Ue(e.node(0),e.parent,e.pos,e.index(),t,n);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?Ue(e.node(0),e.node(s),e.before(s+1),e.index(s),t,n):Ue(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,n);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new de(e.node(0))}static atStart(e){return Ue(e,e,0,0,1)||new de(e)}static atEnd(e){return Ue(e,e,e.content.size,e.childCount,-1)||new de(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=yn[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in yn)throw new RangeError("Duplicate use of selection JSON ID "+e);return yn[e]=t,t.prototype.jsonID=e,t}getBookmark(){return $.between(this.$anchor,this.$head).getBookmark()}}j.prototype.visible=!0;class Yl{constructor(e,t){this.$from=e,this.$to=t}}let Qr=!1;function Yr(r){!Qr&&!r.parent.inlineContent&&(Qr=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}class $ extends j{constructor(e,t=e){Yr(e),Yr(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return j.near(n);let i=e.resolve(t.map(this.anchor));return new $(i.parent.inlineContent?i:n,n)}replace(e,t=R.empty){if(super.replace(e,t),t==R.empty){let n=this.$from.marksAcross(this.$to);n&&e.ensureMarks(n)}}eq(e){return e instanceof $&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Xt(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new $(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,n=t){let i=e.resolve(t);return new this(i,n==t?i:e.resolve(n))}static between(e,t,n){let i=e.pos-t.pos;if((!n||i)&&(n=i>=0?1:-1),!t.parent.inlineContent){let s=j.findFrom(t,n,!0)||j.findFrom(t,-n,!0);if(s)t=s.$head;else return j.near(t,n)}return e.parent.inlineContent||(i==0?e=t:(e=(j.findFrom(e,-n,!0)||j.findFrom(e,n,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new $(e,t)}}j.jsonID("text",$);class Xt{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Xt(e.map(this.anchor),e.map(this.head))}resolve(e){return $.between(e.resolve(this.anchor),e.resolve(this.head))}}class U extends j{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return n?j.near(s):new U(s)}content(){return new R(E.from(this.node),0,0)}eq(e){return e instanceof U&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Hn(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new U(e.resolve(t.anchor))}static create(e,t){return new U(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}U.prototype.visible=!1;j.jsonID("node",U);class Hn{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new Xt(n,n):new Hn(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&U.isSelectable(n)?new U(t):j.near(t)}}class de extends j{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=R.empty){if(t==R.empty){e.delete(0,e.doc.content.size);let n=j.atStart(e.doc);n.eq(e.selection)||e.setSelection(n)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new de(e)}map(e){return new de(e)}eq(e){return e instanceof de}getBookmark(){return Zl}}j.jsonID("all",de);const Zl={map(){return this},resolve(r){return new de(r)}};function Ue(r,e,t,n,i,s=!1){if(e.inlineContent)return $.create(r,t);for(let o=n-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let c=e.child(o);if(c.isAtom){if(!s&&U.isSelectable(c))return U.create(r,t-(i<0?c.nodeSize:0))}else{let u=Ue(r,c,t+i,i<0?c.childCount:0,i,s);if(u)return u}t+=c.nodeSize*i}return null}function Zr(r,e,t){let n=r.steps.length-1;if(n<e)return;let i=r.steps[n];if(!(i instanceof ae||i instanceof ie))return;let s=r.mapping.maps[n],o;s.forEach((c,u,f,d)=>{o==null&&(o=d)}),r.setSelection(j.near(r.doc.resolve(o),t))}function ei(r,e){return!e||!r?r:r.bind(e)}class kt{constructor(e,t,n){this.name=e,this.init=ei(t.init,n),this.apply=ei(t.apply,n)}}new kt("doc",{init(r){return r.doc||r.schema.topNodeType.createAndFill()},apply(r){return r.doc}}),new kt("selection",{init(r,e){return r.selection||j.atStart(e.doc)},apply(r){return r.selection}}),new kt("storedMarks",{init(r){return r.storedMarks||null},apply(r,e,t,n){return n.selection.$cursor?r.storedMarks:null}}),new kt("scrollToSelection",{init(){return 0},apply(r,e){return r.scrolledIntoView?e+1:e}});function ss(r,e,t){for(let n in r){let i=r[n];i instanceof Function?i=i.bind(e):n=="handleDOMEvents"&&(i=ss(i,e,{})),t[n]=i}return t}class ze{constructor(e){this.spec=e,this.props={},e.props&&ss(e.props,this,this.props),this.key=e.key?e.key.key:as("plugin")}getState(e){return e[this.key]}}const bn=Object.create(null);function as(r){return r in bn?r+"$"+ ++bn[r]:(bn[r]=0,r+"$")}class je{constructor(e="key"){this.key=as(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const eu=(r,e)=>r.selection.empty?!1:(e&&e(r.tr.deleteSelection().scrollIntoView()),!0);function cs(r,e){let{$cursor:t}=r.selection;return!t||(e?!e.endOfTextblock("backward",r):t.parentOffset>0)?null:t}const tu=(r,e,t)=>{let n=cs(r,t);if(!n)return!1;let i=$n(n);if(!i){let o=n.blockRange(),c=o&&Ve(o);return c==null?!1:(e&&e(r.tr.lift(o,c).scrollIntoView()),!0)}let s=i.nodeBefore;if(fs(r,i,e,-1))return!0;if(n.parent.content.size==0&&(He(s,"end")||U.isSelectable(s)))for(let o=n.depth;;o--){let c=Jn(r.doc,n.before(o),n.after(o),R.empty);if(c&&c.slice.size<c.to-c.from){if(e){let u=r.tr.step(c);u.setSelection(He(s,"end")?j.findFrom(u.doc.resolve(u.mapping.map(i.pos,-1)),-1):U.create(u.doc,i.pos-s.nodeSize)),e(u.scrollIntoView())}return!0}if(o==1||n.node(o-1).childCount>1)break}return s.isAtom&&i.depth==n.depth-1?(e&&e(r.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},nu=(r,e,t)=>{let n=cs(r,t);if(!n)return!1;let i=$n(n);return i?ls(r,i,e):!1},ru=(r,e,t)=>{let n=us(r,t);if(!n)return!1;let i=Wn(n);return i?ls(r,i,e):!1};function ls(r,e,t){let n=e.nodeBefore,i=n,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let d=i.lastChild;if(!d)return!1;i=d}let o=e.nodeAfter,c=o,u=e.pos+1;for(;!c.isTextblock;u++){if(c.type.spec.isolating)return!1;let d=c.firstChild;if(!d)return!1;c=d}let f=Jn(r.doc,s,u,R.empty);if(!f||f.from!=s||f instanceof ae&&f.slice.size>=u-s)return!1;if(t){let d=r.tr.step(f);d.setSelection($.create(d.doc,s)),t(d.scrollIntoView())}return!0}function He(r,e,t=!1){for(let n=r;n;n=e=="start"?n.firstChild:n.lastChild){if(n.isTextblock)return!0;if(t&&n.childCount!=1)return!1}return!1}const iu=(r,e,t)=>{let{$head:n,empty:i}=r.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("backward",r):n.parentOffset>0)return!1;s=$n(n)}let o=s&&s.nodeBefore;return!o||!U.isSelectable(o)?!1:(e&&e(r.tr.setSelection(U.create(r.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function $n(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){if(r.index(e)>0)return r.doc.resolve(r.before(e+1));if(r.node(e).type.spec.isolating)break}return null}function us(r,e){let{$cursor:t}=r.selection;return!t||(e?!e.endOfTextblock("forward",r):t.parentOffset<t.parent.content.size)?null:t}const su=(r,e,t)=>{let n=us(r,t);if(!n)return!1;let i=Wn(n);if(!i)return!1;let s=i.nodeAfter;if(fs(r,i,e,1))return!0;if(n.parent.content.size==0&&(He(s,"start")||U.isSelectable(s))){let o=Jn(r.doc,n.before(),n.after(),R.empty);if(o&&o.slice.size<o.to-o.from){if(e){let c=r.tr.step(o);c.setSelection(He(s,"start")?j.findFrom(c.doc.resolve(c.mapping.map(i.pos)),1):U.create(c.doc,c.mapping.map(i.pos))),e(c.scrollIntoView())}return!0}}return s.isAtom&&i.depth==n.depth-1?(e&&e(r.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},ou=(r,e,t)=>{let{$head:n,empty:i}=r.selection,s=n;if(!i)return!1;if(n.parent.isTextblock){if(t?!t.endOfTextblock("forward",r):n.parentOffset<n.parent.content.size)return!1;s=Wn(n)}let o=s&&s.nodeAfter;return!o||!U.isSelectable(o)?!1:(e&&e(r.tr.setSelection(U.create(r.doc,s.pos)).scrollIntoView()),!0)};function Wn(r){if(!r.parent.type.spec.isolating)for(let e=r.depth-1;e>=0;e--){let t=r.node(e);if(r.index(e)+1<t.childCount)return r.doc.resolve(r.after(e+1));if(t.type.spec.isolating)break}return null}const au=(r,e)=>{let t=r.selection,n=t instanceof U,i;if(n){if(t.node.isTextblock||!Fe(r.doc,t.from))return!1;i=t.from}else if(i=Vt(r.doc,t.from,-1),i==null)return!1;if(e){let s=r.tr.join(i);n&&s.setSelection(U.create(s.doc,i-r.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},cu=(r,e)=>{let t=r.selection,n;if(t instanceof U){if(t.node.isTextblock||!Fe(r.doc,t.to))return!1;n=t.to}else if(n=Vt(r.doc,t.to,1),n==null)return!1;return e&&e(r.tr.join(n).scrollIntoView()),!0},lu=(r,e)=>{let{$from:t,$to:n}=r.selection,i=t.blockRange(n),s=i&&Ve(i);return s==null?!1:(e&&e(r.tr.lift(i,s).scrollIntoView()),!0)},uu=(r,e)=>{let{$head:t,$anchor:n}=r.selection;return!t.parent.type.spec.code||!t.sameParent(n)?!1:(e&&e(r.tr.insertText(`
`).scrollIntoView()),!0)};function hs(r){for(let e=0;e<r.edgeCount;e++){let{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const hu=(r,e)=>{let{$head:t,$anchor:n}=r.selection;if(!t.parent.type.spec.code||!t.sameParent(n))return!1;let i=t.node(-1),s=t.indexAfter(-1),o=hs(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let c=t.after(),u=r.tr.replaceWith(c,c,o.createAndFill());u.setSelection(j.near(u.doc.resolve(c),1)),e(u.scrollIntoView())}return!0},fu=(r,e)=>{let t=r.selection,{$from:n,$to:i}=t;if(t instanceof de||n.parent.inlineContent||i.parent.inlineContent)return!1;let s=hs(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!n.parentOffset&&i.index()<i.parent.childCount?n:i).pos,c=r.tr.insert(o,s.createAndFill());c.setSelection($.create(c.doc,o+1)),e(c.scrollIntoView())}return!0},du=(r,e)=>{let{$cursor:t}=r.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let s=t.before();if(Je(r.doc,s))return e&&e(r.tr.split(s).scrollIntoView()),!0}let n=t.blockRange(),i=n&&Ve(n);return i==null?!1:(e&&e(r.tr.lift(n,i).scrollIntoView()),!0)},pu=(r,e)=>{let{$from:t,to:n}=r.selection,i,s=t.sharedDepth(n);return s==0?!1:(i=t.before(s),e&&e(r.tr.setSelection(U.create(r.doc,i))),!0)};function mu(r,e,t){let n=e.nodeBefore,i=e.nodeAfter,s=e.index();return!n||!i||!n.type.compatibleContent(i.type)?!1:!n.content.size&&e.parent.canReplace(s-1,s)?(t&&t(r.tr.delete(e.pos-n.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Fe(r.doc,e.pos))?!1:(t&&t(r.tr.join(e.pos).scrollIntoView()),!0)}function fs(r,e,t,n){let i=e.nodeBefore,s=e.nodeAfter,o,c,u=i.type.spec.isolating||s.type.spec.isolating;if(!u&&mu(r,e,t))return!0;let f=!u&&e.parent.canReplace(e.index(),e.index()+1);if(f&&(o=(c=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&c.matchType(o[0]||s.type).validEnd){if(t){let w=e.pos+s.nodeSize,b=E.empty;for(let x=o.length-1;x>=0;x--)b=E.from(o[x].create(null,b));b=E.from(i.copy(b));let y=r.tr.step(new ie(e.pos-1,w,e.pos,w,new R(b,1,0),o.length,!0)),k=y.doc.resolve(w+2*o.length);k.nodeAfter&&k.nodeAfter.type==i.type&&Fe(y.doc,k.pos)&&y.join(k.pos),t(y.scrollIntoView())}return!0}let d=s.type.spec.isolating||n>0&&u?null:j.findFrom(e,1),g=d&&d.$from.blockRange(d.$to),v=g&&Ve(g);if(v!=null&&v>=e.depth)return t&&t(r.tr.lift(g,v).scrollIntoView()),!0;if(f&&He(s,"start",!0)&&He(i,"end")){let w=i,b=[];for(;b.push(w),!w.isTextblock;)w=w.lastChild;let y=s,k=1;for(;!y.isTextblock;y=y.firstChild)k++;if(w.canReplace(w.childCount,w.childCount,y.content)){if(t){let x=E.empty;for(let _=b.length-1;_>=0;_--)x=E.from(b[_].copy(x));let O=r.tr.step(new ie(e.pos-b.length,e.pos+s.nodeSize,e.pos+k,e.pos+s.nodeSize-k,new R(x,b.length,0),0,!0));t(O.scrollIntoView())}return!0}}return!1}function ds(r){return function(e,t){let n=e.selection,i=r<0?n.$from:n.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(t&&t(e.tr.setSelection($.create(e.doc,r<0?i.start(s):i.end(s)))),!0):!1}}const gu=ds(-1),yu=ds(1);function bu(r,e=null){return function(t,n){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),c=o&&ns(o,r,e);return c?(n&&n(t.tr.wrap(o,c).scrollIntoView()),!0):!1}}function ti(r,e=null){return function(t,n){let i=!1;for(let s=0;s<t.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:c}}=t.selection.ranges[s];t.doc.nodesBetween(o,c,(u,f)=>{if(i)return!1;if(!(!u.isTextblock||u.hasMarkup(r,e)))if(u.type==r)i=!0;else{let d=t.doc.resolve(f),g=d.index();i=d.parent.canReplaceWith(g,g+1,r)}})}if(!i)return!1;if(n){let s=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:c},$to:{pos:u}}=t.selection.ranges[o];s.setBlockType(c,u,r,e)}n(s.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function wu(r,e=null){return function(t,n){let{$from:i,$to:s}=t.selection,o=i.blockRange(s);if(!o)return!1;let c=n?t.tr:null;return vu(c,o,r,e)?(n&&n(c.scrollIntoView()),!0):!1}}function vu(r,e,t,n=null){let i=!1,s=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let u=o.resolve(e.start-2);s=new Lt(u,u,e.depth),e.endIndex<e.parent.childCount&&(e=new Lt(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let c=ns(s,t,n,e);return c?(r&&ku(r,e,c,i,t),!0):!1}function ku(r,e,t,n,i){let s=E.empty;for(let d=t.length-1;d>=0;d--)s=E.from(t[d].type.create(t[d].attrs,s));r.step(new ie(e.start-(n?2:0),e.end,e.start,e.end,new R(s,0,0),t.length,!0));let o=0;for(let d=0;d<t.length;d++)t[d].type==i&&(o=d+1);let c=t.length-o,u=e.start+t.length-(n?2:0),f=e.parent;for(let d=e.startIndex,g=e.endIndex,v=!0;d<g;d++,v=!1)!v&&Je(r.doc,u,c)&&(r.split(u,c),u+=2*c),u+=f.child(d).nodeSize;return r}function Su(r){return function(e,t){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,o=>o.childCount>0&&o.firstChild.type==r);return s?t?n.node(s.depth-1).type==r?xu(e,t,r,s):Cu(e,t,s):!0:!1}}function xu(r,e,t,n){let i=r.tr,s=n.end,o=n.$to.end(n.depth);s<o&&(i.step(new ie(s-1,o,s,o,new R(E.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new Lt(i.doc.resolve(n.$from.pos),i.doc.resolve(o),n.depth));const c=Ve(n);if(c==null)return!1;i.lift(n,c);let u=i.mapping.map(s,-1)-1;return Fe(i.doc,u)&&i.join(u),e(i.scrollIntoView()),!0}function Cu(r,e,t){let n=r.tr,i=t.parent;for(let w=t.end,b=t.endIndex-1,y=t.startIndex;b>y;b--)w-=i.child(b).nodeSize,n.delete(w-1,w+1);let s=n.doc.resolve(t.start),o=s.nodeAfter;if(n.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let c=t.startIndex==0,u=t.endIndex==i.childCount,f=s.node(-1),d=s.index(-1);if(!f.canReplace(d+(c?0:1),d+1,o.content.append(u?E.empty:E.from(i))))return!1;let g=s.pos,v=g+o.nodeSize;return n.step(new ie(g-(c?1:0),v+(u?1:0),g+1,v-1,new R((c?E.empty:E.from(i.copy(E.empty))).append(u?E.empty:E.from(i.copy(E.empty))),c?0:1,u?0:1),c?0:1)),e(n.scrollIntoView()),!0}function Tu(r){return function(e,t){let{$from:n,$to:i}=e.selection,s=n.blockRange(i,f=>f.childCount>0&&f.firstChild.type==r);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let c=s.parent,u=c.child(o-1);if(u.type!=r)return!1;if(t){let f=u.lastChild&&u.lastChild.type==c.type,d=E.from(f?r.create():null),g=new R(E.from(r.create(null,E.from(c.type.create(null,d)))),f?3:1,0),v=s.start,w=s.end;t(e.tr.step(new ie(v-(f?3:1),w,v,w,g,1,!0)).scrollIntoView())}return!0}}function ps(r){const{state:e,transaction:t}=r;let{selection:n}=t,{doc:i}=t,{storedMarks:s}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return n},get doc(){return i},get tr(){return n=t.selection,i=t.doc,s=t.storedMarks,t}}}class Eu{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:i}=t,{tr:s}=n,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([c,u])=>[c,(...d)=>{const g=u(...d)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),g}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:i,state:s}=this,{view:o}=i,c=[],u=!!e,f=e||s.tr,d=()=>(!u&&t&&!f.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(f),c.every(v=>v===!0)),g={...Object.fromEntries(Object.entries(n).map(([v,w])=>[v,(...y)=>{const k=this.buildProps(f,t),x=w(...y)(k);return c.push(x),g}])),run:d};return g}createCan(e){const{rawCommands:t,state:n}=this,i=!1,s=e||n.tr,o=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(t).map(([u,f])=>[u,(...d)=>f(...d)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,t=!0){const{rawCommands:n,editor:i,state:s}=this,{view:o}=i,c={tr:e,editor:i,view:o,state:ps({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([u,f])=>[u,(...d)=>f(...d)(c)]))}};return c}}function he(r,e,t){return r.config[e]===void 0&&r.parent?he(r.parent,e,t):typeof r.config[e]=="function"?r.config[e].bind({...t,parent:r.parent?he(r.parent,e,t):null}):r.config[e]}function Ou(r){const e=r.filter(i=>i.type==="extension"),t=r.filter(i=>i.type==="node"),n=r.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:n}}function ee(r,e){if(typeof r=="string"){if(!e.nodes[r])throw Error(`There is no node type named '${r}'. Maybe you forgot to add the extension?`);return e.nodes[r]}return r}function _u(...r){return r.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(([i,s])=>{if(!n[i]){n[i]=s;return}if(i==="class"){const c=s?s.split(" "):[],u=n[i]?n[i].split(" "):[],f=c.filter(d=>!u.includes(d));n[i]=[...u,...f].join(" ")}else if(i==="style"){const c=s?s.split(";").map(d=>d.trim()).filter(Boolean):[],u=n[i]?n[i].split(";").map(d=>d.trim()).filter(Boolean):[],f=new Map;u.forEach(d=>{const[g,v]=d.split(":").map(w=>w.trim());f.set(g,v)}),c.forEach(d=>{const[g,v]=d.split(":").map(w=>w.trim());f.set(g,v)}),n[i]=Array.from(f.entries()).map(([d,g])=>`${d}: ${g}`).join("; ")}else n[i]=s}),n},{})}function Au(r){return typeof r=="function"}function ge(r,e=void 0,...t){return Au(r)?e?r.bind(e)(...t):r(...t):r}function Ru(r){return Object.prototype.toString.call(r)==="[object RegExp]"}class Pu{constructor(e){this.find=e.find,this.handler=e.handler}}function Iu(r){return Object.prototype.toString.call(r).slice(8,-1)}function St(r){return Iu(r)!=="Object"?!1:r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype}function Vn(r,e){const t={...r};return St(r)&&St(e)&&Object.keys(e).forEach(n=>{St(e[n])&&St(r[n])?t[n]=Vn(r[n],e[n]):t[n]=e[n]}),t}class pe{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ge(he(this,"addOptions",{name:this.name}))),this.storage=ge(he(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new pe(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Vn(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new pe({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ge(he(t,"addOptions",{name:t.name})),t.storage=ge(he(t,"addStorage",{name:t.name,options:t.options})),t}}function Nu(r,e,t){const{from:n,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=t||{};let c="";return r.nodesBetween(n,i,(u,f,d,g)=>{var v;u.isBlock&&f>n&&(c+=s);const w=o==null?void 0:o[u.type.name];if(w)return d&&(c+=w({node:u,pos:f,parent:d,index:g,range:e})),!1;u.isText&&(c+=(v=u==null?void 0:u.text)===null||v===void 0?void 0:v.slice(Math.max(n,f)-f,i-f))}),c}function Mu(r){return Object.fromEntries(Object.entries(r.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}pe.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new ze({key:new je("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:r}=this,{state:e,schema:t}=r,{doc:n,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(d=>d.$from.pos)),c=Math.max(...s.map(d=>d.$to.pos)),u=Mu(t);return Nu(n,{from:o,to:c},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:u})}}})]}});const Lu=()=>({editor:r,view:e})=>(requestAnimationFrame(()=>{var t;r.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),Bu=(r=!1)=>({commands:e})=>e.setContent("",r),Fu=()=>({state:r,tr:e,dispatch:t})=>{const{selection:n}=e,{ranges:i}=n;return t&&i.forEach(({$from:s,$to:o})=>{r.doc.nodesBetween(s.pos,o.pos,(c,u)=>{if(c.type.isText)return;const{doc:f,mapping:d}=e,g=f.resolve(d.map(u)),v=f.resolve(d.map(u+c.nodeSize)),w=g.blockRange(v);if(!w)return;const b=Ve(w);if(c.type.isTextblock){const{defaultType:y}=g.parent.contentMatchAt(g.index());e.setNodeMarkup(w.start,y)}(b||b===0)&&e.lift(w,b)})}),!0},zu=r=>e=>r(e),ju=()=>({state:r,dispatch:e})=>fu(r,e),Du=(r,e)=>({editor:t,tr:n})=>{const{state:i}=t,s=i.doc.slice(r.from,r.to);n.deleteRange(r.from,r.to);const o=n.mapping.map(e);return n.insert(o,s.content),n.setSelection(new $(n.doc.resolve(o-1))),!0},Uu=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,n=t.$anchor.node();if(n.content.size>0)return!1;const i=r.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===n.type){if(e){const c=i.before(s),u=i.after(s);r.delete(c,u).scrollIntoView()}return!0}return!1},qu=r=>({tr:e,state:t,dispatch:n})=>{const i=ee(r,t.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(n){const u=s.before(o),f=s.after(o);e.delete(u,f).scrollIntoView()}return!0}return!1},Ju=r=>({tr:e,dispatch:t})=>{const{from:n,to:i}=r;return t&&e.delete(n,i),!0},Hu=()=>({state:r,dispatch:e})=>eu(r,e),$u=()=>({commands:r})=>r.keyboardShortcut("Enter"),Wu=()=>({state:r,dispatch:e})=>hu(r,e);function jt(r,e,t={strict:!0}){const n=Object.keys(e);return n.length?n.every(i=>t.strict?e[i]===r[i]:Ru(e[i])?e[i].test(r[i]):e[i]===r[i]):!0}function ms(r,e,t={}){return r.find(n=>n.type===e&&jt(Object.fromEntries(Object.keys(t).map(i=>[i,n.attrs[i]])),t))}function ni(r,e,t={}){return!!ms(r,e,t)}function gs(r,e,t){var n;if(!r||!e)return;let i=r.parent.childAfter(r.parentOffset);if((!i.node||!i.node.marks.some(d=>d.type===e))&&(i=r.parent.childBefore(r.parentOffset)),!i.node||!i.node.marks.some(d=>d.type===e)||(t=t||((n=i.node.marks[0])===null||n===void 0?void 0:n.attrs),!ms([...i.node.marks],e,t)))return;let o=i.index,c=r.start()+i.offset,u=o+1,f=c+i.node.nodeSize;for(;o>0&&ni([...r.parent.child(o-1).marks],e,t);)o-=1,c-=r.parent.child(o).nodeSize;for(;u<r.parent.childCount&&ni([...r.parent.child(u).marks],e,t);)f+=r.parent.child(u).nodeSize,u+=1;return{from:c,to:f}}function Se(r,e){if(typeof r=="string"){if(!e.marks[r])throw Error(`There is no mark type named '${r}'. Maybe you forgot to add the extension?`);return e.marks[r]}return r}const Vu=(r,e={})=>({tr:t,state:n,dispatch:i})=>{const s=Se(r,n.schema),{doc:o,selection:c}=t,{$from:u,from:f,to:d}=c;if(i){const g=gs(u,s,e);if(g&&g.from<=f&&g.to>=d){const v=$.create(o,g.from,g.to);t.setSelection(v)}}return!0},Xu=r=>e=>{const t=typeof r=="function"?r(e):r;for(let n=0;n<t.length;n+=1)if(t[n](e))return!0;return!1};function ys(r){return r instanceof $}function Re(r=0,e=0,t=0){return Math.min(Math.max(r,e),t)}function Ku(r,e=null){if(!e)return null;const t=j.atStart(r),n=j.atEnd(r);if(e==="start"||e===!0)return t;if(e==="end")return n;const i=t.from,s=n.to;return e==="all"?$.create(r,Re(0,i,s),Re(r.content.size,i,s)):$.create(r,Re(e,i,s),Re(e,i,s))}const Gu=(r=null,e={})=>({editor:t,view:n,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{n.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(n.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(n.hasFocus()&&r===null||r===!1)return!0;if(s&&r===null&&!ys(t.state.selection))return o(),!0;const c=Ku(i.doc,r)||t.state.selection,u=t.state.selection.eq(c);return s&&(u||i.setSelection(c),u&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},Qu=(r,e)=>t=>r.every((n,i)=>e(n,{...t,index:i})),Yu=(r,e)=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},r,e),bs=r=>{const e=r.childNodes;for(let t=e.length-1;t>=0;t-=1){const n=e[t];n.nodeType===3&&n.nodeValue&&/^(\n\s\s|\n)$/.test(n.nodeValue)?r.removeChild(n):n.nodeType===1&&bs(n)}return r};function xt(r){const e=`<body>${r}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return bs(t)}function Dt(r,e,t){if(r instanceof Me||r instanceof E)return r;t={slice:!0,parseOptions:{},...t};const n=typeof r=="object"&&r!==null,i=typeof r=="string";if(n)try{if(Array.isArray(r)&&r.length>0)return E.fromArray(r.map(c=>e.nodeFromJSON(c)));const o=e.nodeFromJSON(r);return t.errorOnInvalidContent&&o.check(),o}catch(s){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",r,"Error:",s),Dt("",e,t)}if(i){if(t.errorOnInvalidContent){let o=!1,c="";const u=new Fl({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:f=>(o=!0,c=typeof f=="string"?f:f.outerHTML,null)}]}})});if(t.slice?qe.fromSchema(u).parseSlice(xt(r),t.parseOptions):qe.fromSchema(u).parse(xt(r),t.parseOptions),t.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${c}`)})}const s=qe.fromSchema(e);return t.slice?s.parseSlice(xt(r),t.parseOptions).content:s.parse(xt(r),t.parseOptions)}return Dt("",e,t)}function Zu(r,e,t){const n=r.steps.length-1;if(n<e)return;const i=r.steps[n];if(!(i instanceof ae||i instanceof ie))return;const s=r.mapping.maps[n];let o=0;s.forEach((c,u,f,d)=>{o===0&&(o=d)}),r.setSelection(j.near(r.doc.resolve(o),t))}const eh=r=>!("type"in r),th=(r,e,t)=>({tr:n,dispatch:i,editor:s})=>{var o;if(i){t={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let c;try{c=Dt(e,s.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(o=t.errorOnInvalidContent)!==null&&o!==void 0?o:s.options.enableContentCheck})}catch(b){return s.emit("contentError",{editor:s,error:b,disableCollaboration:()=>{s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}}),!1}let{from:u,to:f}=typeof r=="number"?{from:r,to:r}:{from:r.from,to:r.to},d=!0,g=!0;if((eh(c)?c:[c]).forEach(b=>{b.check(),d=d?b.isText&&b.marks.length===0:!1,g=g?b.isBlock:!1}),u===f&&g){const{parent:b}=n.doc.resolve(u);b.isTextblock&&!b.type.spec.code&&!b.childCount&&(u-=1,f+=1)}let w;if(d){if(Array.isArray(e))w=e.map(b=>b.text||"").join("");else if(e instanceof E){let b="";e.forEach(y=>{y.text&&(b+=y.text)}),w=b}else typeof e=="object"&&e&&e.text?w=e.text:w=e;n.insertText(w,u,f)}else w=c,n.replaceWith(u,f,w);t.updateSelection&&Zu(n,n.steps.length-1,-1),t.applyInputRules&&n.setMeta("applyInputRules",{from:u,text:w}),t.applyPasteRules&&n.setMeta("applyPasteRules",{from:u,text:w})}return!0},nh=()=>({state:r,dispatch:e})=>au(r,e),rh=()=>({state:r,dispatch:e})=>cu(r,e),ih=()=>({state:r,dispatch:e})=>tu(r,e),sh=()=>({state:r,dispatch:e})=>su(r,e),oh=()=>({state:r,dispatch:e,tr:t})=>{try{const n=Vt(r.doc,r.selection.$from.pos,-1);return n==null?!1:(t.join(n,2),e&&e(t),!0)}catch{return!1}},ah=()=>({state:r,dispatch:e,tr:t})=>{try{const n=Vt(r.doc,r.selection.$from.pos,1);return n==null?!1:(t.join(n,2),e&&e(t),!0)}catch{return!1}},ch=()=>({state:r,dispatch:e})=>nu(r,e),lh=()=>({state:r,dispatch:e})=>ru(r,e);function ws(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function vs(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function uh(r){const e=r.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let n,i,s,o;for(let c=0;c<e.length-1;c+=1){const u=e[c];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))n=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))ws()||vs()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return n&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),s&&(t=`Shift-${t}`),t}const hh=r=>({editor:e,view:t,tr:n,dispatch:i})=>{const s=uh(r).split(/-(?!$)/),o=s.find(f=>!["Alt","Ctrl","Meta","Shift"].includes(f)),c=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),u=e.captureTransaction(()=>{t.someProp("handleKeyDown",f=>f(t,c))});return u==null||u.steps.forEach(f=>{const d=f.map(n.mapping);d&&i&&n.maybeStep(d)}),!0};function Xn(r,e,t={}){const{from:n,to:i,empty:s}=r.selection,o=e?ee(e,r.schema):null,c=[];r.doc.nodesBetween(n,i,(g,v)=>{if(g.isText)return;const w=Math.max(n,v),b=Math.min(i,v+g.nodeSize);c.push({node:g,from:w,to:b})});const u=i-n,f=c.filter(g=>o?o.name===g.node.type.name:!0).filter(g=>jt(g.node.attrs,t,{strict:!1}));return s?!!f.length:f.reduce((g,v)=>g+v.to-v.from,0)>=u}const fh=(r,e={})=>({state:t,dispatch:n})=>{const i=ee(r,t.schema);return Xn(t,i,e)?lu(t,n):!1},dh=()=>({state:r,dispatch:e})=>du(r,e),ph=r=>({state:e,dispatch:t})=>{const n=ee(r,e.schema);return Su(n)(e,t)},mh=()=>({state:r,dispatch:e})=>uu(r,e);function ks(r,e){return e.nodes[r]?"node":e.marks[r]?"mark":null}function ri(r,e){const t=typeof e=="string"?[e]:e;return Object.keys(r).reduce((n,i)=>(t.includes(i)||(n[i]=r[i]),n),{})}const gh=(r,e)=>({tr:t,state:n,dispatch:i})=>{let s=null,o=null;const c=ks(typeof r=="string"?r:r.name,n.schema);return c?(c==="node"&&(s=ee(r,n.schema)),c==="mark"&&(o=Se(r,n.schema)),i&&t.selection.ranges.forEach(u=>{n.doc.nodesBetween(u.$from.pos,u.$to.pos,(f,d)=>{s&&s===f.type&&t.setNodeMarkup(d,void 0,ri(f.attrs,e)),o&&f.marks.length&&f.marks.forEach(g=>{o===g.type&&t.addMark(d,d+f.nodeSize,o.create(ri(g.attrs,e)))})})}),!0):!1},yh=()=>({tr:r,dispatch:e})=>(e&&r.scrollIntoView(),!0),bh=()=>({tr:r,dispatch:e})=>{if(e){const t=new de(r.doc);r.setSelection(t)}return!0},wh=()=>({state:r,dispatch:e})=>iu(r,e),vh=()=>({state:r,dispatch:e})=>ou(r,e),kh=()=>({state:r,dispatch:e})=>pu(r,e),Sh=()=>({state:r,dispatch:e})=>yu(r,e),xh=()=>({state:r,dispatch:e})=>gu(r,e);function Ch(r,e,t={},n={}){return Dt(r,e,{slice:!1,parseOptions:t,errorOnInvalidContent:n.errorOnInvalidContent})}const Th=(r,e=!1,t={},n={})=>({editor:i,tr:s,dispatch:o,commands:c})=>{var u,f;const{doc:d}=s;if(t.preserveWhitespace!=="full"){const g=Ch(r,i.schema,t,{errorOnInvalidContent:(u=n.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck});return o&&s.replaceWith(0,d.content.size,g).setMeta("preventUpdate",!e),!0}return o&&s.setMeta("preventUpdate",!e),c.insertContentAt({from:0,to:d.content.size},r,{parseOptions:t,errorOnInvalidContent:(f=n.errorOnInvalidContent)!==null&&f!==void 0?f:i.options.enableContentCheck})};function Eh(r,e){const t=Se(e,r.schema),{from:n,to:i,empty:s}=r.selection,o=[];s?(r.storedMarks&&o.push(...r.storedMarks),o.push(...r.selection.$head.marks())):r.doc.nodesBetween(n,i,u=>{o.push(...u.marks)});const c=o.find(u=>u.type.name===t.name);return c?{...c.attrs}:{}}function Oh(r){for(let e=0;e<r.edgeCount;e+=1){const{type:t}=r.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function _h(r,e){for(let t=r.depth;t>0;t-=1){const n=r.node(t);if(e(n))return{pos:t>0?r.before(t):0,start:r.start(t),depth:t,node:n}}}function Kn(r){return e=>_h(e.$from,r)}function Ot(r,e,t){return Object.fromEntries(Object.entries(t).filter(([n])=>{const i=r.find(s=>s.type===e&&s.name===n);return i?i.attribute.keepOnSplit:!1}))}function Ah(r,e,t={}){const{empty:n,ranges:i}=r.selection,s=e?Se(e,r.schema):null;if(n)return!!(r.storedMarks||r.selection.$from.marks()).filter(g=>s?s.name===g.type.name:!0).find(g=>jt(g.attrs,t,{strict:!1}));let o=0;const c=[];if(i.forEach(({$from:g,$to:v})=>{const w=g.pos,b=v.pos;r.doc.nodesBetween(w,b,(y,k)=>{if(!y.isText&&!y.marks.length)return;const x=Math.max(w,k),O=Math.min(b,k+y.nodeSize),_=O-x;o+=_,c.push(...y.marks.map(M=>({mark:M,from:x,to:O})))})}),o===0)return!1;const u=c.filter(g=>s?s.name===g.mark.type.name:!0).filter(g=>jt(g.mark.attrs,t,{strict:!1})).reduce((g,v)=>g+v.to-v.from,0),f=c.filter(g=>s?g.mark.type!==s&&g.mark.type.excludes(s):!0).reduce((g,v)=>g+v.to-v.from,0);return(u>0?u+f:u)>=o}function ii(r,e){const{nodeExtensions:t}=Ou(e),n=t.find(o=>o.name===r);if(!n)return!1;const i={name:n.name,options:n.options,storage:n.storage},s=ge(he(n,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function Ss(r,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var n;if(t){if(r.type.name==="hardBreak")return!0;if(r.isText)return/^\s*$/m.test((n=r.text)!==null&&n!==void 0?n:"")}if(r.isText)return!r.text;if(r.isAtom||r.isLeaf)return!1;if(r.content.childCount===0)return!0;if(e){let i=!0;return r.content.forEach(s=>{i!==!1&&(Ss(s,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}function Rh(r,e,t){var n;const{selection:i}=e;let s=null;if(ys(i)&&(s=i.$cursor),s){const c=(n=r.storedMarks)!==null&&n!==void 0?n:s.marks();return!!t.isInSet(c)||!c.some(u=>u.type.excludes(t))}const{ranges:o}=i;return o.some(({$from:c,$to:u})=>{let f=c.depth===0?r.doc.inlineContent&&r.doc.type.allowsMarkType(t):!1;return r.doc.nodesBetween(c.pos,u.pos,(d,g,v)=>{if(f)return!1;if(d.isInline){const w=!v||v.type.allowsMarkType(t),b=!!t.isInSet(d.marks)||!d.marks.some(y=>y.type.excludes(t));f=w&&b}return!f}),f})}const Ph=(r,e={})=>({tr:t,state:n,dispatch:i})=>{const{selection:s}=t,{empty:o,ranges:c}=s,u=Se(r,n.schema);if(i)if(o){const f=Eh(n,u);t.addStoredMark(u.create({...f,...e}))}else c.forEach(f=>{const d=f.$from.pos,g=f.$to.pos;n.doc.nodesBetween(d,g,(v,w)=>{const b=Math.max(w,d),y=Math.min(w+v.nodeSize,g);v.marks.find(x=>x.type===u)?v.marks.forEach(x=>{u===x.type&&t.addMark(b,y,u.create({...x.attrs,...e}))}):t.addMark(b,y,u.create(e))})});return Rh(n,t,u)},Ih=(r,e)=>({tr:t})=>(t.setMeta(r,e),!0),Nh=(r,e={})=>({state:t,dispatch:n,chain:i})=>{const s=ee(r,t.schema);let o;return t.selection.$anchor.sameParent(t.selection.$head)&&(o=t.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:c})=>ti(s,{...o,...e})(t)?!0:c.clearNodes()).command(({state:c})=>ti(s,{...o,...e})(c,n)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Mh=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,i=Re(r,0,n.content.size),s=U.create(n,i);e.setSelection(s)}return!0},Lh=r=>({tr:e,dispatch:t})=>{if(t){const{doc:n}=e,{from:i,to:s}=typeof r=="number"?{from:r,to:r}:r,o=$.atStart(n).from,c=$.atEnd(n).to,u=Re(i,o,c),f=Re(s,o,c),d=$.create(n,u,f);e.setSelection(d)}return!0},Bh=r=>({state:e,dispatch:t})=>{const n=ee(r,e.schema);return Tu(n)(e,t)};function si(r,e){const t=r.storedMarks||r.selection.$to.parentOffset&&r.selection.$from.marks();if(t){const n=t.filter(i=>e==null?void 0:e.includes(i.type.name));r.tr.ensureMarks(n)}}const Fh=({keepMarks:r=!0}={})=>({tr:e,state:t,dispatch:n,editor:i})=>{const{selection:s,doc:o}=e,{$from:c,$to:u}=s,f=i.extensionManager.attributes,d=Ot(f,c.node().type.name,c.node().attrs);if(s instanceof U&&s.node.isBlock)return!c.parentOffset||!Je(o,c.pos)?!1:(n&&(r&&si(t,i.extensionManager.splittableMarks),e.split(c.pos).scrollIntoView()),!0);if(!c.parent.isBlock)return!1;const g=u.parentOffset===u.parent.content.size,v=c.depth===0?void 0:Oh(c.node(-1).contentMatchAt(c.indexAfter(-1)));let w=g&&v?[{type:v,attrs:d}]:void 0,b=Je(e.doc,e.mapping.map(c.pos),1,w);if(!w&&!b&&Je(e.doc,e.mapping.map(c.pos),1,v?[{type:v}]:void 0)&&(b=!0,w=v?[{type:v,attrs:d}]:void 0),n){if(b&&(s instanceof $&&e.deleteSelection(),e.split(e.mapping.map(c.pos),1,w),v&&!g&&!c.parentOffset&&c.parent.type!==v)){const y=e.mapping.map(c.before()),k=e.doc.resolve(y);c.node(-1).canReplaceWith(k.index(),k.index()+1,v)&&e.setNodeMarkup(e.mapping.map(c.before()),v)}r&&si(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return b},zh=(r,e={})=>({tr:t,state:n,dispatch:i,editor:s})=>{var o;const c=ee(r,n.schema),{$from:u,$to:f}=n.selection,d=n.selection.node;if(d&&d.isBlock||u.depth<2||!u.sameParent(f))return!1;const g=u.node(-1);if(g.type!==c)return!1;const v=s.extensionManager.attributes;if(u.parent.content.size===0&&u.node(-1).childCount===u.indexAfter(-1)){if(u.depth===2||u.node(-3).type!==c||u.index(-2)!==u.node(-2).childCount-1)return!1;if(i){let x=E.empty;const O=u.index(-1)?1:u.index(-2)?2:3;for(let q=u.depth-O;q>=u.depth-3;q-=1)x=E.from(u.node(q).copy(x));const _=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,M={...Ot(v,u.node().type.name,u.node().attrs),...e},F=((o=c.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(M))||void 0;x=x.append(E.from(c.createAndFill(null,F)||void 0));const B=u.before(u.depth-(O-1));t.replace(B,u.after(-_),new R(x,4-O,0));let J=-1;t.doc.nodesBetween(B,t.doc.content.size,(q,ue)=>{if(J>-1)return!1;q.isTextblock&&q.content.size===0&&(J=ue+1)}),J>-1&&t.setSelection($.near(t.doc.resolve(J))),t.scrollIntoView()}return!0}const w=f.pos===u.end()?g.contentMatchAt(0).defaultType:null,b={...Ot(v,g.type.name,g.attrs),...e},y={...Ot(v,u.node().type.name,u.node().attrs),...e};t.delete(u.pos,f.pos);const k=w?[{type:c,attrs:b},{type:w,attrs:y}]:[{type:c,attrs:b}];if(!Je(t.doc,u.pos,2))return!1;if(i){const{selection:x,storedMarks:O}=n,{splittableMarks:_}=s.extensionManager,M=O||x.$to.parentOffset&&x.$from.marks();if(t.split(u.pos,2,k).scrollIntoView(),!M||!i)return!0;const F=M.filter(B=>_.includes(B.type.name));t.ensureMarks(F)}return!0},wn=(r,e)=>{const t=Kn(o=>o.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(n===void 0)return!0;const i=r.doc.nodeAt(n);return t.node.type===(i==null?void 0:i.type)&&Fe(r.doc,t.pos)&&r.join(t.pos),!0},vn=(r,e)=>{const t=Kn(o=>o.type===e)(r.selection);if(!t)return!0;const n=r.doc.resolve(t.start).after(t.depth);if(n===void 0)return!0;const i=r.doc.nodeAt(n);return t.node.type===(i==null?void 0:i.type)&&Fe(r.doc,n)&&r.join(n),!0},jh=(r,e,t,n={})=>({editor:i,tr:s,state:o,dispatch:c,chain:u,commands:f,can:d})=>{const{extensions:g,splittableMarks:v}=i.extensionManager,w=ee(r,o.schema),b=ee(e,o.schema),{selection:y,storedMarks:k}=o,{$from:x,$to:O}=y,_=x.blockRange(O),M=k||y.$to.parentOffset&&y.$from.marks();if(!_)return!1;const F=Kn(B=>ii(B.type.name,g))(y);if(_.depth>=1&&F&&_.depth-F.depth<=1){if(F.node.type===w)return f.liftListItem(b);if(ii(F.node.type.name,g)&&w.validContent(F.node.content)&&c)return u().command(()=>(s.setNodeMarkup(F.pos,w),!0)).command(()=>wn(s,w)).command(()=>vn(s,w)).run()}return!t||!M||!c?u().command(()=>d().wrapInList(w,n)?!0:f.clearNodes()).wrapInList(w,n).command(()=>wn(s,w)).command(()=>vn(s,w)).run():u().command(()=>{const B=d().wrapInList(w,n),J=M.filter(q=>v.includes(q.type.name));return s.ensureMarks(J),B?!0:f.clearNodes()}).wrapInList(w,n).command(()=>wn(s,w)).command(()=>vn(s,w)).run()},Dh=(r,e={},t={})=>({state:n,commands:i})=>{const{extendEmptyMarkRange:s=!1}=t,o=Se(r,n.schema);return Ah(n,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},Uh=(r,e,t={})=>({state:n,commands:i})=>{const s=ee(r,n.schema),o=ee(e,n.schema),c=Xn(n,s,t);let u;return n.selection.$anchor.sameParent(n.selection.$head)&&(u=n.selection.$anchor.parent.attrs),c?i.setNode(o,u):i.setNode(s,{...u,...t})},qh=(r,e={})=>({state:t,commands:n})=>{const i=ee(r,t.schema);return Xn(t,i,e)?n.lift(i):n.wrapIn(i,e)},Jh=()=>({state:r,dispatch:e})=>{const t=r.plugins;for(let n=0;n<t.length;n+=1){const i=t[n];let s;if(i.spec.isInputRules&&(s=i.getState(r))){if(e){const o=r.tr,c=s.transform;for(let u=c.steps.length-1;u>=0;u-=1)o.step(c.steps[u].invert(c.docs[u]));if(s.text){const u=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,r.schema.text(s.text,u))}else o.delete(s.from,s.to)}return!0}}return!1},Hh=()=>({tr:r,dispatch:e})=>{const{selection:t}=r,{empty:n,ranges:i}=t;return n||e&&i.forEach(s=>{r.removeMark(s.$from.pos,s.$to.pos)}),!0},$h=(r,e={})=>({tr:t,state:n,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:c}=t,u=Se(r,n.schema),{$from:f,empty:d,ranges:g}=c;if(!i)return!0;if(d&&o){let{from:v,to:w}=c;const b=(s=f.marks().find(k=>k.type===u))===null||s===void 0?void 0:s.attrs,y=gs(f,u,b);y&&(v=y.from,w=y.to),t.removeMark(v,w,u)}else g.forEach(v=>{t.removeMark(v.$from.pos,v.$to.pos,u)});return t.removeStoredMark(u),!0},Wh=(r,e={})=>({tr:t,state:n,dispatch:i})=>{let s=null,o=null;const c=ks(typeof r=="string"?r:r.name,n.schema);return c?(c==="node"&&(s=ee(r,n.schema)),c==="mark"&&(o=Se(r,n.schema)),i&&t.selection.ranges.forEach(u=>{const f=u.$from.pos,d=u.$to.pos;let g,v,w,b;t.selection.empty?n.doc.nodesBetween(f,d,(y,k)=>{s&&s===y.type&&(w=Math.max(k,f),b=Math.min(k+y.nodeSize,d),g=k,v=y)}):n.doc.nodesBetween(f,d,(y,k)=>{k<f&&s&&s===y.type&&(w=Math.max(k,f),b=Math.min(k+y.nodeSize,d),g=k,v=y),k>=f&&k<=d&&(s&&s===y.type&&t.setNodeMarkup(k,void 0,{...y.attrs,...e}),o&&y.marks.length&&y.marks.forEach(x=>{if(o===x.type){const O=Math.max(k,f),_=Math.min(k+y.nodeSize,d);t.addMark(O,_,o.create({...x.attrs,...e}))}}))}),v&&(g!==void 0&&t.setNodeMarkup(g,void 0,{...v.attrs,...e}),o&&v.marks.length&&v.marks.forEach(y=>{o===y.type&&t.addMark(w,b,o.create({...y.attrs,...e}))}))}),!0):!1},Vh=(r,e={})=>({state:t,dispatch:n})=>{const i=ee(r,t.schema);return bu(i,e)(t,n)},Xh=(r,e={})=>({state:t,dispatch:n})=>{const i=ee(r,t.schema);return wu(i,e)(t,n)};var Kh=Object.freeze({__proto__:null,blur:Lu,clearContent:Bu,clearNodes:Fu,command:zu,createParagraphNear:ju,cut:Du,deleteCurrentNode:Uu,deleteNode:qu,deleteRange:Ju,deleteSelection:Hu,enter:$u,exitCode:Wu,extendMarkRange:Vu,first:Xu,focus:Gu,forEach:Qu,insertContent:Yu,insertContentAt:th,joinBackward:ih,joinDown:rh,joinForward:sh,joinItemBackward:oh,joinItemForward:ah,joinTextblockBackward:ch,joinTextblockForward:lh,joinUp:nh,keyboardShortcut:hh,lift:fh,liftEmptyBlock:dh,liftListItem:ph,newlineInCode:mh,resetAttributes:gh,scrollIntoView:yh,selectAll:bh,selectNodeBackward:wh,selectNodeForward:vh,selectParentNode:kh,selectTextblockEnd:Sh,selectTextblockStart:xh,setContent:Th,setMark:Ph,setMeta:Ih,setNode:Nh,setNodeSelection:Mh,setTextSelection:Lh,sinkListItem:Bh,splitBlock:Fh,splitListItem:zh,toggleList:jh,toggleMark:Dh,toggleNode:Uh,toggleWrap:qh,undoInputRule:Jh,unsetAllMarks:Hh,unsetMark:$h,updateAttributes:Wh,wrapIn:Vh,wrapInList:Xh});pe.create({name:"commands",addCommands(){return{...Kh}}});pe.create({name:"drop",addProseMirrorPlugins(){return[new ze({key:new je("tiptapDrop"),props:{handleDrop:(r,e,t,n)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:n})}}})]}});pe.create({name:"editable",addProseMirrorPlugins(){return[new ze({key:new je("editable"),props:{editable:()=>this.editor.options.editable}})]}});pe.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:r}=this;return[new ze({key:new je("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{r.isFocused=!0;const n=r.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1},blur:(e,t)=>{r.isFocused=!1;const n=r.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(n),!1}}}})]}});pe.create({name:"keymap",addKeyboardShortcuts(){const r=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:c})=>{const{selection:u,doc:f}=c,{empty:d,$anchor:g}=u,{pos:v,parent:w}=g,b=g.parent.isTextblock&&v>0?c.doc.resolve(v-1):g,y=b.parent.type.spec.isolating,k=g.pos-g.parentOffset,x=y&&b.parent.childCount===1?k===g.pos:j.atStart(f).from===v;return!d||!w.type.isTextblock||w.textContent.length||!x||x&&g.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),n={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:r,"Mod-Backspace":r,"Shift-Backspace":r,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...n},s={...n,"Ctrl-h":r,"Alt-Backspace":r,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ws()||vs()?s:i},addProseMirrorPlugins(){return[new ze({key:new je("clearDocument"),appendTransaction:(r,e,t)=>{const n=r.some(y=>y.docChanged)&&!e.doc.eq(t.doc),i=r.some(y=>y.getMeta("preventClearDocument"));if(!n||i)return;const{empty:s,from:o,to:c}=e.selection,u=j.atStart(e.doc).from,f=j.atEnd(e.doc).to;if(s||!(o===u&&c===f)||!Ss(t.doc))return;const v=t.tr,w=ps({state:t,transaction:v}),{commands:b}=new Eu({editor:this.editor,state:w});if(b.clearNodes(),!!v.steps.length)return v}})]}});pe.create({name:"paste",addProseMirrorPlugins(){return[new ze({key:new je("tiptapPaste"),props:{handlePaste:(r,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}});pe.create({name:"tabindex",addProseMirrorPlugins(){return[new ze({key:new je("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});function Gh(r){return new Pu({find:r.find,handler:({state:e,range:t,match:n})=>{const i=ge(r.getAttributes,void 0,n)||{},{tr:s}=e,o=t.from;let c=t.to;const u=r.type.create(i);if(n[1]){const f=n[0].lastIndexOf(n[1]);let d=o+f;d>c?d=c:c=d+n[1].length;const g=n[0][n[0].length-1];s.insertText(g,o+n[0].length-1),s.replaceWith(d,c,u)}else if(n[0]){const f=r.type.isInline?o:o-1;s.insert(f,r.type.create(i)).delete(s.mapping.map(o),s.mapping.map(c))}s.scrollIntoView()}})}class Ut{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ge(he(this,"addOptions",{name:this.name}))),this.storage=ge(he(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ut(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Vn(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Ut(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ge(he(t,"addOptions",{name:t.name})),t.storage=ge(he(t,"addStorage",{name:t.name,options:t.options})),t}}const Qh=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Yh=Ut.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:r}){return["img",_u(this.options.HTMLAttributes,r)]},addCommands(){return{setImage:r=>({commands:e})=>e.insertContent({type:this.name,attrs:r})}},addInputRules(){return[Gh({find:Qh,type:this.type,getAttributes:r=>{const[,,e,t,n]=r;return{src:t,alt:e,title:n}}})]}});window.addEventListener("tiptap-editor:init",r=>{const e=r.detail.editor,t=Yh.extend({name:"image",addOptions(){var n;return{...(n=this.parent)==null?void 0:n.call(this),inline:!0,allowBase64:!0}}});e.extensionManager.extensions=[...e.extensionManager.extensions,t]});
